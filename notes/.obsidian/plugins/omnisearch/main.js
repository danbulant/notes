/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Cm=Object.create;var vn=Object.defineProperty,Sm=Object.defineProperties,Em=Object.getOwnPropertyDescriptor,Fm=Object.getOwnPropertyDescriptors,Tm=Object.getOwnPropertyNames,ll=Object.getOwnPropertySymbols,Dm=Object.getPrototypeOf,ul=Object.prototype.hasOwnProperty,Om=Object.prototype.propertyIsEnumerable;var cl=(t,e,r)=>e in t?vn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,he=(t,e)=>{for(var r in e||(e={}))ul.call(e,r)&&cl(t,r,e[r]);if(ll)for(var r of ll(e))Om.call(e,r)&&cl(t,r,e[r]);return t},Re=(t,e)=>Sm(t,Fm(e)),fl=t=>vn(t,"__esModule",{value:!0});var j=(t,e)=>()=>(t&&(e=t(t=0)),e);var pi=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),dl=(t,e)=>{fl(t);for(var r in e)vn(t,r,{get:e[r],enumerable:!0})},Im=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Tm(e))!ul.call(t,n)&&n!=="default"&&vn(t,n,{get:()=>e[n],enumerable:!(r=Em(e,n))||r.enumerable});return t},ge=t=>Im(fl(vn(t!=null?Cm(Dm(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);function me(){}function Pm(t,e){for(let r in e)t[r]=e[r];return t}function rs(t){return t()}function pl(){return Object.create(null)}function rt(t){t.forEach(rs)}function jr(t){return typeof t=="function"}function Ce(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function ns(t,e){return hi||(hi=document.createElement("a")),hi.href=e,t===hi.href}function hl(t){return Object.keys(t).length===0}function ml(t,...e){if(t==null)return me;let r=t.subscribe(...e);return r.unsubscribe?()=>r.unsubscribe():r}function mi(t,e,r){t.$$.on_destroy.push(ml(e,r))}function Ar(t,e,r,n){if(t){let i=gl(t,e,r,n);return t[0](i)}}function gl(t,e,r,n){return t[1]&&n?Pm(r.ctx.slice(),t[1](n(e))):r.ctx}function Cr(t,e,r,n){if(t[2]&&n){let i=t[2](n(r));if(e.dirty===void 0)return i;if(typeof i=="object"){let o=[],s=Math.max(e.dirty.length,i.length);for(let a=0;a<s;a+=1)o[a]=e.dirty[a]|i[a];return o}return e.dirty|i}return e.dirty}function Sr(t,e,r,n,i,o){if(i){let s=gl(e,r,n,o);t.p(s,i)}}function Er(t){if(t.ctx.length>32){let e=[],r=t.ctx.length/32;for(let n=0;n<r;n++)e[n]=-1;return e}return-1}function yl(t){return t&&jr(t.destroy)?t.destroy:me}function km(){vl=!0}function Mm(){vl=!1}function O(t,e){t.appendChild(e)}function U(t,e,r){t.insertBefore(e,r||null)}function W(t){t.parentNode&&t.parentNode.removeChild(t)}function yi(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function R(t){return document.createElement(t)}function Se(t){return document.createTextNode(t)}function G(){return Se(" ")}function Fr(){return Se("")}function $e(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function B(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function Rm(t){return Array.from(t.childNodes)}function nt(t,e){e=""+e,t.data!==e&&(t.data=e)}function is(t,e){t.value=e??""}function Qe(t,e,r,n){r==null?t.style.removeProperty(e):t.style.setProperty(e,r,n?"important":"")}function os(t,e,r){t.classList[r?"add":"remove"](e)}function Lm(t,e,{bubbles:r=!1,cancelable:n=!1}={}){let i=document.createEvent("CustomEvent");return i.initCustomEvent(t,r,n,e),i}function xn(t){bn=t}function ss(){if(!bn)throw new Error("Function called outside component initialization");return bn}function wn(t){ss().$$.on_mount.push(t)}function jn(t){ss().$$.on_destroy.push(t)}function as(){let t=ss();return(e,r,{cancelable:n=!1}={})=>{let i=t.$$.callbacks[e];if(i){let o=Lm(e,r,{cancelable:n});return i.slice().forEach(s=>{s.call(t,o)}),!o.defaultPrevented}return!0}}function qe(t,e){let r=t.$$.callbacks[e.type];r&&r.slice().forEach(n=>n.call(this,e))}function wl(){ls||(ls=!0,xl.then(jl))}function Dt(){return wl(),xl}function us(t){Dr.push(t)}function jl(){if(Or!==0)return;let t=bn;do{try{for(;Or<Tr.length;){let e=Tr[Or];Or++,xn(e),Nm(e.$$)}}catch(e){throw Tr.length=0,Or=0,e}for(xn(null),Tr.length=0,Or=0;ht.length;)ht.pop()();for(let e=0;e<Dr.length;e+=1){let r=Dr[e];cs.has(r)||(cs.add(r),r())}Dr.length=0}while(Tr.length);for(;bl.length;)bl.pop()();ls=!1,cs.clear(),xn(t)}function Nm(t){if(t.fragment!==null){t.update(),rt(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(us)}}function Bm(t){let e=[],r=[];Dr.forEach(n=>t.indexOf(n)===-1?e.push(n):r.push(n)),r.forEach(n=>n()),Dr=e}function nr(){rr={r:0,c:[],p:rr}}function ir(){rr.r||rt(rr.c),rr=rr.p}function te(t,e){t&&t.i&&(_i.delete(t),t.i(e))}function ie(t,e,r,n){if(t&&t.o){if(_i.has(t))return;_i.add(t),rr.c.push(()=>{_i.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function We(t){t&&t.c()}function Le(t,e,r,n){let{fragment:i,after_update:o}=t.$$;i&&i.m(e,r),n||us(()=>{let s=t.$$.on_mount.map(rs).filter(jr);t.$$.on_destroy?t.$$.on_destroy.push(...s):rt(s),t.$$.on_mount=[]}),o.forEach(us)}function Ie(t,e){let r=t.$$;r.fragment!==null&&(Bm(r.after_update),rt(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function zm(t,e){t.$$.dirty[0]===-1&&(Tr.push(t),wl(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Pe(t,e,r,n,i,o,s,a=[-1]){let u=bn;xn(t);let l=t.$$={fragment:null,ctx:[],props:o,update:me,not_equal:i,bound:pl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:pl(),dirty:a,skip_bound:!1,root:e.target||u.$$.root};s&&s(l.root);let f=!1;if(l.ctx=r?r(t,e.props||{},(p,c,...h)=>{let w=h.length?h[0]:c;return l.ctx&&i(l.ctx[p],l.ctx[p]=w)&&(!l.skip_bound&&l.bound[p]&&l.bound[p](w),f&&zm(t,p)),c}):[],l.update(),f=!0,rt(l.before_update),l.fragment=n?n(l.ctx):!1,e.target){if(e.hydrate){km();let p=Rm(e.target);l.fragment&&l.fragment.l(p),p.forEach(W)}else l.fragment&&l.fragment.c();e.intro&&te(t.$$.fragment),Le(t,e.target,e.anchor,e.customElement),Mm(),jl()}xn(u)}var hi,_l,gi,vl,bn,Tr,ht,Dr,bl,xl,ls,cs,Or,_i,rr,Km,y1,Hm,De,Xe=j(()=>{_l=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global,gi=class{constructor(e){this.options=e,this._listeners="WeakMap"in _l?new WeakMap:void 0}observe(e,r){return this._listeners.set(e,r),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!==null&&e!==void 0?e:this._observer=new ResizeObserver(r=>{var n;for(let i of r)gi.entries.set(i.target,i),(n=this._listeners.get(i.target))===null||n===void 0||n(i)})}};gi.entries="WeakMap"in _l?new WeakMap:void 0;vl=!1;Tr=[],ht=[],Dr=[],bl=[],xl=Promise.resolve(),ls=!1;cs=new Set,Or=0;_i=new Set;Km=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],y1=new Set([...Km]);typeof HTMLElement=="function"&&(Hm=class extends HTMLElement{constructor(){super();this.attachShadow({mode:"open"})}connectedCallback(){let{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(rs).filter(jr);for(let e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(t,e,r){this[t]=r}disconnectedCallback(){rt(this.$$.on_disconnect)}$destroy(){Ie(this,1),this.$destroy=me}$on(t,e){if(!jr(e))return me;let r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{let n=r.indexOf(e);n!==-1&&r.splice(n,1)}}$set(t){this.$$set&&!hl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});De=class{$destroy(){Ie(this,1),this.$destroy=me}$on(e,r){if(!jr(r))return me;let n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{let i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!hl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}});var fs,Al=j(()=>{fs=class{constructor(){this.handlers=new Map;this.disabled=[]}on(e,r,n){if(e.includes("@")||r.includes("@"))throw new Error("Invalid context/event name - Cannot contain @");this.handlers.set(`${e}@${r}`,n)}off(e,r){if(r)this.handlers.delete(`${e}@${r}`);else for(let[n]of this.handlers.entries())n.startsWith(`${e}@`)&&this.handlers.delete(n)}disable(e){this.enable(e),this.disabled.push(e)}enable(e){this.disabled=this.disabled.filter(r=>r!==e)}emit(e,...r){let n=[...this.handlers.entries()].filter(([i,o])=>!this.disabled.includes(i.split("@")[0]));for(let[i,o]of n)i.endsWith(`@${e}`)&&o(...r)}}});function vi(t,e=me){let r,n=new Set;function i(a){if(Ce(t,a)&&(t=a,r)){let u=!Ir.length;for(let l of n)l[1](),Ir.push(l,t);if(u){for(let l=0;l<Ir.length;l+=2)Ir[l][0](Ir[l+1]);Ir.length=0}}}function o(a){i(a(t))}function s(a,u=me){let l=[a,u];return n.add(l),n.size===1&&(r=e(i)||me),a(t),()=>{n.delete(l),n.size===0&&r&&(r(),r=null)}}return{set:i,update:o,subscribe:s}}var Ir,ds=j(()=>{Xe();Xe();Ir=[]});function Ne(t,e){return typeof e!="object"||_e(e).forEach(function(r){t[r]=e[r]}),t}function Ye(t,e){return Vm.call(t,e)}function Pr(t,e){typeof e=="function"&&(e=e(An(t))),(typeof Reflect=="undefined"?_e:Reflect.ownKeys)(e).forEach(r=>{mt(t,r,e[r])})}function mt(t,e,r,n){Cl(t,e,Ne(r&&Ye(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function kr(t){return{from:function(e){return t.prototype=Object.create(e.prototype),mt(t.prototype,"constructor",t),{extend:Pr.bind(null,t.prototype)}}}}function ps(t,e){let r=$m(t,e),n;return r||(n=An(t))&&ps(n,e)}function bi(t,e,r){return Wm.call(t,e,r)}function Sl(t,e){return e(t)}function Cn(t){if(!t)throw new Error("Assertion Failed")}function El(t){ae.setImmediate?setImmediate(t):setTimeout(t,0)}function Fl(t,e){return t.reduce((r,n,i)=>{var o=e(n,i);return o&&(r[o[0]]=o[1]),r},{})}function Um(t,e,r){try{t.apply(null,r)}catch(n){e&&e(n)}}function gt(t,e){if(Ye(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var r=[],n=0,i=e.length;n<i;++n){var o=gt(t,e[n]);r.push(o)}return r}var s=e.indexOf(".");if(s!==-1){var a=t[e.substr(0,s)];return a===void 0?void 0:gt(a,e.substr(s+1))}}function it(t,e,r){if(!(!t||e===void 0)&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){Cn(typeof r!="string"&&"length"in r);for(var n=0,i=e.length;n<i;++n)it(t,e[n],r[n])}else{var o=e.indexOf(".");if(o!==-1){var s=e.substr(0,o),a=e.substr(o+1);if(a==="")r===void 0?ke(t)&&!isNaN(parseInt(s))?t.splice(s,1):delete t[s]:t[s]=r;else{var u=t[s];(!u||!Ye(t,s))&&(u=t[s]={}),it(u,a,r)}}else r===void 0?ke(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=r}}function Gm(t,e){typeof e=="string"?it(t,e,void 0):"length"in e&&[].map.call(e,function(r){it(t,r,void 0)})}function Tl(t){var e={};for(var r in t)Ye(t,r)&&(e[r]=t[r]);return e}function Dl(t){return Qm.apply([],t)}function Sn(t){Ot=typeof WeakMap!="undefined"&&new WeakMap;let e=hs(t);return Ot=null,e}function hs(t){if(!t||typeof t!="object")return t;let e=Ot&&Ot.get(t);if(e)return e;if(ke(t)){e=[],Ot&&Ot.set(t,e);for(var r=0,n=t.length;r<n;++r)e.push(hs(t[r]))}else if(qm.indexOf(t.constructor)>=0)e=t;else{let o=An(t);e=o===Object.prototype?{}:Object.create(o),Ot&&Ot.set(t,e);for(var i in t)Ye(t,i)&&(e[i]=hs(t[i]))}return e}function ms(t){return Ym.call(t).slice(8,-1)}function yt(t){var e,r,n,i;if(arguments.length===1){if(ke(t))return t.slice();if(this===Mr&&typeof t=="string")return[t];if(i=Jm(t)){for(r=[];n=i.next(),!n.done;)r.push(n.value);return r}if(t==null)return[t];if(e=t.length,typeof e=="number"){for(r=new Array(e);e--;)r[e]=t[e];return r}return[t]}for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}function Il(t,e){lt=t,Pl=e}function or(){if(Xm)try{throw or.arguments,new Error}catch(t){return t}return new Error}function _s(t,e){var r=t.stack;return r?(e=e||0,r.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),r.split(`
`).slice(e).filter(Pl).map(n=>`
`+n).join("")):""}function Rr(t,e){this._e=or(),this.name=t,this.message=e}function Ml(t,e){return t+". Errors: "+Object.keys(e).map(r=>e[r].toString()).filter((r,n,i)=>i.indexOf(r)===n).join(`
`)}function xi(t,e,r,n){this._e=or(),this.failures=e,this.failedKeys=n,this.successCount=r,this.message=Ml(t,e)}function En(t,e){this._e=or(),this.name="BulkError",this.failures=Object.keys(e).map(r=>e[r]),this.failuresByPos=e,this.message=Ml(t,e)}function rg(t,e){if(!t||t instanceof Rr||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Rl[t.name])return t;var r=new Rl[t.name](e||t.message,t);return"stack"in t&&mt(r,"stack",{get:function(){return this.inner.stack}}),r}function oe(){}function Fn(t){return t}function ng(t,e){return t==null||t===Fn?e:function(r){return e(t(r))}}function sr(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function ig(t,e){return t===oe?e:function(){var r=t.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?sr(n,this.onsuccess):n),i&&(this.onerror=this.onerror?sr(i,this.onerror):i),o!==void 0?o:r}}function og(t,e){return t===oe?e:function(){t.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?sr(r,this.onsuccess):r),n&&(this.onerror=this.onerror?sr(n,this.onerror):n)}}function sg(t,e){return t===oe?e:function(r){var n=t.apply(this,arguments);Ne(r,n);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?sr(i,this.onsuccess):i),o&&(this.onerror=this.onerror?sr(o,this.onerror):o),n===void 0?s===void 0?void 0:s:Ne(n,s)}}function ag(t,e){return t===oe?e:function(){return e.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function xs(t,e){return t===oe?e:function(){var r=t.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return r.then(function(){return e.apply(n,o)})}return e.apply(this,arguments)}}function L(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=oe,this._lib=!1;var e=this._PSD=z;if(lt&&(this._stackHolder=or(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Tn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Ds(this,this._value);return}this._state=null,this._value=null,++e.ref,Kl(this,t)}function Bl(t,e,r,n,i){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=r,this.reject=n,this.psd=i}function Kl(t,e){try{e(r=>{if(t._state===null){if(r===t)throw new TypeError("A promise cannot be resolved with itself.");var n=t._lib&&In();r&&typeof r.then=="function"?Kl(t,(i,o)=>{r instanceof L?r._then(i,o):r.then(i,o)}):(t._state=!0,t._value=r,zl(t)),n&&Pn()}},Ds.bind(null,t))}catch(r){Ds(t,r)}}function Ds(t,e){if(Si.push(e),t._state===null){var r=t._lib&&In();e=Fs(e),t._state=!1,t._value=e,lt&&e!==null&&typeof e=="object"&&!e._promise&&Um(()=>{var n=ps(e,"stack");e._promise=t,mt(e,"stack",{get:()=>Cs?n&&(n.get?n.get.apply(e):n.value):t.stack})}),pg(t),zl(t),r&&Pn()}}function zl(t){var e=t._listeners;t._listeners=[];for(var r=0,n=e.length;r<n;++r)Os(t,e[r]);var i=t._PSD;--i.ref||i.finalize(),lr===0&&(++lr,Dn(()=>{--lr==0&&Is()},[]))}function Os(t,e){if(t._state===null){t._listeners.push(e);return}var r=t._state?e.onFulfilled:e.onRejected;if(r===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++lr,Dn(fg,[r,t,e])}function fg(t,e,r){try{Es=e;var n,i=e._value;e._state?n=t(i):(Si.length&&(Si=[]),n=t(i),Si.indexOf(i)===-1&&hg(e)),r.resolve(n)}catch(o){r.reject(o)}finally{Es=null,--lr==0&&Is(),--r.psd.ref||r.psd.finalize()}}function Hl(t,e,r){if(e.length===r)return e;var n="";if(t._state===!1){var i=t._value,o,s;i!=null?(o=i.name||"Error",s=i.message||i,n=_s(i,0)):(o=i,s=""),e.push(o+(s?": "+s:"")+n)}return lt&&(n=_s(t._stackHolder,2),n&&e.indexOf(n)===-1&&e.push(n),t._prev&&Hl(t._prev,e,r)),e}function Vl(t,e){var r=e?e._numPrev+1:0;r<lg&&(t._prev=e,t._numPrev=r)}function Fi(){In()&&Pn()}function In(){var t=Ss;return Ss=!1,Ci=!1,t}function Pn(){var t,e,r;do for(;On.length>0;)for(t=On,On=[],r=t.length,e=0;e<r;++e){var n=t[e];n[0].apply(null,n[1])}while(On.length>0);Ss=!0,Ci=!0}function Is(){var t=ar;ar=[],t.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var e=Ei.slice(0),r=e.length;r;)e[--r]()}function dg(t){function e(){t(),Ei.splice(Ei.indexOf(e),1)}Ei.push(e),++lr,Dn(()=>{--lr==0&&Is()},[])}function pg(t){ar.some(e=>e._value===t._value)||ar.push(t)}function hg(t){for(var e=ar.length;e;)if(ar[--e]._value===t._value){ar.splice(e,1);return}}function Ti(t){return new L(Tn,!1,t)}function ce(t,e){var r=z;return function(){var n=In(),i=z;try{return Pt(r,!0),t.apply(this,arguments)}catch(o){e&&e(o)}finally{Pt(i,!1),n&&Pn()}}}function It(t,e,r,n){var i=z,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++gg;var s=Lr.env;o.env=As?{Promise:L,PromiseProp:{value:L,configurable:!0,writable:!0},all:L.all,race:L.race,allSettled:L.allSettled,any:L.any,resolve:L.resolve,reject:L.reject,nthen:Ul(s.nthen,o),gthen:Ul(s.gthen,o)}:{},e&&Ne(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Br(o,t,r,n);return o.ref===0&&o.finalize(),a}function Nr(){return Me.id||(Me.id=++mg),++Me.awaits,Me.echoes+=Ll,Me.id}function _t(){return Me.awaits?(--Me.awaits==0&&(Me.id=0),Me.echoes=Me.awaits*Ll,!0):!1}function Ii(t){return Me.echoes&&t&&t.constructor===Ai?(Nr(),t.then(e=>(_t(),e),e=>(_t(),we(e)))):t}function yg(t){++Oi,(!Me.echoes||--Me.echoes==0)&&(Me.echoes=Me.id=0),Di.push(z),Pt(t,!0)}function _g(){var t=Di[Di.length-1];Di.pop(),Pt(t,!1)}function Pt(t,e){var r=z;if((e?Me.echoes&&(!Ps++||t!==z):Ps&&(!--Ps||t!==z))&&Wl(e?yg.bind(null,t):_g),t!==z&&(z=t,r===Lr&&(Lr.env=$l()),As)){var n=Lr.env.Promise,i=t.env;ji.then=i.nthen,n.prototype.then=i.gthen,(r.global||t.global)&&(Object.defineProperty(ae,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function $l(){var t=ae.Promise;return As?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(ae,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:ji.then,gthen:t.prototype.then}:{}}function Br(t,e,r,n,i){var o=z;try{return Pt(t,!0),e(r,n,i)}finally{Pt(o,!1)}}function Wl(t){Nl.call(ws,t)}function Pi(t,e,r,n){return typeof t!="function"?t:function(){var i=z;r&&Nr(),Pt(e,!0);try{return t.apply(this,arguments)}finally{Pt(i,!1),n&&Wl(_t)}}}function Ul(t,e){return function(r,n){return t.call(this,Pi(r,e),Pi(n,e))}}function Ql(t,e){var r;try{r=e.onuncatched(t)}catch{}if(r!==!1)try{var n,i={promise:e,reason:t};if(ae.document&&document.createEvent?(n=document.createEvent("Event"),n.initEvent(Gl,!0,!0),Ne(n,i)):ae.CustomEvent&&(n=new CustomEvent(Gl,{detail:i}),Ne(n,i)),n&&ae.dispatchEvent&&(dispatchEvent(n),!ae.PromiseRejectionEvent&&ae.onunhandledrejection))try{ae.onunhandledrejection(n)}catch{}lt&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}function ks(t,e,r,n){if(!t.idbdb||!t._state.openComplete&&!z.letThrough&&!t._vip){if(t._state.openComplete)return we(new V.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return we(new V.DatabaseClosed);t.open().catch(oe)}return t._state.dbReadyPromise.then(()=>ks(t,e,r,n))}else{var i=t._createTransaction(e,r,t._dbSchema);try{i.create(),t._state.PR1398_maxLoop=3}catch(o){return o.name===bs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>ks(t,e,r,n))):we(o)}return i._promise(e,(o,s)=>It(()=>(z.trans=i,n(o,s,i)))).then(o=>i._completion.then(()=>o))}}function cr(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}function Ri(t){return typeof t=="string"&&!/\./.test(t)?e=>(e[t]===void 0&&t in e&&(e=Sn(e),delete e[t]),e):e=>e}function Mn(t){var e={},r=function(a,u){if(u){for(var l=arguments.length,f=new Array(l-1);--l;)f[l-1]=arguments[l];return e[a].subscribe.apply(null,f),t}else if(typeof a=="string")return e[a]};r.addEventType=o;for(var n=1,i=arguments.length;n<i;++n)o(arguments[n]);return r;function o(a,u,l){if(typeof a=="object")return s(a);u||(u=ag),l||(l=oe);var f={subscribers:[],fire:l,subscribe:function(p){f.subscribers.indexOf(p)===-1&&(f.subscribers.push(p),f.fire=u(f.fire,p))},unsubscribe:function(p){f.subscribers=f.subscribers.filter(function(c){return c!==p}),f.fire=f.subscribers.reduce(u,l)}};return e[a]=r[a]=f,f}function s(a){_e(a).forEach(function(u){var l=a[u];if(ke(l))o(u,a[u][0],a[u][1]);else if(l==="asap")var f=o(u,Fn,function(){for(var c=arguments.length,h=new Array(c);c--;)h[c]=arguments[c];f.subscribers.forEach(function(w){El(function(){w.apply(null,h)})})});else throw new V.InvalidArgument("Invalid event config")})}}function Rn(t,e){return kr(e).from({prototype:t}),e}function xg(t){return Rn(Zl.prototype,function(r,n,i){this.db=t,this._tx=i,this.name=r,this.schema=n,this.hook=t._allTables[r]?t._allTables[r].hook:Mn(null,{creating:[ig,oe],reading:[ng,Fn],updating:[sg,oe],deleting:[og,oe]})})}function Kr(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Ns(t,e){t.filter=cr(t.filter,e)}function Bs(t,e,r){var n=t.replayFilter;t.replayFilter=n?()=>cr(n(),e()):e,t.justLimit=r&&!n}function wg(t,e){t.isMatch=cr(t.isMatch,e)}function Li(t,e){if(t.isPrimKey)return e.primaryKey;let r=e.getIndexByKeyPath(t.index);if(!r)throw new V.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return r}function eu(t,e,r){let n=Li(t,e.schema);return e.openCursor({trans:r,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:n,range:t.range}})}function Ni(t,e,r,n){let i=t.replayFilter?cr(t.filter,t.replayFilter()):t.filter;if(t.or){let o={},s=(a,u,l)=>{if(!i||i(u,l,c=>u.stop(c),c=>u.fail(c))){var f=u.primaryKey,p=""+f;p==="[object ArrayBuffer]"&&(p=""+new Uint8Array(f)),Ye(o,p)||(o[p]=!0,e(a,u,l))}};return Promise.all([t.or._iterate(s,r),tu(eu(t,n,r),t.algorithm,s,!t.keysOnly&&t.valueMapper)])}else return tu(eu(t,n,r),cr(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function tu(t,e,r,n){var i=n?(s,a,u)=>r(n(s),a,u):r,o=ce(i);return t.then(s=>{if(s)return s.start(()=>{var a=()=>s.continue();(!e||e(s,u=>a=u,u=>{s.stop(u),a=oe},u=>{s.fail(u),a=oe}))&&o(s.value,s,u=>a=u),a()})})}function Be(t,e){try{let r=ru(t),n=ru(e);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return Ag(nu(t),nu(e));case"Array":return jg(t,e)}}catch{}return NaN}function jg(t,e){let r=t.length,n=e.length,i=r<n?r:n;for(let o=0;o<i;++o){let s=Be(t[o],e[o]);if(s!==0)return s}return r===n?0:r<n?-1:1}function Ag(t,e){let r=t.length,n=e.length,i=r<n?r:n;for(let o=0;o<i;++o)if(t[o]!==e[o])return t[o]<e[o]?-1:1;return r===n?0:r<n?-1:1}function ru(t){let e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";let r=ms(t);return r==="ArrayBuffer"?"binary":r}function nu(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}function Cg(t){return Rn(iu.prototype,function(r,n){this.db=t;let i=Xl,o=null;if(n)try{i=n()}catch(l){o=l}let s=r._ctx,a=s.table,u=a.hook.reading.fire;this._ctx={table:a,index:s.index,isPrimKey:!s.index||a.schema.primKey.keyPath&&s.index===a.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:s.or,valueMapper:u!==Fn?u:null}})}function Sg(t,e){return t<e?-1:t===e?0:1}function Eg(t,e){return t>e?-1:t===e?0:1}function Je(t,e,r){var n=t instanceof zs?new t.Collection(t):t;return n._ctx.error=r?new r(e):new TypeError(e),n}function zr(t){return new t.Collection(t,()=>ou("")).limit(0)}function Fg(t){return t==="next"?e=>e.toUpperCase():e=>e.toLowerCase()}function Tg(t){return t==="next"?e=>e.toLowerCase():e=>e.toUpperCase()}function Dg(t,e,r,n,i,o){for(var s=Math.min(t.length,n.length),a=-1,u=0;u<s;++u){var l=e[u];if(l!==n[u])return i(t[u],r[u])<0?t.substr(0,u)+r[u]+r.substr(u+1):i(t[u],n[u])<0?t.substr(0,u)+n[u]+r.substr(u+1):a>=0?t.substr(0,a)+e[a]+r.substr(a+1):null;i(t[u],l)<0&&(a=u)}return s<n.length&&o==="next"?t+r.substr(t.length):s<t.length&&o==="prev"?t.substr(0,r.length):a<0?null:t.substr(0,a)+n[a]+r.substr(a+1)}function Bi(t,e,r,n){var i,o,s,a,u,l,f,p=r.length;if(!r.every(x=>typeof x=="string"))return Je(t,Yl);function c(x){i=Fg(x),o=Tg(x),s=x==="next"?Sg:Eg;var v=r.map(function(d){return{lower:o(d),upper:i(d)}}).sort(function(d,b){return s(d.lower,b.lower)});a=v.map(function(d){return d.upper}),u=v.map(function(d){return d.lower}),l=x,f=x==="next"?"":n}c("next");var h=new t.Collection(t,()=>kt(a[0],u[p-1]+n));h._ondirectionchange=function(x){c(x)};var w=0;return h._addAlgorithm(function(x,v,d){var b=x.key;if(typeof b!="string")return!1;var m=o(b);if(e(m,u,w))return!0;for(var g=null,y=w;y<p;++y){var _=Dg(b,m,a[y],u[y],s,l);_===null&&g===null?w=y+1:(g===null||s(g,_)>0)&&(g=_)}return v(g!==null?function(){x.continue(g+f)}:d),!1}),h}function kt(t,e,r,n){return{type:2,lower:t,upper:e,lowerOpen:r,upperOpen:n}}function ou(t){return{type:1,lower:t,upper:t}}function Og(t){return Rn(zs.prototype,function(r,n,i){this.db=t,this._ctx={table:r,index:n===":id"?null:n,or:i};let o=t._deps.indexedDB;if(!o)throw new V.MissingAPI;this._cmp=this._ascending=o.cmp.bind(o),this._descending=(s,a)=>o.cmp(a,s),this._max=(s,a)=>o.cmp(s,a)>0?s:a,this._min=(s,a)=>o.cmp(s,a)<0?s:a,this._IDBKeyRange=t._deps.IDBKeyRange})}function ut(t){return ce(function(e){return Ln(e),t(e.target.error),!1})}function Ln(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}function Ig(t){return Rn(su.prototype,function(r,n,i,o,s){this.db=t,this.mode=r,this.storeNames=n,this.schema=i,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=Mn(this,"complete","error","abort"),this.parent=s||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new L((a,u)=>{this._resolve=a,this._reject=u}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},a=>{var u=this.active;return this.active=!1,this.on.error.fire(a),this.parent?this.parent._reject(a):u&&this.idbtrans&&this.idbtrans.abort(),we(a)})})}function Hs(t,e,r,n,i,o,s){return{name:t,keyPath:e,unique:r,multi:n,auto:i,compound:o,src:(r&&!s?"&":"")+(n?"*":"")+(i?"++":"")+au(e)}}function au(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function lu(t,e,r){return{name:t,primKey:e,indexes:r,mappedClass:null,idxByName:Fl(r,n=>[n.name,n])}}function Pg(t){return t.length===1?t[0]:t}function Vs(t){return t==null?()=>{}:typeof t=="string"?kg(t):e=>gt(e,t)}function kg(t){return t.split(".").length===1?r=>r[t]:r=>gt(r,t)}function uu(t){return[].slice.call(t)}function Kn(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function Rg(t,e,r){function n(f,p){let c=uu(f.objectStoreNames);return{schema:{name:f.name,tables:c.map(h=>p.objectStore(h)).map(h=>{let{keyPath:w,autoIncrement:x}=h,v=ke(w),d=w==null,b={},m={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:d,compound:v,keyPath:w,autoIncrement:x,unique:!0,extractKey:Vs(w)},indexes:uu(h.indexNames).map(g=>h.index(g)).map(g=>{let{name:y,unique:_,multiEntry:A,keyPath:C}=g,F=ke(C),D={name:y,compound:F,keyPath:C,unique:_,multiEntry:A,extractKey:Vs(C)};return b[Kn(C)]=D,D}),getIndexByKeyPath:g=>b[Kn(g)]};return b[":id"]=m.primaryKey,w!=null&&(b[Kn(w)]=m.primaryKey),m})},hasGetAll:c.length>0&&"getAll"in p.objectStore(c[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(f){if(f.type===3)return null;if(f.type===4)throw new Error("Cannot convert never type to IDBKeyRange");let{lower:p,upper:c,lowerOpen:h,upperOpen:w}=f;return p===void 0?c===void 0?null:e.upperBound(c,!!w):c===void 0?e.lowerBound(p,!!h):e.bound(p,c,!!h,!!w)}function o(f){let p=f.name;function c({trans:x,type:v,keys:d,values:b,range:m}){return new Promise((g,y)=>{g=ce(g);let _=x.objectStore(p),A=_.keyPath==null,C=v==="put"||v==="add";if(!C&&v!=="delete"&&v!=="deleteRange")throw new Error("Invalid operation type: "+v);let{length:F}=d||b||{length:1};if(d&&b&&d.length!==b.length)throw new Error("Given keys array must have same length as given values array.");if(F===0)return g({numFailures:0,failures:{},results:[],lastResult:void 0});let D,P=[],N=[],k=0,H=J=>{++k,Ln(J)};if(v==="deleteRange"){if(m.type===4)return g({numFailures:k,failures:N,results:[],lastResult:void 0});m.type===3?P.push(D=_.clear()):P.push(D=_.delete(i(m)))}else{let[J,Y]=C?A?[b,d]:[b,null]:[d,null];if(C)for(let S=0;S<F;++S)P.push(D=Y&&Y[S]!==void 0?_[v](J[S],Y[S]):_[v](J[S])),D.onerror=H;else for(let S=0;S<F;++S)P.push(D=_[v](J[S])),D.onerror=H}let X=J=>{let Y=J.target.result;P.forEach((S,E)=>S.error!=null&&(N[E]=S.error)),g({numFailures:k,failures:N,results:v==="delete"?d:P.map(S=>S.result),lastResult:Y})};D.onerror=J=>{H(J),X(J)},D.onsuccess=X})}function h({trans:x,values:v,query:d,reverse:b,unique:m}){return new Promise((g,y)=>{g=ce(g);let{index:_,range:A}=d,C=x.objectStore(p),F=_.isPrimaryKey?C:C.index(_.name),D=b?m?"prevunique":"prev":m?"nextunique":"next",P=v||!("openKeyCursor"in F)?F.openCursor(i(A),D):F.openKeyCursor(i(A),D);P.onerror=ut(y),P.onsuccess=ce(N=>{let k=P.result;if(!k){g(null);return}k.___id=++Mg,k.done=!1;let H=k.continue.bind(k),X=k.continuePrimaryKey;X&&(X=X.bind(k));let J=k.advance.bind(k),Y=()=>{throw new Error("Cursor not started")},S=()=>{throw new Error("Cursor not stopped")};k.trans=x,k.stop=k.continue=k.continuePrimaryKey=k.advance=Y,k.fail=ce(y),k.next=function(){let E=1;return this.start(()=>E--?this.continue():this.stop()).then(()=>this)},k.start=E=>{let I=new Promise((Z,M)=>{Z=ce(Z),P.onerror=ut(M),k.fail=M,k.stop=ne=>{k.stop=k.continue=k.continuePrimaryKey=k.advance=S,Z(ne)}}),K=()=>{if(P.result)try{E()}catch(Z){k.fail(Z)}else k.done=!0,k.start=()=>{throw new Error("Cursor behind last entry")},k.stop()};return P.onsuccess=ce(Z=>{P.onsuccess=K,K()}),k.continue=H,k.continuePrimaryKey=X,k.advance=J,K(),I},g(k)},y)})}function w(x){return v=>new Promise((d,b)=>{d=ce(d);let{trans:m,values:g,limit:y,query:_}=v,A=y===1/0?void 0:y,{index:C,range:F}=_,D=m.objectStore(p),P=C.isPrimaryKey?D:D.index(C.name),N=i(F);if(y===0)return d({result:[]});if(x){let k=g?P.getAll(N,A):P.getAllKeys(N,A);k.onsuccess=H=>d({result:H.target.result}),k.onerror=ut(b)}else{let k=0,H=g||!("openKeyCursor"in P)?P.openCursor(N):P.openKeyCursor(N),X=[];H.onsuccess=J=>{let Y=H.result;if(!Y)return d({result:X});if(X.push(g?Y.value:Y.primaryKey),++k===y)return d({result:X});Y.continue()},H.onerror=ut(b)}})}return{name:p,schema:f,mutate:c,getMany({trans:x,keys:v}){return new Promise((d,b)=>{d=ce(d);let m=x.objectStore(p),g=v.length,y=new Array(g),_=0,A=0,C,F=P=>{let N=P.target;(y[N._pos]=N.result)!=null,++A===_&&d(y)},D=ut(b);for(let P=0;P<g;++P)v[P]!=null&&(C=m.get(v[P]),C._pos=P,C.onsuccess=F,C.onerror=D,++_);_===0&&d(y)})},get({trans:x,key:v}){return new Promise((d,b)=>{d=ce(d);let g=x.objectStore(p).get(v);g.onsuccess=y=>d(y.target.result),g.onerror=ut(b)})},query:w(a),openCursor:h,count({query:x,trans:v}){let{index:d,range:b}=x;return new Promise((m,g)=>{let y=v.objectStore(p),_=d.isPrimaryKey?y:y.index(d.name),A=i(b),C=A?_.count(A):_.count();C.onsuccess=ce(F=>m(F.target.result)),C.onerror=ut(g)})}}}let{schema:s,hasGetAll:a}=n(t,r),u=s.tables.map(f=>o(f)),l={};return u.forEach(f=>l[f.name]=f),{stack:"dbcore",transaction:t.transaction.bind(t),table(f){if(!l[f])throw new Error(`Table '${f}' not found`);return l[f]},MIN_KEY:-1/0,MAX_KEY:Bn(e),schema:s}}function Lg(t,e){return e.reduce((r,{create:n})=>he(he({},r),n(r)),t)}function Ng(t,e,{IDBKeyRange:r,indexedDB:n},i){return{dbcore:Lg(Rg(e,r,i),t.dbcore)}}function $s({_novip:t},e){let r=e.db,n=Ng(t._middlewares,r,t._deps,e);t.core=n.dbcore,t.tables.forEach(i=>{let o=i.name;t.core.schema.tables.some(s=>s.name===o)&&(i.core=t.core.table(o),t[o]instanceof t.Table&&(t[o].core=i.core))})}function Ki({_novip:t},e,r,n){r.forEach(i=>{let o=n[i];e.forEach(s=>{let a=ps(s,i);(!a||"value"in a&&a.value===void 0)&&(s===t.Transaction.prototype||s instanceof t.Transaction?mt(s,i,{get(){return this.table(i)},set(u){Cl(this,i,{value:u,writable:!0,configurable:!0,enumerable:!0})}}):s[i]=new t.Table(i,o))})})}function Ws({_novip:t},e){e.forEach(r=>{for(let n in r)r[n]instanceof t.Table&&delete r[n]})}function Bg(t,e){return t._cfg.version-e._cfg.version}function Kg(t,e,r,n){let i=t._dbSchema,o=t._createTransaction("readwrite",t._storeNames,i);o.create(r),o._completion.catch(n);let s=o._reject.bind(o),a=z.transless||z;It(()=>{z.trans=o,z.transless=a,e===0?(_e(i).forEach(u=>{Us(r,u,i[u].primKey,i[u].indexes)}),$s(t,r),L.follow(()=>t.on.populate.fire(o)).catch(s)):zg(t,e,o,r).catch(s)})}function zg({_novip:t},e,r,n){let i=[],o=t._versions,s=t._dbSchema=Qs(t,t.idbdb,n),a=!1;o.filter(f=>f._cfg.version>=e).forEach(f=>{i.push(()=>{let p=s,c=f._cfg.dbschema;qs(t,p,n),qs(t,c,n),s=t._dbSchema=c;let h=cu(p,c);h.add.forEach(x=>{Us(n,x[0],x[1].primKey,x[1].indexes)}),h.change.forEach(x=>{if(x.recreate)throw new V.Upgrade("Not yet support for changing primary key");{let v=n.objectStore(x.name);x.add.forEach(d=>Gs(v,d)),x.change.forEach(d=>{v.deleteIndex(d.name),Gs(v,d)}),x.del.forEach(d=>v.deleteIndex(d))}});let w=f._cfg.contentUpgrade;if(w&&f._cfg.version>e){$s(t,n),r._memoizedTables={},a=!0;let x=Tl(c);h.del.forEach(m=>{x[m]=p[m]}),Ws(t,[t.Transaction.prototype]),Ki(t,[t.Transaction.prototype],_e(x),x),r.schema=x;let v=ys(w);v&&Nr();let d,b=L.follow(()=>{if(d=w(r),d&&v){var m=_t.bind(null,null);d.then(m,m)}});return d&&typeof d.then=="function"?L.resolve(d):b.then(()=>d)}}),i.push(p=>{if(!a||!vg){let c=f._cfg.dbschema;Vg(c,p)}Ws(t,[t.Transaction.prototype]),Ki(t,[t.Transaction.prototype],t._storeNames,t._dbSchema),r.schema=t._dbSchema})});function l(){return i.length?L.resolve(i.shift()(r.idbtrans)).then(l):L.resolve()}return l().then(()=>{Hg(s,n)})}function cu(t,e){let r={del:[],add:[],change:[]},n;for(n in t)e[n]||r.del.push(n);for(n in e){let i=t[n],o=e[n];if(!i)r.add.push([n,o]);else{let s={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!ki)s.recreate=!0,r.change.push(s);else{let a=i.idxByName,u=o.idxByName,l;for(l in a)u[l]||s.del.push(l);for(l in u){let f=a[l],p=u[l];f?f.src!==p.src&&s.change.push(p):s.add.push(p)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}}}return r}function Us(t,e,r,n){let i=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(o=>Gs(i,o)),i}function Hg(t,e){_e(t).forEach(r=>{e.db.objectStoreNames.contains(r)||Us(e,r,t[r].primKey,t[r].indexes)})}function Vg(t,e){[].slice.call(e.db.objectStoreNames).forEach(r=>t[r]==null&&e.db.deleteObjectStore(r))}function Gs(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Qs(t,e,r){let n={};return bi(e.objectStoreNames,0).forEach(o=>{let s=r.objectStore(o),a=s.keyPath,u=Hs(au(a),a||"",!1,!1,!!s.autoIncrement,a&&typeof a!="string",!0),l=[];for(let p=0;p<s.indexNames.length;++p){let c=s.index(s.indexNames[p]);a=c.keyPath;var f=Hs(c.name,a,!!c.unique,!!c.multiEntry,!1,a&&typeof a!="string",!1);l.push(f)}n[o]=lu(o,u,l)}),n}function $g({_novip:t},e,r){t.verno=e.version/10;let n=t._dbSchema=Qs(t,e,r);t._storeNames=bi(e.objectStoreNames,0),Ki(t,[t._allTables],_e(n),n)}function Wg(t,e){let r=Qs(t,t.idbdb,e),n=cu(r,t._dbSchema);return!(n.add.length||n.change.some(i=>i.add.length||i.change.length))}function qs({_novip:t},e,r){let n=r.db.objectStoreNames;for(let i=0;i<n.length;++i){let o=n[i],s=r.objectStore(o);t._hasGetAll="getAll"in s;for(let a=0;a<s.indexNames.length;++a){let u=s.indexNames[a],l=s.index(u).keyPath,f=typeof l=="string"?l:"["+bi(l).join("+")+"]";if(e[o]){let p=e[o].idxByName[f];p&&(p.name=u,delete e[o].idxByName[f],e[o].idxByName[u]=p)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&ae.WorkerGlobalScope&&ae instanceof ae.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}function Ug(t){return t.split(",").map((e,r)=>{e=e.trim();let n=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Hs(n,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),ke(i),r===0)})}function Gg(t){return Rn(fu.prototype,function(r){this.db=t,this._cfg={version:r,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Ys(t,e){let r=t._dbNamesDB;return r||(r=t._dbNamesDB=new xt(Mi,{addons:[],indexedDB:t,IDBKeyRange:e}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function Js(t){return t&&typeof t.databases=="function"}function Qg({indexedDB:t,IDBKeyRange:e}){return Js(t)?Promise.resolve(t.databases()).then(r=>r.map(n=>n.name).filter(n=>n!==Mi)):Ys(t,e).toCollection().primaryKeys()}function qg({indexedDB:t,IDBKeyRange:e},r){!Js(t)&&r!==Mi&&Ys(t,e).put({name:r}).catch(oe)}function Yg({indexedDB:t,IDBKeyRange:e},r){!Js(t)&&r!==Mi&&Ys(t,e).delete(r).catch(oe)}function Xs(t){return It(function(){return z.letThrough=!0,t()})}function Jg(){var t=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!t||!indexedDB.databases)return Promise.resolve();var e;return new Promise(function(r){var n=function(){return indexedDB.databases().finally(r)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)})}function Xg(t){let e=t._state,{indexedDB:r}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?we(e.dbOpenError):t);lt&&(e.openCanceller._stackHolder=or()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;let n=e.openCanceller;function i(){if(e.openCanceller!==n)throw new V.DatabaseClosed("db.open() was cancelled")}let o=e.dbReadyResolve,s=null,a=!1;return L.race([n,(typeof navigator=="undefined"?L.resolve():Jg()).then(()=>new L((u,l)=>{if(i(),!r)throw new V.MissingAPI;let f=t.name,p=e.autoSchema?r.open(f):r.open(f,Math.round(t.verno*10));if(!p)throw new V.MissingAPI;p.onerror=ut(l),p.onblocked=ce(t._fireOnBlocked),p.onupgradeneeded=ce(c=>{if(s=p.transaction,e.autoSchema&&!t._options.allowEmptyDB){p.onerror=Ln,s.abort(),p.result.close();let w=r.deleteDatabase(f);w.onsuccess=w.onerror=ce(()=>{l(new V.NoSuchDatabase(`Database ${f} doesnt exist`))})}else{s.onerror=ut(l);var h=c.oldVersion>Math.pow(2,62)?0:c.oldVersion;a=h<1,t._novip.idbdb=p.result,Kg(t,h/10,s,l)}},l),p.onsuccess=ce(()=>{s=null;let c=t._novip.idbdb=p.result,h=bi(c.objectStoreNames);if(h.length>0)try{let w=c.transaction(Pg(h),"readonly");e.autoSchema?$g(t,c,w):(qs(t,t._dbSchema,w),Wg(t,w)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),$s(t,w)}catch{}kn.push(t),c.onversionchange=ce(w=>{e.vcFired=!0,t.on("versionchange").fire(w)}),c.onclose=ce(w=>{t.on("close").fire(w)}),a&&qg(t._deps,f),u()},l)}))]).then(()=>(i(),e.onReadyBeingFired=[],L.resolve(Xs(()=>t.on.ready.fire(t.vip))).then(function u(){if(e.onReadyBeingFired.length>0){let l=e.onReadyBeingFired.reduce(xs,oe);return e.onReadyBeingFired=[],L.resolve(Xs(()=>l(t.vip))).then(u)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(u=>{e.dbOpenError=u;try{s&&s.abort()}catch{}return n===e.openCanceller&&t._close(),we(u)}).finally(()=>{e.openComplete=!0,o()})}function Zs(t){var e=s=>t.next(s),r=s=>t.throw(s),n=o(e),i=o(r);function o(s){return a=>{var u=s(a),l=u.value;return u.done?l:!l||typeof l.then!="function"?ke(l)?Promise.all(l).then(n,i):n(l):l.then(n,i)}}return o(e)()}function Zg(t,e,r){var n=arguments.length;if(n<2)throw new V.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var o=Dl(i);return[t,o,r]}function du(t,e,r,n,i){return L.resolve().then(()=>{let o=z.transless||z,s=t._createTransaction(e,r,t._dbSchema,n),a={trans:s,transless:o};if(n)s.idbtrans=n.idbtrans;else try{s.create(),t._state.PR1398_maxLoop=3}catch(p){return p.name===bs.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>du(t,e,r,null,i))):we(p)}let u=ys(i);u&&Nr();let l,f=L.follow(()=>{if(l=i.call(s,s),l)if(u){var p=_t.bind(null,null);l.then(p,p)}else typeof l.next=="function"&&typeof l.throw=="function"&&(l=Zs(l))},a);return(l&&typeof l.then=="function"?L.resolve(l).then(p=>s.active?p:we(new V.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):f.then(()=>l)).then(p=>(n&&s._resolve(),s._completion.then(()=>p))).catch(p=>(s._reject(p),we(p)))})}function zi(t,e,r){let n=ke(t)?t.slice():[t];for(let i=0;i<r;++i)n.push(e);return n}function ey(t){return Re(he({},t),{table(e){let r=t.table(e),{schema:n}=r,i={},o=[];function s(c,h,w){let x=Kn(c),v=i[x]=i[x]||[],d=c==null?0:typeof c=="string"?1:c.length,b=h>0,m=Re(he({},w),{isVirtual:b,keyTail:h,keyLength:d,extractKey:Vs(c),unique:!b&&w.unique});if(v.push(m),m.isPrimaryKey||o.push(m),d>1){let g=d===2?c[0]:c.slice(0,d-1);s(g,h+1,w)}return v.sort((g,y)=>g.keyTail-y.keyTail),m}let a=s(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[a];for(let c of n.indexes)s(c.keyPath,0,c);function u(c){let h=i[Kn(c)];return h&&h[0]}function l(c,h){return{type:c.type===1?2:c.type,lower:zi(c.lower,c.lowerOpen?t.MAX_KEY:t.MIN_KEY,h),lowerOpen:!0,upper:zi(c.upper,c.upperOpen?t.MIN_KEY:t.MAX_KEY,h),upperOpen:!0}}function f(c){let h=c.query.index;return h.isVirtual?Re(he({},c),{query:{index:h,range:l(c.query.range,h.keyTail)}}):c}return Re(he({},r),{schema:Re(he({},n),{primaryKey:a,indexes:o,getIndexByKeyPath:u}),count(c){return r.count(f(c))},query(c){return r.query(f(c))},openCursor(c){let{keyTail:h,isVirtual:w,keyLength:x}=c.query.index;if(!w)return r.openCursor(c);function v(d){function b(g){g!=null?d.continue(zi(g,c.reverse?t.MAX_KEY:t.MIN_KEY,h)):c.unique?d.continue(d.key.slice(0,x).concat(c.reverse?t.MIN_KEY:t.MAX_KEY,h)):d.continue()}return Object.create(d,{continue:{value:b},continuePrimaryKey:{value(g,y){d.continuePrimaryKey(zi(g,t.MAX_KEY,h),y)}},primaryKey:{get(){return d.primaryKey}},key:{get(){let g=d.key;return x===1?g[0]:g.slice(0,x)}},value:{get(){return d.value}}})}return r.openCursor(f(c)).then(d=>d&&v(d))}})}})}function ea(t,e,r,n){return r=r||{},n=n||"",_e(t).forEach(i=>{if(!Ye(e,i))r[n+i]=void 0;else{var o=t[i],s=e[i];if(typeof o=="object"&&typeof s=="object"&&o&&s){let a=ms(o),u=ms(s);a!==u?r[n+i]=e[i]:a==="Object"?ea(o,s,r,n+i+"."):o!==s&&(r[n+i]=e[i])}else o!==s&&(r[n+i]=e[i])}}),_e(e).forEach(i=>{Ye(t,i)||(r[n+i]=e[i])}),r}function ry(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}function iy(t,e,r){return e.type==="add"?Promise.resolve([]):t.getMany({trans:e.trans,keys:r,cache:"immutable"})}function pu(t,e,r){try{if(!e||e.keys.length<t.length)return null;let n=[];for(let i=0,o=0;i<e.keys.length&&o<t.length;++i)Be(e.keys[i],t[o])===0&&(n.push(r?Sn(e.values[i]):e.values[i]),++o);return n.length===t.length?n:null}catch{return null}}function ta(t){return!("from"in t)}function zn(t,e,r){let n=Be(e,r);if(isNaN(n))return;if(n>0)throw RangeError();if(ta(t))return Ne(t,{from:e,to:r,d:1});let i=t.l,o=t.r;if(Be(r,t.from)<0)return i?zn(i,e,r):t.l={from:e,to:r,d:1,l:null,r:null},hu(t);if(Be(e,t.to)>0)return o?zn(o,e,r):t.r={from:e,to:r,d:1,l:null,r:null},hu(t);Be(e,t.from)<0&&(t.from=e,t.l=null,t.d=o?o.d+1:1),Be(r,t.to)>0&&(t.to=r,t.r=null,t.d=t.l?t.l.d+1:1);let s=!t.r;i&&!t.l&&Hi(t,i),o&&s&&Hi(t,o)}function Hi(t,e){function r(n,{from:i,to:o,l:s,r:a}){zn(n,i,o),s&&r(n,s),a&&r(n,a)}ta(e)||r(t,e)}function sy(t,e){let r=ra(e),n=r.next();if(n.done)return!1;let i=n.value,o=ra(t),s=o.next(i.from),a=s.value;for(;!n.done&&!s.done;){if(Be(a.from,i.to)<=0&&Be(a.to,i.from)>=0)return!0;Be(i.from,a.from)<0?i=(n=r.next(a.from)).value:a=(s=o.next(i.from)).value}return!1}function ra(t){let e=ta(t)?null:{s:0,n:t};return{next(r){let n=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,n)for(;e.n.l&&Be(r,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!n||Be(r,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function hu(t){var e,r;let n=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((r=t.l)===null||r===void 0?void 0:r.d)||0),i=n>1?"r":n<-1?"l":"";if(i){let o=i==="r"?"l":"r",s=he({},t),a=t[i];t.from=a.from,t.to=a.to,t[i]=a[i],s[i]=a[o],t[o]=s,s.d=mu(s)}t.d=mu(t)}function mu({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function ly(t,e,r,n){function i(o){let s=t(o.name||"");function a(l){return l!=null?o.extractKey(l):null}let u=l=>o.multiEntry&&ke(l)?l.forEach(f=>s.addKey(f)):s.addKey(l);(r||n).forEach((l,f)=>{let p=r&&a(r[f]),c=n&&a(n[f]);Be(p,c)!==0&&(p!=null&&u(p),c!=null&&u(c))})}e.indexes.forEach(i)}function yu(t,e){return _e(e).forEach(r=>{let n=t[r]||(t[r]=new bt);Hi(n,e[r])}),t}function cy(t){let e=!1,r,n=new gu(i=>{let o=ys(t);function s(v){o&&Nr();let d=()=>It(t,{subscr:v,trans:null}),b=z.trans?Br(z.transless,d):d();return o&&b.then(_t,_t),b}let a=!1,u={},l={},f={get closed(){return a},unsubscribe:()=>{a=!0,Rt.storagemutated.unsubscribe(w)}};i.start&&i.start(f);let p=!1,c=!1;function h(){return _e(l).some(v=>u[v]&&sy(u[v],l[v]))}let w=v=>{yu(u,v),h()&&x()},x=()=>{if(p||a)return;u={};let v={},d=s(v);c||(Rt(Nn,w),c=!0),p=!0,Promise.resolve(d).then(b=>{e=!0,r=b,p=!1,!a&&(h()?x():(u={},l=v,i.next&&i.next(b)))},b=>{p=!1,e=!1,i.error&&i.error(b),f.unsubscribe()})};return x(),f});return n.hasValue=()=>e,n.getValue=()=>r,n}function Vi(t){let e=wt;try{wt=!0,Rt.storagemutated.fire(t)}finally{wt=e}}function fy({data:t}){t&&t.type===Mt&&Vi(t.changedParts)}var ae,_e,ke,An,Vm,Cl,$m,Wm,Qm,Ol,qm,Ot,Ym,gs,Jm,Mr,ys,lt,Pl,Xm,Zm,kl,vs,eg,bs,tg,V,Rl,wi,Tn,lg,ug,Ll,ws,ji,js,Nl,Ai,As,Cs,cg,Dn,Ss,Ci,ar,Si,Es,Fs,Lr,z,On,lr,Ei,Ts,Me,mg,Di,Ps,Oi,gg,Gl,we,ql,ur,Ms,vt,Yl,kn,ki,vg,bg,Jl,Mi,Rs,Ls,Xl,Zl,iu,Ks,zs,Nn,Mt,Rt,su,Bn,Mg,fu,ty,ny,oy,bt,ay,xt,uy,gu,na,fr,wt,_u=j(()=>{ae=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,_e=Object.keys,ke=Array.isArray;typeof Promise!="undefined"&&!ae.Promise&&(ae.Promise=Promise);An=Object.getPrototypeOf,Vm={}.hasOwnProperty;Cl=Object.defineProperty;$m=Object.getOwnPropertyDescriptor;Wm=[].slice;Qm=[].concat;Ol="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Dl([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>ae[t]),qm=Ol.map(t=>ae[t]);Fl(Ol,t=>[t,!0]);Ot=null;({toString:Ym}={});gs=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",Jm=typeof gs=="symbol"?function(t){var e;return t!=null&&(e=t[gs])&&e.apply(t)}:function(){return null},Mr={};ys=typeof Symbol!="undefined"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1,lt=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);Pl=()=>!0,Xm=!new Error("").stack;Zm=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],kl=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],vs=Zm.concat(kl),eg={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};kr(Rr).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+_s(this._e,2))}},toString:function(){return this.name+": "+this.message}});kr(xi).from(Rr);kr(En).from(Rr);bs=vs.reduce((t,e)=>(t[e]=e+"Error",t),{}),tg=Rr,V=vs.reduce((t,e)=>{var r=e+"Error";function n(i,o){this._e=or(),this.name=r,i?typeof i=="string"?(this.message=`${i}${o?`
 `+o:""}`,this.inner=o||null):typeof i=="object"&&(this.message=`${i.name} ${i.message}`,this.inner=i):(this.message=eg[e]||r,this.inner=null)}return kr(n).from(tg),t[e]=n,t},{});V.Syntax=SyntaxError;V.Type=TypeError;V.Range=RangeError;Rl=kl.reduce((t,e)=>(t[e+"Error"]=V[e],t),{});wi=vs.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=V[e]),t),{});wi.ModifyError=xi;wi.DexieError=Rr;wi.BulkError=En;Tn={},lg=100,ug=20,Ll=100,[ws,ji,js]=typeof Promise=="undefined"?[]:(()=>{let t=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[t,An(t),t];let e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,An(e),t]})(),Nl=ji&&ji.then,Ai=ws&&ws.constructor,As=!!js,Cs=!1,cg=js?()=>{js.then(Fi)}:ae.setImmediate?setImmediate.bind(null,Fi):ae.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{Fi(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(Fi,0)},Dn=function(t,e){On.push([t,e]),Ci&&(cg(),Ci=!1)},Ss=!0,Ci=!0,ar=[],Si=[],Es=null,Fs=Fn,Lr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Ql,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{Ql(t[0],t[1])}catch{}})}},z=Lr,On=[],lr=0,Ei=[];Ts={get:function(){var t=z,e=Oi;function r(n,i){var o=!t.global&&(t!==z||e!==Oi);let s=o&&!_t();var a=new L((u,l)=>{Os(this,new Bl(Pi(n,t,o,s),Pi(i,t,o,s),u,l,t))});return lt&&Vl(a,this),a}return r.prototype=Tn,r},set:function(t){mt(this,"then",t&&t.prototype===Tn?Ts:{get:function(){return t},set:Ts.set})}};Pr(L.prototype,{then:Ts,_then:function(t,e){Os(this,new Bl(null,null,t,e,z))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],r=arguments[1];return typeof e=="function"?this.then(null,n=>n instanceof e?r(n):Ti(n)):this.then(null,n=>n&&n.name===e?r(n):Ti(n))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),Ti(e)))},stack:{get:function(){if(this._stack)return this._stack;try{Cs=!0;var t=Hl(this,[],ug),e=t.join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Cs=!1}}},timeout:function(t,e){return t<1/0?new L((r,n)=>{var i=setTimeout(()=>n(new V.Timeout(e)),t);this.then(r,n).finally(clearTimeout.bind(null,i))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&mt(L.prototype,Symbol.toStringTag,"Dexie.Promise");Lr.env=$l();Pr(L,{all:function(){var t=yt.apply(null,arguments).map(Ii);return new L(function(e,r){t.length===0&&e([]);var n=t.length;t.forEach((i,o)=>L.resolve(i).then(s=>{t[o]=s,--n||e(t)},r))})},resolve:t=>{if(t instanceof L)return t;if(t&&typeof t.then=="function")return new L((r,n)=>{t.then(r,n)});var e=new L(Tn,!0,t);return Vl(e,Es),e},reject:Ti,race:function(){var t=yt.apply(null,arguments).map(Ii);return new L((e,r)=>{t.map(n=>L.resolve(n).then(e,r))})},PSD:{get:()=>z,set:t=>z=t},totalEchoes:{get:()=>Oi},newPSD:It,usePSD:Br,scheduler:{get:()=>Dn,set:t=>{Dn=t}},rejectionMapper:{get:()=>Fs,set:t=>{Fs=t}},follow:(t,e)=>new L((r,n)=>It((i,o)=>{var s=z;s.unhandleds=[],s.onunhandled=o,s.finalize=sr(function(){dg(()=>{this.unhandleds.length===0?i():o(this.unhandleds[0])})},s.finalize),t()},e,r,n))});Ai&&(Ai.allSettled&&mt(L,"allSettled",function(){let t=yt.apply(null,arguments).map(Ii);return new L(e=>{t.length===0&&e([]);let r=t.length,n=new Array(r);t.forEach((i,o)=>L.resolve(i).then(s=>n[o]={status:"fulfilled",value:s},s=>n[o]={status:"rejected",reason:s}).then(()=>--r||e(n)))})}),Ai.any&&typeof AggregateError!="undefined"&&mt(L,"any",function(){let t=yt.apply(null,arguments).map(Ii);return new L((e,r)=>{t.length===0&&r(new AggregateError([]));let n=t.length,i=new Array(n);t.forEach((o,s)=>L.resolve(o).then(a=>e(a),a=>{i[s]=a,--n||r(new AggregateError(i))}))})}));Me={awaits:0,echoes:0,id:0},mg=0,Di=[],Ps=0,Oi=0,gg=0;(""+Nl).indexOf("[native code]")===-1&&(Nr=_t=oe);Gl="unhandledrejection";we=L.reject;ql="3.2.4",ur=String.fromCharCode(65535),Ms=-1/0,vt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Yl="String expected.",kn=[],ki=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),vg=ki,bg=ki,Jl=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),Mi="__dbnames",Rs="readonly",Ls="readwrite";Xl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};Zl=class{_trans(e,r,n){let i=this._tx||z.trans,o=this.name;function s(u,l,f){if(!f.schema[o])throw new V.NotFound("Table "+o+" not part of transaction");return r(f.idbtrans,f)}let a=In();try{return i&&i.db===this.db?i===z.trans?i._promise(e,s,n):It(()=>i._promise(e,s,n),{trans:i,transless:z.transless||z}):ks(this.db,e,[this.name],s)}finally{a&&Pn()}}get(e,r){return e&&e.constructor===Object?this.where(e).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:e}).then(i=>this.hook.reading.fire(i))).then(r)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(ke(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);let r=_e(e);if(r.length===1)return this.where(r[0]).equals(e[r[0]]);let n=this.schema.indexes.concat(this.schema.primKey).filter(l=>l.compound&&r.every(f=>l.keyPath.indexOf(f)>=0)&&l.keyPath.every(f=>r.indexOf(f)>=0))[0];if(n&&this.db._maxKey!==ur)return this.where(n.name).equals(n.keyPath.map(l=>e[l]));!n&&lt&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);let{idxByName:i}=this.schema,o=this.db._deps.indexedDB;function s(l,f){try{return o.cmp(l,f)===0}catch{return!1}}let[a,u]=r.reduce(([l,f],p)=>{let c=i[p],h=e[p];return[l||c,l||!c?cr(f,c&&c.multi?w=>{let x=gt(w,p);return ke(x)&&x.some(v=>s(h,v))}:w=>s(h,gt(w,p))):f]},[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(u):n?this.filter(u):this.where(r).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,ke(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;let r=n=>{if(!n)return n;let i=Object.create(e.prototype);for(var o in n)if(Ye(n,o))try{i[o]=n[o]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),e}defineClass(){function e(r){Ne(this,r)}return this.mapToClass(e)}add(e,r){let{auto:n,keyPath:i}=this.schema.primKey,o=e;return i&&n&&(o=Ri(i)(e)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"add",keys:r!=null?[r]:null,values:[o]})).then(s=>s.numFailures?L.reject(s.failures[0]):s.lastResult).then(s=>{if(i)try{it(e,i,s)}catch{}return s})}update(e,r){if(typeof e=="object"&&!ke(e)){let n=gt(e,this.schema.primKey.keyPath);if(n===void 0)return we(new V.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?_e(r).forEach(i=>{it(e,i,r[i])}):r(e,{value:e,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}else return this.where(":id").equals(e).modify(r)}put(e,r){let{auto:n,keyPath:i}=this.schema.primKey,o=e;return i&&n&&(o=Ri(i)(e)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"put",values:[o],keys:r!=null?[r]:null})).then(s=>s.numFailures?L.reject(s.failures[0]):s.lastResult).then(s=>{if(i)try{it(e,i,s)}catch{}return s})}delete(e){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[e]})).then(r=>r.numFailures?L.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Xl})).then(e=>e.numFailures?L.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",r=>this.core.getMany({keys:e,trans:r}).then(n=>n.map(i=>this.hook.reading.fire(i))))}bulkAdd(e,r,n){let i=Array.isArray(r)?r:void 0;n=n||(i?void 0:r);let o=n?n.allKeys:void 0;return this._trans("readwrite",s=>{let{auto:a,keyPath:u}=this.schema.primKey;if(u&&i)throw new V.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");let l=e.length,f=u&&a?e.map(Ri(u)):e;return this.core.mutate({trans:s,type:"add",keys:i,values:f,wantResults:o}).then(({numFailures:p,results:c,lastResult:h,failures:w})=>{let x=o?c:h;if(p===0)return x;throw new En(`${this.name}.bulkAdd(): ${p} of ${l} operations failed`,w)})})}bulkPut(e,r,n){let i=Array.isArray(r)?r:void 0;n=n||(i?void 0:r);let o=n?n.allKeys:void 0;return this._trans("readwrite",s=>{let{auto:a,keyPath:u}=this.schema.primKey;if(u&&i)throw new V.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");let l=e.length,f=u&&a?e.map(Ri(u)):e;return this.core.mutate({trans:s,type:"put",keys:i,values:f,wantResults:o}).then(({numFailures:p,results:c,lastResult:h,failures:w})=>{let x=o?c:h;if(p===0)return x;throw new En(`${this.name}.bulkPut(): ${p} of ${l} operations failed`,w)})})}bulkDelete(e){let r=e.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:e})).then(({numFailures:n,lastResult:i,failures:o})=>{if(n===0)return i;throw new En(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,o)})}};iu=class{_read(e,r){var n=this._ctx;return n.error?n.table._trans(null,we.bind(null,n.error)):n.table._trans("readonly",e).then(r)}_write(e){var r=this._ctx;return r.error?r.table._trans(null,we.bind(null,r.error)):r.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var r=this._ctx;r.algorithm=cr(r.algorithm,e)}_iterate(e,r){return Ni(this._ctx,e,r,this._ctx.table.core)}clone(e){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&Ne(n,e),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(e){var r=this._ctx;return this._read(n=>Ni(r,e,n,r.table.core))}count(e){return this._read(r=>{let n=this._ctx,i=n.table.core;if(Kr(n,!0))return i.count({trans:r,query:{index:Li(n,i.schema),range:n.range}}).then(s=>Math.min(s,n.limit));var o=0;return Ni(n,()=>(++o,!1),r,i).then(()=>o)}).then(e)}sortBy(e,r){let n=e.split(".").reverse(),i=n[0],o=n.length-1;function s(l,f){return f?s(l[n[f]],f-1):l[i]}var a=this._ctx.dir==="next"?1:-1;function u(l,f){var p=s(l,o),c=s(f,o);return p<c?-a:p>c?a:0}return this.toArray(function(l){return l.sort(u)}).then(r)}toArray(e){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&Kr(n,!0)&&n.limit>0){let{valueMapper:i}=n,o=Li(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then(({result:s})=>i?s.map(i):s)}else{let i=[];return Ni(n,o=>i.push(o),r,n.table.core).then(()=>i)}},e)}offset(e){var r=this._ctx;return e<=0?this:(r.offset+=e,Kr(r)?Bs(r,()=>{var n=e;return(i,o)=>n===0?!0:n===1?(--n,!1):(o(()=>{i.advance(n),n=0}),!1)}):Bs(r,()=>{var n=e;return()=>--n<0}),this)}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Bs(this._ctx,()=>{var r=e;return function(n,i,o){return--r<=0&&i(o),r>=0}},!0),this}until(e,r){return Ns(this._ctx,function(n,i,o){return e(n.value)?(i(o),r):!0}),this}first(e){return this.limit(1).toArray(function(r){return r[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){return Ns(this._ctx,function(r){return e(r.value)}),wg(this._ctx,e),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){e(i.key,i)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){e(i.primaryKey,i)})}keys(e){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,o){n.push(o.key)}).then(function(){return n}).then(e)}primaryKeys(e){var r=this._ctx;if(r.dir==="next"&&Kr(r,!0)&&r.limit>0)return this._read(i=>{var o=Li(r,r.table.core.schema);return r.table.core.query({trans:i,values:!1,limit:r.limit,query:{index:o,range:r.range}})}).then(({result:i})=>i).then(e);r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,o){n.push(o.primaryKey)}).then(function(){return n}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(r){return r[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,r=e.index&&e.table.schema.idxByName[e.index];if(!r||!r.multi)return this;var n={};return Ns(this._ctx,function(i){var o=i.primaryKey.toString(),s=Ye(n,o);return n[o]=!0,!s}),this}modify(e){var r=this._ctx;return this._write(n=>{var i;if(typeof e=="function")i=e;else{var o=_e(e),s=o.length;i=function(x){for(var v=!1,d=0;d<s;++d){var b=o[d],m=e[b];gt(x,b)!==m&&(it(x,b,m),v=!0)}return v}}let a=r.table.core,{outbound:u,extractKey:l}=a.schema.primaryKey,f=this.db._options.modifyChunkSize||200,p=[],c=0,h=[],w=(x,v)=>{let{failures:d,numFailures:b}=v;c+=x-b;for(let m of _e(d))p.push(d[m])};return this.clone().primaryKeys().then(x=>{let v=d=>{let b=Math.min(f,x.length-d);return a.getMany({trans:n,keys:x.slice(d,d+b),cache:"immutable"}).then(m=>{let g=[],y=[],_=u?[]:null,A=[];for(let F=0;F<b;++F){let D=m[F],P={value:Sn(D),primKey:x[d+F]};i.call(P,P.value,P)!==!1&&(P.value==null?A.push(x[d+F]):!u&&Be(l(D),l(P.value))!==0?(A.push(x[d+F]),g.push(P.value)):(y.push(P.value),u&&_.push(x[d+F])))}let C=Kr(r)&&r.limit===1/0&&(typeof e!="function"||e===Ks)&&{index:r.index,range:r.range};return Promise.resolve(g.length>0&&a.mutate({trans:n,type:"add",values:g}).then(F=>{for(let D in F.failures)A.splice(parseInt(D),1);w(g.length,F)})).then(()=>(y.length>0||C&&typeof e=="object")&&a.mutate({trans:n,type:"put",keys:_,values:y,criteria:C,changeSpec:typeof e!="function"&&e}).then(F=>w(y.length,F))).then(()=>(A.length>0||C&&e===Ks)&&a.mutate({trans:n,type:"delete",keys:A,criteria:C}).then(F=>w(A.length,F))).then(()=>x.length>d+b&&v(d+f))})};return v(0).then(()=>{if(p.length>0)throw new xi("Error modifying one or more objects",p,c,h);return x.length})})})}delete(){var e=this._ctx,r=e.range;return Kr(e)&&(e.isPrimKey&&!bg||r.type===3)?this._write(n=>{let{primaryKey:i}=e.table.core.schema,o=r;return e.table.core.count({trans:n,query:{index:i,range:o}}).then(s=>e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then(({failures:a,lastResult:u,results:l,numFailures:f})=>{if(f)throw new xi("Could not delete some values",Object.keys(a).map(p=>a[p]),s-f);return s-f}))}):this.modify(Ks)}},Ks=(t,e)=>e.value=null;zs=class{get Collection(){return this._ctx.table.db.Collection}between(e,r,n,i){n=n!==!1,i=i===!0;try{return this._cmp(e,r)>0||this._cmp(e,r)===0&&(n||i)&&!(n&&i)?zr(this):new this.Collection(this,()=>kt(e,r,!n,!i))}catch{return Je(this,vt)}}equals(e){return e==null?Je(this,vt):new this.Collection(this,()=>ou(e))}above(e){return e==null?Je(this,vt):new this.Collection(this,()=>kt(e,void 0,!0))}aboveOrEqual(e){return e==null?Je(this,vt):new this.Collection(this,()=>kt(e,void 0,!1))}below(e){return e==null?Je(this,vt):new this.Collection(this,()=>kt(void 0,e,!1,!0))}belowOrEqual(e){return e==null?Je(this,vt):new this.Collection(this,()=>kt(void 0,e))}startsWith(e){return typeof e!="string"?Je(this,Yl):this.between(e,e+ur,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):Bi(this,(r,n)=>r.indexOf(n[0])===0,[e],ur)}equalsIgnoreCase(e){return Bi(this,(r,n)=>r===n[0],[e],"")}anyOfIgnoreCase(){var e=yt.apply(Mr,arguments);return e.length===0?zr(this):Bi(this,(r,n)=>n.indexOf(r)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=yt.apply(Mr,arguments);return e.length===0?zr(this):Bi(this,(r,n)=>n.some(i=>r.indexOf(i)===0),e,ur)}anyOf(){let e=yt.apply(Mr,arguments),r=this._cmp;try{e.sort(r)}catch{return Je(this,vt)}if(e.length===0)return zr(this);let n=new this.Collection(this,()=>kt(e[0],e[e.length-1]));n._ondirectionchange=o=>{r=o==="next"?this._ascending:this._descending,e.sort(r)};let i=0;return n._addAlgorithm((o,s,a)=>{let u=o.key;for(;r(u,e[i])>0;)if(++i,i===e.length)return s(a),!1;return r(u,e[i])===0?!0:(s(()=>{o.continue(e[i])}),!1)}),n}notEqual(e){return this.inAnyRange([[Ms,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){let e=yt.apply(Mr,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Je(this,vt)}let r=e.reduce((n,i)=>n?n.concat([[n[n.length-1][1],i]]):[[Ms,i]],null);return r.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,r){let n=this._cmp,i=this._ascending,o=this._descending,s=this._min,a=this._max;if(e.length===0)return zr(this);if(!e.every(g=>g[0]!==void 0&&g[1]!==void 0&&i(g[0],g[1])<=0))return Je(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",V.InvalidArgument);let u=!r||r.includeLowers!==!1,l=r&&r.includeUppers===!0;function f(g,y){let _=0,A=g.length;for(;_<A;++_){let C=g[_];if(n(y[0],C[1])<0&&n(y[1],C[0])>0){C[0]=s(C[0],y[0]),C[1]=a(C[1],y[1]);break}}return _===A&&g.push(y),g}let p=i;function c(g,y){return p(g[0],y[0])}let h;try{h=e.reduce(f,[]),h.sort(c)}catch{return Je(this,vt)}let w=0,x=l?g=>i(g,h[w][1])>0:g=>i(g,h[w][1])>=0,v=u?g=>o(g,h[w][0])>0:g=>o(g,h[w][0])>=0;function d(g){return!x(g)&&!v(g)}let b=x,m=new this.Collection(this,()=>kt(h[0][0],h[h.length-1][1],!u,!l));return m._ondirectionchange=g=>{g==="next"?(b=x,p=i):(b=v,p=o),h.sort(c)},m._addAlgorithm((g,y,_)=>{for(var A=g.key;b(A);)if(++w,w===h.length)return y(_),!1;return d(A)?!0:(this._cmp(A,h[w][1])===0||this._cmp(A,h[w][0])===0||y(()=>{p===i?g.continue(h[w][0]):g.continue(h[w][1])}),!1)}),m}startsWithAnyOf(){let e=yt.apply(Mr,arguments);return e.every(r=>typeof r=="string")?e.length===0?zr(this):this.inAnyRange(e.map(r=>[r,r+ur])):Je(this,"startsWithAnyOf() only works with strings")}};Nn="storagemutated",Mt="x-storagemutated-1",Rt=Mn(null,Nn),su=class{_lock(){return Cn(!z.global),++this._reculock,this._reculock===1&&!z.global&&(z.lockOwnerFor=this),this}_unlock(){if(Cn(!z.global),--this._reculock==0)for(z.global||(z.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Br(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&z.lockOwnerFor!==this}create(e){if(!this.mode)return this;let r=this.db.idbdb,n=this.db._state.dbOpenError;if(Cn(!this.idbtrans),!e&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new V.DatabaseClosed(n);case"MissingAPIError":throw new V.MissingAPI(n.message,n);default:throw new V.OpenFailed(n)}if(!this.active)throw new V.TransactionInactive;return Cn(this._completion._state===null),e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),e.onerror=ce(i=>{Ln(i),this._reject(e.error)}),e.onabort=ce(i=>{Ln(i),this.active&&this._reject(new V.Abort(e.error)),this.active=!1,this.on("abort").fire(i)}),e.oncomplete=ce(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Rt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,r,n){if(e==="readwrite"&&this.mode!=="readwrite")return we(new V.ReadOnly("Transaction is readonly"));if(!this.active)return we(new V.TransactionInactive);if(this._locked())return new L((o,s)=>{this._blockedFuncs.push([()=>{this._promise(e,r,n).then(o,s)},z])});if(n)return It(()=>{var o=new L((s,a)=>{this._lock();let u=r(s,a,this);u&&u.then&&u.then(s,a)});return o.finally(()=>this._unlock()),o._lib=!0,o});var i=new L((o,s)=>{var a=r(o,s,this);a&&a.then&&a.then(o,s)});return i._lib=!0,i}_root(){return this.parent?this.parent._root():this}waitFor(e){var r=this._root();let n=L.resolve(e);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var i=r.idbtrans.objectStore(r.storeNames[0]);(function s(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(i.get(-1/0).onsuccess=s)})()}var o=r._waitingFor;return new L((s,a)=>{n.then(u=>r._waitingQueue.push(ce(s.bind(null,u))),u=>r._waitingQueue.push(ce(a.bind(null,u)))).finally(()=>{r._waitingFor===o&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new V.Abort))}table(e){let r=this._memoizedTables||(this._memoizedTables={});if(Ye(r,e))return r[e];let n=this.schema[e];if(!n)throw new V.NotFound("Table "+e+" not part of transaction");let i=new this.db.Table(e,n,this);return i.core=this.db.core.table(e),r[e]=i,i}};Bn=t=>{try{return t.only([[]]),Bn=()=>[[]],[[]]}catch{return Bn=()=>ur,ur}};Mg=0;fu=class{_parseStoresSpec(e,r){_e(e).forEach(n=>{if(e[n]!==null){var i=Ug(e[n]),o=i.shift();if(o.multi)throw new V.Schema("Primary key cannot be multi-valued");i.forEach(s=>{if(s.auto)throw new V.Schema("Only primary key can be marked as autoIncrement (++)");if(!s.keyPath)throw new V.Schema("Index must have a name and cannot be an empty string")}),r[n]=lu(n,o,i)}})}stores(e){let r=this.db;this._cfg.storesSource=this._cfg.storesSource?Ne(this._cfg.storesSource,e):e;let n=r._versions,i={},o={};return n.forEach(s=>{Ne(i,s._cfg.storesSource),o=s._cfg.dbschema={},s._parseStoresSpec(i,o)}),r._dbSchema=o,Ws(r,[r._allTables,r,r.Transaction.prototype]),Ki(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],_e(o),o),r._storeNames=_e(o),this}upgrade(e){return this._cfg.contentUpgrade=xs(this._cfg.contentUpgrade||oe,e),this}};ty={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:ey};ny={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>Re(he({},t),{table(e){let r=t.table(e),{primaryKey:n}=r.schema;return Re(he({},r),{mutate(o){let s=z.trans,{deleting:a,creating:u,updating:l}=s.table(e).hook;switch(o.type){case"add":if(u.fire===oe)break;return s._promise("readwrite",()=>f(o),!0);case"put":if(u.fire===oe&&l.fire===oe)break;return s._promise("readwrite",()=>f(o),!0);case"delete":if(a.fire===oe)break;return s._promise("readwrite",()=>f(o),!0);case"deleteRange":if(a.fire===oe)break;return s._promise("readwrite",()=>p(o),!0)}return r.mutate(o);function f(h){let w=z.trans,x=h.keys||ry(n,h);if(!x)throw new Error("Keys missing");return h=h.type==="add"||h.type==="put"?Re(he({},h),{keys:x}):he({},h),h.type!=="delete"&&(h.values=[...h.values]),h.keys&&(h.keys=[...h.keys]),iy(r,h,x).then(v=>{let d=x.map((b,m)=>{let g=v[m],y={onerror:null,onsuccess:null};if(h.type==="delete")a.fire.call(y,b,g,w);else if(h.type==="add"||g===void 0){let _=u.fire.call(y,b,h.values[m],w);b==null&&_!=null&&(b=_,h.keys[m]=b,n.outbound||it(h.values[m],n.keyPath,b))}else{let _=ea(g,h.values[m]),A=l.fire.call(y,_,b,g,w);if(A){let C=h.values[m];Object.keys(A).forEach(F=>{Ye(C,F)?C[F]=A[F]:it(C,F,A[F])})}}return y});return r.mutate(h).then(({failures:b,results:m,numFailures:g,lastResult:y})=>{for(let _=0;_<x.length;++_){let A=m?m[_]:x[_],C=d[_];A==null?C.onerror&&C.onerror(b[_]):C.onsuccess&&C.onsuccess(h.type==="put"&&v[_]?h.values[_]:A)}return{failures:b,results:m,numFailures:g,lastResult:y}}).catch(b=>(d.forEach(m=>m.onerror&&m.onerror(b)),Promise.reject(b)))})}function p(h){return c(h.trans,h.range,1e4)}function c(h,w,x){return r.query({trans:h,values:!1,query:{index:n,range:w},limit:x}).then(({result:v})=>f({type:"delete",keys:v,trans:h}).then(d=>d.numFailures>0?Promise.reject(d.failures[0]):v.length<x?{failures:[],numFailures:0,lastResult:void 0}:c(h,Re(he({},w),{lower:v[v.length-1],lowerOpen:!0}),x)))}}})}})};oy={stack:"dbcore",level:-1,create:t=>({table:e=>{let r=t.table(e);return Re(he({},r),{getMany:n=>{if(!n.cache)return r.getMany(n);let i=pu(n.keys,n.trans._cache,n.cache==="clone");return i?L.resolve(i):r.getMany(n).then(o=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?Sn(o):o},o))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))})}})};bt=function(t,e){if(this)Ne(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0});else{let r=new bt;return t&&"d"in t&&Ne(r,t),r}};Pr(bt.prototype,{add(t){return Hi(this,t),this},addKey(t){return zn(this,t,t),this},addKeys(t){return t.forEach(e=>zn(this,e,e)),this},[gs](){return ra(this)}});ay={stack:"dbcore",level:0,create:t=>{let e=t.schema.name,r=new bt(t.MIN_KEY,t.MAX_KEY);return Re(he({},t),{table:n=>{let i=t.table(n),{schema:o}=i,{primaryKey:s}=o,{extractKey:a,outbound:u}=s,l=Re(he({},i),{mutate:c=>{let h=c.trans,w=h.mutatedParts||(h.mutatedParts={}),x=_=>{let A=`idb://${e}/${n}/${_}`;return w[A]||(w[A]=new bt)},v=x(""),d=x(":dels"),{type:b}=c,[m,g]=c.type==="deleteRange"?[c.range]:c.type==="delete"?[c.keys]:c.values.length<50?[[],c.values]:[],y=c.trans._cache;return i.mutate(c).then(_=>{if(ke(m)){b!=="delete"&&(m=_.results),v.addKeys(m);let A=pu(m,y);!A&&b!=="add"&&d.addKeys(m),(A||g)&&ly(x,o,A,g)}else if(m){let A={from:m.lower,to:m.upper};d.add(A),v.add(A)}else v.add(r),d.add(r),o.indexes.forEach(A=>x(A.name).add(r));return _})}}),f=({query:{index:c,range:h}})=>{var w,x;return[c,new bt((w=h.lower)!==null&&w!==void 0?w:t.MIN_KEY,(x=h.upper)!==null&&x!==void 0?x:t.MAX_KEY)]},p={get:c=>[s,new bt(c.key)],getMany:c=>[s,new bt().addKeys(c.keys)],count:f,query:f,openCursor:f};return _e(p).forEach(c=>{l[c]=function(h){let{subscr:w}=z;if(w){let x=g=>{let y=`idb://${e}/${n}/${g}`;return w[y]||(w[y]=new bt)},v=x(""),d=x(":dels"),[b,m]=p[c](h);if(x(b.name||"").add(m),!b.isPrimaryKey)if(c==="count")d.add(r);else{let g=c==="query"&&u&&h.values&&i.query(Re(he({},h),{values:!1}));return i[c].apply(this,arguments).then(y=>{if(c==="query"){if(u&&h.values)return g.then(({result:A})=>(v.addKeys(A),y));let _=h.values?y.result.map(a):y.result;h.values?v.addKeys(_):d.addKeys(_)}else if(c==="openCursor"){let _=y,A=h.values;return _&&Object.create(_,{key:{get(){return d.addKey(_.primaryKey),_.key}},primaryKey:{get(){let C=_.primaryKey;return d.addKey(C),C}},value:{get(){return A&&v.addKey(_.primaryKey),_.value}}})}return y})}}return i[c].apply(this,arguments)}}),l}})}};xt=class{constructor(e,r){this._middlewares={},this.verno=0;let n=xt.dependencies;this._options=r=he({addons:xt.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};let{addons:i}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;let o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:oe,dbReadyPromise:null,cancelOpen:oe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};o.dbReadyPromise=new L(s=>{o.dbReadyResolve=s}),o.openCanceller=new L((s,a)=>{o.cancelOpen=a}),this._state=o,this.name=e,this.on=Mn(this,"populate","blocked","versionchange","close",{ready:[xs,oe]}),this.on.ready.subscribe=Sl(this.on.ready.subscribe,s=>(a,u)=>{xt.vip(()=>{let l=this._state;if(l.openComplete)l.dbOpenError||L.resolve().then(a),u&&s(a);else if(l.onReadyBeingFired)l.onReadyBeingFired.push(a),u&&s(a);else{s(a);let f=this;u||s(function p(){f.on.ready.unsubscribe(a),f.on.ready.unsubscribe(p)})}})}),this.Collection=Cg(this),this.Table=xg(this),this.Transaction=Ig(this),this.Version=Gg(this),this.WhereClause=Og(this),this.on("versionchange",s=>{s.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",s=>{!s.newVersion||s.newVersion<s.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${s.oldVersion/10}`)}),this._maxKey=Bn(r.IDBKeyRange),this._createTransaction=(s,a,u,l)=>new this.Transaction(s,a,u,this._options.chromeTransactionDurability,l),this._fireOnBlocked=s=>{this.on("blocked").fire(s),kn.filter(a=>a.name===this.name&&a!==this&&!a._state.vcFired).map(a=>a.on("versionchange").fire(s))},this.use(ty),this.use(ny),this.use(ay),this.use(oy),this.vip=Object.create(this,{_vip:{value:!0}}),i.forEach(s=>s(this))}version(e){if(isNaN(e)||e<.1)throw new V.Type("Given version is not a positive number");if(e=Math.round(e*10)/10,this.idbdb||this._state.isBeingOpened)throw new V.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);let r=this._versions;var n=r.filter(i=>i._cfg.version===e)[0];return n||(n=new this.Version(e),r.push(n),r.sort(Bg),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||z.letThrough||this._vip)?e():new L((r,n)=>{if(this._state.openComplete)return n(new V.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen){n(new V.DatabaseClosed);return}this.open().catch(oe)}this._state.dbReadyPromise.then(r,n)}).then(e)}use({stack:e,create:r,level:n,name:i}){i&&this.unuse({stack:e,name:i});let o=this._middlewares[e]||(this._middlewares[e]=[]);return o.push({stack:e,create:r,level:n??10,name:i}),o.sort((s,a)=>s.level-a.level),this}unuse({stack:e,name:r,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(i=>n?i.create!==n:r?i.name!==r:!1)),this}open(){return Xg(this)}_close(){let e=this._state,r=kn.indexOf(this);if(r>=0&&kn.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new L(n=>{e.dbReadyResolve=n}),e.openCanceller=new L((n,i)=>{e.cancelOpen=i})}close(){this._close();let e=this._state;this._options.autoOpen=!1,e.dbOpenError=new V.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){let e=arguments.length>0,r=this._state;return new L((n,i)=>{let o=()=>{this.close();var s=this._deps.indexedDB.deleteDatabase(this.name);s.onsuccess=ce(()=>{Yg(this._deps,this.name),n()}),s.onerror=ut(i),s.onblocked=this._fireOnBlocked};if(e)throw new V.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){let e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return _e(this._allTables).map(e=>this._allTables[e])}transaction(){let e=Zg.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,r,n){let i=z.trans;(!i||i.db!==this||e.indexOf("!")!==-1)&&(i=null);let o=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");let s,a;try{if(a=r.map(l=>{var f=l instanceof this.Table?l.name:l;if(typeof f!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return f}),e=="r"||e===Rs)s=Rs;else if(e=="rw"||e==Ls)s=Ls;else throw new V.InvalidArgument("Invalid transaction mode: "+e);if(i){if(i.mode===Rs&&s===Ls)if(o)i=null;else throw new V.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i&&a.forEach(l=>{if(i&&i.storeNames.indexOf(l)===-1)if(o)i=null;else throw new V.SubTransaction("Table "+l+" not included in parent transaction.")}),o&&i&&!i.active&&(i=null)}}catch(l){return i?i._promise(null,(f,p)=>{p(l)}):we(l)}let u=du.bind(null,this,s,a,i,n);return i?i._promise(s,u,"lock"):z.trans?Br(z.transless,()=>this._whenReady(u)):this._whenReady(u)}table(e){if(!Ye(this._allTables,e))throw new V.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}},uy=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",gu=class{constructor(e){this._subscribe=e}subscribe(e,r,n){return this._subscribe(!e||typeof e=="function"?{next:e,error:r,complete:n}:e)}[uy](){return this}};try{na={indexedDB:ae.indexedDB||ae.mozIndexedDB||ae.webkitIndexedDB||ae.msIndexedDB,IDBKeyRange:ae.IDBKeyRange||ae.webkitIDBKeyRange}}catch{na={indexedDB:null,IDBKeyRange:null}}fr=xt;Pr(fr,Re(he({},wi),{delete(t){return new fr(t,{addons:[]}).delete()},exists(t){return new fr(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1)},getDatabaseNames(t){try{return Qg(fr.dependencies).then(t)}catch{return we(new V.MissingAPI)}},defineClass(){function t(e){Ne(this,e)}return t},ignoreTransaction(t){return z.trans?Br(z.transless,t):t()},vip:Xs,async:function(t){return function(){try{var e=Zs(t.apply(this,arguments));return!e||typeof e.then!="function"?L.resolve(e):e}catch(r){return we(r)}}},spawn:function(t,e,r){try{var n=Zs(t.apply(r,e||[]));return!n||typeof n.then!="function"?L.resolve(n):n}catch(i){return we(i)}},currentTransaction:{get:()=>z.trans||null},waitFor:function(t,e){let r=L.resolve(typeof t=="function"?fr.ignoreTransaction(t):t).timeout(e||6e4);return z.trans?z.trans.waitFor(r):r},Promise:L,debug:{get:()=>lt,set:t=>{Il(t,t==="dexie"?()=>!0:Jl)}},derive:kr,extend:Ne,props:Pr,override:Sl,Events:Mn,on:Rt,liveQuery:cy,extendObservabilitySet:yu,getByKeyPath:gt,setByKeyPath:it,delByKeyPath:Gm,shallowClone:Tl,deepClone:Sn,getObjectDiff:ea,cmp:Be,asap:El,minKey:Ms,addons:[],connections:kn,errnames:bs,dependencies:na,semVer:ql,version:ql.split(".").map(t=>parseInt(t)).reduce((t,e,r)=>t+e/Math.pow(10,r*2))}));fr.maxKey=Bn(fr.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(Rt(Nn,t=>{if(!wt){let e;ki?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Mt,!0,!0,t)):e=new CustomEvent(Mt,{detail:t}),wt=!0,dispatchEvent(e),wt=!1}}),addEventListener(Mt,({detail:t})=>{wt||Vi(t)}));wt=!1;if(typeof BroadcastChannel!="undefined"){let t=new BroadcastChannel(Mt);typeof t.unref=="function"&&t.unref(),Rt(Nn,e=>{wt||t.postMessage(e)}),t.onmessage=e=>{e.data&&Vi(e.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){Rt(Nn,e=>{try{wt||(typeof localStorage!="undefined"&&localStorage.setItem(Mt,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:Mt,changedParts:e})))}catch{}}),typeof addEventListener!="undefined"&&addEventListener("storage",e=>{if(e.key===Mt){let r=JSON.parse(e.newValue);r&&Vi(r.changedParts)}});let t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",fy)}L.rejectionMapper=rg;Il(lt,Jl)});var vu,ct,Hr,Ee,$i=j(()=>{_u();vu=ge(require("obsidian")),ct=class extends xt{constructor(){super(ct.dbName);this.version(ct.dbVersion).stores({searchHistory:"++id",minisearch:"date"})}static async clearOldDatabases(){let e=(await indexedDB.databases()).filter(r=>r.name===ct.dbName&&r.version!==ct.dbVersion*10);if(e.length){console.log("Omnisearch - Those IndexedDb databases will be deleted:");for(let r of e)r.name&&indexedDB.deleteDatabase(r.name)}}static getInstance(){return ct.instance||(ct.instance=new ct),ct.instance}async clearCache(){new vu.Notice("Omnisearch - Cache cleared. Please restart Obsidian."),await this.minisearch.clear()}},Hr=ct;Hr.dbVersion=8,Hr.dbName="omnisearch/cache/"+app.appId;Ee=Hr.getInstance()});async function bu(t){T=Object.assign({},Lt,await t.loadData()),dr.set(T.showExcerpt)}async function le(t){await t.saveData(T)}function oa(){return app.loadLocalStorage(Hn)==="1"}function xu(){return T.unsupportedFilesIndexing==="yes"||T.unsupportedFilesIndexing==="default"&&!!app.vault.getConfig("showUnsupportedFiles")}var $,dr,Wi,ia,Lt,T,Ze=j(()=>{$=ge(require("obsidian"));ds();$i();ot();dr=vi(!1),Wi='<strong style="color: var(--text-accent)">Needs a restart to fully take effect.</strong>',ia=class extends $.PluginSettingTab{constructor(e){super(app,e);this.plugin=e,dr.subscribe(async r=>{T.showExcerpt=r,await le(this.plugin)})}display(){let{containerEl:e}=this;if(e.empty(),app.loadLocalStorage(Hn)=="1"){let c=e.createEl("span");c.innerHTML='<strong style="color: var(--text-accent)">\u26A0\uFE0F OMNISEARCH IS DISABLED \u26A0\uFE0F</strong>'}e.createEl("h2",{text:"Omnisearch"});let r=e.createDiv();r.innerHTML=`
        <iframe src="https://github.com/sponsors/scambier/button" title="Sponsor scambier" height="35" width="116" style="border: 0;"></iframe>
        <a href='https://ko-fi.com/B0B6LQ2C' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://cdn.ko-fi.com/cdn/kofi2.png?v=3' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a> 
    `;let n=new DocumentFragment;n.createSpan({},c=>{c.innerHTML='\u26A0\uFE0F <span style="color: var(--text-accent)">Changing indexing settings will clear the cache, and requires a restart of Obsidian.</span><br/><br/>',ft()?c.innerHTML+=`
        \u{1F44D} You have installed <a href="https://github.com/scambier/obsidian-text-extractor">Text Extractor</a>, Omnisearch can use it to index PDFs and images contents.
            <br />Text extraction only works on desktop, but the cache can be synchronized with your mobile device.`:c.innerHTML+='\u26A0\uFE0F Omnisearch requires <a href="https://github.com/scambier/obsidian-text-extractor">Text Extractor</a> to index PDFs and images.'}),new $.Setting(e).setName("Indexing").setHeading().setDesc(n);let i=new DocumentFragment;i.createSpan({},c=>{c.innerHTML="Omnisearch will use Text Extractor to index the content of your PDFs"}),new $.Setting(e).setName(`PDFs content indexing ${ft()?"":"\u26A0\uFE0F Disabled"}`).setDesc(i).addToggle(c=>c.setValue(T.PDFIndexing).onChange(async h=>{await Ee.clearCache(),T.PDFIndexing=h,await le(this.plugin)})).setDisabled(!ft());let o=new DocumentFragment;o.createSpan({},c=>{c.innerHTML="Omnisearch will use Text Extractor to OCR your images and index their content"}),new $.Setting(e).setName(`Images OCR indexing ${ft()?"":"\u26A0\uFE0F Disabled"}`).setDesc(o).addToggle(c=>c.setValue(T.imagesIndexing).onChange(async h=>{await Ee.clearCache(),T.imagesIndexing=h,await le(this.plugin)})).setDisabled(!ft());let s=new DocumentFragment;s.createSpan({},c=>{c.innerHTML=`
      Omnisearch can index file<strong>names</strong> of "unsupported" files, such as e.g. <pre style="display:inline">.mp4</pre>, <pre style="display:inline">.xlsx</pre>, 
      or non-extracted PDFs & images.<br/>
      "Obsidian setting" will respect the value of "Files & Links > Detect all file extensions"`}),new $.Setting(e).setName("Index paths of unsupported files").setDesc(s).addDropdown(c=>{c.addOptions({yes:"Yes",no:"No",default:"Obsidian setting"}).setValue(T.unsupportedFilesIndexing).onChange(async h=>{await Ee.clearCache(),T.unsupportedFilesIndexing=h,await le(this.plugin)})});let a=new DocumentFragment;a.createSpan({},c=>{c.innerHTML=`In addition to standard <code>md</code> files, Omnisearch can also index other <strong style="color: var(--text-accent)">PLAINTEXT</strong> files.<br/>
      Add extensions separated by a space, without the dot. Example: "<code>txt org csv</code>".<br />
      \u26A0\uFE0F <span style="color: var(--text-accent)">Using extensions of non-plaintext files (like .docx or .pptx) WILL cause crashes,
      because Omnisearch will try to index their content.</span>`}),new $.Setting(e).setName("Additional TEXT files to index").setDesc(a).addText(c=>{c.setValue(T.indexedFileTypes.join(" ")).setPlaceholder("Example: txt org csv").onChange(async h=>{await Ee.clearCache(),T.indexedFileTypes=h.split(" "),await le(this.plugin)})}),new $.Setting(e).setName("Behavior").setHeading(),new $.Setting(e).setName("Save index to cache").setDesc("Enable caching to speed up indexing time. In rare cases, the cache write may cause a crash in Obsidian. This option will disable itself if it happens.").addToggle(c=>c.setValue(T.useCache).onChange(async h=>{T.useCache=h,await le(this.plugin)})),new $.Setting(e).setName(`Respect Obsidian's "Excluded Files"`).setDesc(`By default, files that are in Obsidian's "Options > Files & Links > Excluded Files" list are downranked in results.
        Enable this option to completely hide them`).addToggle(c=>c.setValue(T.hideExcluded).onChange(async h=>{T.hideExcluded=h,await le(this.plugin)}));let u=new DocumentFragment;u.createSpan({},c=>{c.innerHTML=`Enable this if you want to be able to search for CamelCaseWords as separate words.<br/>        
        \u26A0\uFE0F <span style="color: var(--text-accent)">Changing this setting will clear the cache.</span><br>
        ${Wi}
        `}),new $.Setting(e).setName("Split CamelCaseWords").setDesc(u).addToggle(c=>c.setValue(T.splitCamelCase).onChange(async h=>{await Ee.clearCache(),T.splitCamelCase=h,await le(this.plugin)})),new $.Setting(e).setName("Simpler search").setDesc(`Enable this if Obsidian often freezes while making searches.
        Words shorter than 3 characters won't be used as prefixes; this can reduce search delay but will return fewer results.`).addToggle(c=>c.setValue(T.simpleSearch).onChange(async h=>{T.simpleSearch=h,await le(this.plugin)})),new $.Setting(e).setName("Open in new pane").setDesc("Open and create files in a new pane instead of the current pane.").addToggle(c=>c.setValue(T.openInNewPane).onChange(async h=>{T.openInNewPane=h,await le(this.plugin)})),new $.Setting(e).setName("Set Vim like navigation keys").setDesc("Navigate down the results with Ctrl/\u2318 + J/N, or navigate up with Ctrl/\u2318 + K/P").addToggle(c=>c.setValue(T.vimLikeNavigationShortcut).onChange(async h=>{T.vimLikeNavigationShortcut=h,await le(this.plugin)})),new $.Setting(e).setName("Fuzziness").setDesc("Define the level of fuzziness for the search. The higher the fuzziness, the more results you'll get.").addDropdown(c=>c.addOptions({0:"Exact match",1:"Not too fuzzy",2:"Fuzzy enough"}).setValue(T.fuzziness).onChange(async h=>{["0","1","2"].includes(h)||(h="2"),T.fuzziness=h,await le(this.plugin)})),new $.Setting(e).setName("User Interface").setHeading(),new $.Setting(e).setName("Show ribbon button").setDesc("Add a button on the sidebar to open the Vault search modal.").addToggle(c=>c.setValue(T.ribbonIcon).onChange(async h=>{T.ribbonIcon=h,await le(this.plugin),h?this.plugin.addRibbonButton():this.plugin.removeRibbonButton()})),new $.Setting(e).setName("Show excerpts").setDesc("Shows the contextual part of the note that matches the search. Disable this to only show filenames in results.").addToggle(c=>c.setValue(T.showExcerpt).onChange(async h=>{dr.set(h)})),new $.Setting(e).setName("Render line return in excerpts").setDesc("Activate this option to render line returns in result excerpts.").addToggle(c=>c.setValue(T.renderLineReturnInExcerpts).onChange(async h=>{T.renderLineReturnInExcerpts=h,await le(this.plugin)})),new $.Setting(e).setName("Show previous query results").setDesc("Re-executes the previous query when opening Omnisearch.").addToggle(c=>c.setValue(T.showPreviousQueryResults).onChange(async h=>{T.showPreviousQueryResults=h,await le(this.plugin)}));let l=new DocumentFragment;if(l.createSpan({},c=>{c.innerHTML=`Shows a button next to the search input, to create a note.
        Acts the same as the <code>shift \u21B5</code> shortcut, can be useful for mobile device users.`}),new $.Setting(e).setName('Show "Create note" button').setDesc(l).addToggle(c=>c.setValue(T.showCreateButton).onChange(async h=>{T.showCreateButton=h,await le(this.plugin)})),new $.Setting(e).setName("Highlight matching words in results").setDesc("Will highlight matching results when enabled. See README for more customization options.").addToggle(c=>c.setValue(T.highlight).onChange(async h=>{T.highlight=h,await le(this.plugin)})),new $.Setting(e).setName("Results weighting").setHeading(),new $.Setting(e).setName(`File name & declared aliases (default: ${Lt.weightBasename})`).addSlider(c=>this.weightSlider(c,"weightBasename")),new $.Setting(e).setName(`File directory (default: ${Lt.weightDirectory})`).addSlider(c=>this.weightSlider(c,"weightDirectory")),new $.Setting(e).setName(`Headings level 1 (default: ${Lt.weightH1})`).addSlider(c=>this.weightSlider(c,"weightH1")),new $.Setting(e).setName(`Headings level 2 (default: ${Lt.weightH2})`).addSlider(c=>this.weightSlider(c,"weightH2")),new $.Setting(e).setName(`Headings level 3 (default: ${Lt.weightH3})`).addSlider(c=>this.weightSlider(c,"weightH3")),new $.Setting(e).setName(`Tags without the # (default: ${Lt.weightUnmarkedTags})`).addSlider(c=>this.weightSlider(c,"weightUnmarkedTags")),new $.Setting(e).setName("Debugging").setHeading(),new $.Setting(e).setName("Enable verbose logging").setDesc("Adds a LOT of logs for debugging purposes. Don't forget to disable it.").addToggle(c=>c.setValue(T.verboseLogging).onChange(async h=>{T.verboseLogging=h,await le(this.plugin)})),!$.Platform.isMobile){let c=new DocumentFragment;c.createSpan({},h=>{h.innerHTML='Omnisearch can be used through a simple HTTP server (<a href="https://publish.obsidian.md/omnisearch/Public+API+%26+URL+Scheme#HTTP+Server">more information</a>).'}),new $.Setting(e).setName("API Access Through HTTP").setHeading().setDesc(c),new $.Setting(e).setName("Enable the HTTP server").addToggle(h=>h.setValue(T.httpApiEnabled).onChange(async w=>{T.httpApiEnabled=w,w?this.plugin.apiHttpServer.listen(T.httpApiPort):this.plugin.apiHttpServer.close(),await le(this.plugin)})),new $.Setting(e).setName("HTTP Port").addText(h=>{h.setValue(T.httpApiPort).setPlaceholder("51361").onChange(async w=>{parseInt(w)>65535&&(w=T.httpApiPort,h.setValue(T.httpApiPort)),T.httpApiPort=w,T.httpApiEnabled&&(this.plugin.apiHttpServer.close(),this.plugin.apiHttpServer.listen(T.httpApiPort)),await le(this.plugin)})})}new $.Setting(e).setName("Danger Zone").setHeading();let f=new DocumentFragment;f.createSpan({},c=>{c.innerHTML=`Normalize diacritics in search terms. Words like "br\xFBl\xE9e" or "\u017Elu\u0165ou\u010Dk\xFD" will be indexed as "brulee" and "zlutoucky".<br/>
        \u26A0\uFE0F <span style="color: var(--text-accent)">You probably should <strong>NOT</strong> disable this.</span><br>
        \u26A0\uFE0F <span style="color: var(--text-accent)">Changing this setting will clear the cache.</span><br>
        ${Wi}
        `}),new $.Setting(e).setName("Ignore diacritics").setDesc(f).addToggle(c=>c.setValue(T.ignoreDiacritics).onChange(async h=>{await Ee.clearCache(),T.ignoreDiacritics=h,await le(this.plugin)}));let p=new DocumentFragment;if(p.createSpan({},c=>{c.innerHTML=`Disable Omnisearch on this device only.<br>
        ${Wi}`}),new $.Setting(e).setName("Disable on this device").setDesc(p).addToggle(c=>c.setValue(oa()).onChange(async h=>{h?app.saveLocalStorage(Hn,"1"):app.saveLocalStorage(Hn),new $.Notice("Omnisearch - Disabled. Please restart Obsidian.")})),Nt()){let c=new DocumentFragment;c.createSpan({},h=>{h.innerHTML=`Erase all Omnisearch cache data.
          Use this if Omnisearch results are inconsistent, missing, or appear outdated.<br>
          ${Wi}`}),new $.Setting(e).setName("Clear cache data").setDesc(c).addButton(h=>{h.setButtonText("Clear cache"),h.onClick(async()=>{await Ee.clearCache()})})}}weightSlider(e,r){e.setLimits(1,5,.1).setValue(T[r]).setDynamicTooltip().onChange(async n=>{T[r]=n,await le(this.plugin)})}},Lt={useCache:!0,hideExcluded:!1,ignoreDiacritics:!0,indexedFileTypes:[],PDFIndexing:!1,imagesIndexing:!1,unsupportedFilesIndexing:"no",splitCamelCase:!1,openInNewPane:!1,vimLikeNavigationShortcut:app.vault.getConfig("vimMode"),ribbonIcon:!0,showExcerpt:!0,renderLineReturnInExcerpts:!0,showCreateButton:!1,highlight:!0,showPreviousQueryResults:!0,simpleSearch:!1,fuzziness:"1",weightBasename:3,weightDirectory:2,weightH1:1.5,weightH2:1.3,weightH3:1.1,weightUnmarkedTags:1.1,httpApiEnabled:!1,httpApiPort:"51361",welcomeMessage:"",verboseLogging:!1},T=Object.assign({},Lt)});function sa(t){Su=t}function aa(){return Su}function Gi(){return app.plugins.plugins["cm-chs-patch"]}function ft(){return app.plugins?.plugins?.["text-extractor"]?.api}function Nt(){return!wu.Platform.isIosApp&&T.useCache}var wu,ju,Au,Vn,Cu,Hn,Q,Ui,et,re,Bt,Su,Eu,la,$n,ot=j(()=>{Al();ds();Ze();wu=ge(require("obsidian")),ju=/[\u4e00-\u9fa5]/,Au=100,Vn=300,Cu=`suggestion-highlight omnisearch-highlight ${T.highlight?"omnisearch-default-highlight":""}`,Hn="omnisearch-disabled",Q=new fs,Ui={ToggleExcerpts:"toggle-excerpts"},et=(o=>(o[o.Done=0]="Done",o[o.LoadingCache=1]="LoadingCache",o[o.ReadingFiles=2]="ReadingFiles",o[o.IndexingFiles=3]="IndexingFiles",o[o.WritingCache=4]="WritingCache",o))(et||{}),re=(f=>(f.Enter="enter",f.OpenInBackground="open-in-background",f.CreateNote="create-note",f.OpenInNewPane="open-in-new-pane",f.InsertLink="insert-link",f.Tab="tab",f.ArrowUp="arrow-up",f.ArrowDown="arrow-down",f.PrevSearchHistory="prev-search-history",f.NextSearchHistory="next-search-history",f))(re||{}),Bt=vi(0),Su=!1;Eu=/[|\t\n\r= -#%-*,.`\/<>:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/.toString().slice(1,-1),la=new RegExp(`${Eu}`,"u"),$n=new RegExp(`${Eu}+`,"u")});var Fu=pi((Wn,ua)=>{(function(t,e){if(typeof Wn=="object"&&typeof ua=="object")ua.exports=e();else if(typeof define=="function"&&define.amd)define([],e);else{var r=e();for(var n in r)(typeof Wn=="object"?Wn:t)[n]=r[n]}})(typeof self!="undefined"?self:Wn,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(n,i,o){r.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:o})},r.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,i){if(1&i&&(n=r(n)),8&i||4&i&&typeof n=="object"&&n&&n.__esModule)return n;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&i&&typeof n!="string")for(var s in n)r.d(o,s,function(a){return n[a]}.bind(null,s));return o},r.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(i,"a",i),i},r.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e),r.d(e,"md5",function(){return x});var n="0123456789abcdef".split(""),i=function(v){for(var d="",b=0;b<4;b++)d+=n[v>>8*b+4&15]+n[v>>8*b&15];return d},o=function(v){for(var d=v.length,b=0;b<d;b++)v[b]=i(v[b]);return v.join("")},s=function(v,d){return v+d&4294967295},a=function(v,d,b,m,g,y,_){return function(A,C,F){return s(A<<C|A>>>32-C,F)}(d=function(A,C,F,D){return C=s(s(C,A),s(F,D))}(v,d,m,y),g,b)},u=function(v,d,b,m,g,y,_,A){return a(b&m|~b&g,d,b,y,_,A,v)},l=function(v,d,b,m,g,y,_,A){return a(b&g|m&~g,d,b,y,_,A,v)},f=function(v,d,b,m,g,y,_,A){return a(b^m^g,d,b,y,_,A,v)},p=function(v,d,b,m,g,y,_,A){return a(m^(b|~g),d,b,y,_,A,v)},c=function(v,d,b){b===void 0&&(b=s);var m=v[0],g=v[1],y=v[2],_=v[3],A=u.bind(null,b);m=A(m,g,y,_,d[0],7,-680876936),_=A(_,m,g,y,d[1],12,-389564586),y=A(y,_,m,g,d[2],17,606105819),g=A(g,y,_,m,d[3],22,-1044525330),m=A(m,g,y,_,d[4],7,-176418897),_=A(_,m,g,y,d[5],12,1200080426),y=A(y,_,m,g,d[6],17,-1473231341),g=A(g,y,_,m,d[7],22,-45705983),m=A(m,g,y,_,d[8],7,1770035416),_=A(_,m,g,y,d[9],12,-1958414417),y=A(y,_,m,g,d[10],17,-42063),g=A(g,y,_,m,d[11],22,-1990404162),m=A(m,g,y,_,d[12],7,1804603682),_=A(_,m,g,y,d[13],12,-40341101),y=A(y,_,m,g,d[14],17,-1502002290),g=A(g,y,_,m,d[15],22,1236535329);var C=l.bind(null,b);m=C(m,g,y,_,d[1],5,-165796510),_=C(_,m,g,y,d[6],9,-1069501632),y=C(y,_,m,g,d[11],14,643717713),g=C(g,y,_,m,d[0],20,-373897302),m=C(m,g,y,_,d[5],5,-701558691),_=C(_,m,g,y,d[10],9,38016083),y=C(y,_,m,g,d[15],14,-660478335),g=C(g,y,_,m,d[4],20,-405537848),m=C(m,g,y,_,d[9],5,568446438),_=C(_,m,g,y,d[14],9,-1019803690),y=C(y,_,m,g,d[3],14,-187363961),g=C(g,y,_,m,d[8],20,1163531501),m=C(m,g,y,_,d[13],5,-1444681467),_=C(_,m,g,y,d[2],9,-51403784),y=C(y,_,m,g,d[7],14,1735328473),g=C(g,y,_,m,d[12],20,-1926607734);var F=f.bind(null,b);m=F(m,g,y,_,d[5],4,-378558),_=F(_,m,g,y,d[8],11,-2022574463),y=F(y,_,m,g,d[11],16,1839030562),g=F(g,y,_,m,d[14],23,-35309556),m=F(m,g,y,_,d[1],4,-1530992060),_=F(_,m,g,y,d[4],11,1272893353),y=F(y,_,m,g,d[7],16,-155497632),g=F(g,y,_,m,d[10],23,-1094730640),m=F(m,g,y,_,d[13],4,681279174),_=F(_,m,g,y,d[0],11,-358537222),y=F(y,_,m,g,d[3],16,-722521979),g=F(g,y,_,m,d[6],23,76029189),m=F(m,g,y,_,d[9],4,-640364487),_=F(_,m,g,y,d[12],11,-421815835),y=F(y,_,m,g,d[15],16,530742520),g=F(g,y,_,m,d[2],23,-995338651);var D=p.bind(null,b);m=D(m,g,y,_,d[0],6,-198630844),_=D(_,m,g,y,d[7],10,1126891415),y=D(y,_,m,g,d[14],15,-1416354905),g=D(g,y,_,m,d[5],21,-57434055),m=D(m,g,y,_,d[12],6,1700485571),_=D(_,m,g,y,d[3],10,-1894986606),y=D(y,_,m,g,d[10],15,-1051523),g=D(g,y,_,m,d[1],21,-2054922799),m=D(m,g,y,_,d[8],6,1873313359),_=D(_,m,g,y,d[15],10,-30611744),y=D(y,_,m,g,d[6],15,-1560198380),g=D(g,y,_,m,d[13],21,1309151649),m=D(m,g,y,_,d[4],6,-145523070),_=D(_,m,g,y,d[11],10,-1120210379),y=D(y,_,m,g,d[2],15,718787259),g=D(g,y,_,m,d[9],21,-343485551),v[0]=b(m,v[0]),v[1]=b(g,v[1]),v[2]=b(y,v[2]),v[3]=b(_,v[3])},h=function(v){for(var d=[],b=0;b<64;b+=4)d[b>>2]=v.charCodeAt(b)+(v.charCodeAt(b+1)<<8)+(v.charCodeAt(b+2)<<16)+(v.charCodeAt(b+3)<<24);return d},w=function(v,d){var b,m=v.length,g=[1732584193,-271733879,-1732584194,271733878];for(b=64;b<=m;b+=64)c(g,h(v.substring(b-64,b)),d);var y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_=(v=v.substring(b-64)).length;for(b=0;b<_;b++)y[b>>2]|=v.charCodeAt(b)<<(b%4<<3);if(y[b>>2]|=128<<(b%4<<3),b>55)for(c(g,y,d),b=16;b--;)y[b]=0;return y[14]=8*m,c(g,y,d),g};function x(v){var d;return o(w("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(d=function(b,m){var g=(65535&b)+(65535&m);return(b>>16)+(m>>16)+(g>>16)<<16|65535&g}),o(w(v,d))}}])})});function Ou(t){let e=t.split("/");return e.pop(),e.join("/")}function Qi(t,e){return t.headings?.filter(r=>r.level===e).map(r=>r.heading)??[]}function qi(t,e){return(t+e)%e}function ca(t){return t.replace(/(\*|_)+(.+?)(\*|_)+/g,(e,r,n)=>n)}function Iu(t){return t?.frontmatter?(0,pr.parseFrontMatterAliases)(t.frontmatter)??[]:[]}function Pu(t){let e=t?(0,pr.getAllTags)(t)??[]:[];return e=[...new Set(e.reduce((r,n)=>[...r,...n.split("/").filter(i=>i).map(i=>i.startsWith("#")?i:`#${i}`),n],[]))],e}function jt(t){return t==null?"":(t=t.replaceAll("`","[__omnisearch__backtick__]"),t=t.normalize("NFD").replace(/\p{Diacritic}/gu,""),t=t.replaceAll("[__omnisearch__backtick__]","`"),t)}function hr(){return pr.Platform.isMacOS?"\u2318":"ctrl"}function dy(t){let e=!!ft(),r=e&&T.PDFIndexing,n=e&&T.imagesIndexing;return Yi(t)||$r(t)||Ji(t)||r&&mr(t)||n&&Vr(t)}function fa(t){return xu()||Yi(t)||$r(t)||Ji(t)}function Un(t){return fa(t)||dy(t)}function Vr(t){let e=gr(t);return e==="png"||e==="jpg"||e==="jpeg"||e==="webp"}function mr(t){return gr(t)==="pdf"}function Yi(t){return[...T.indexedFileTypes,"md"].some(e=>t.endsWith(`.${e}`))}function $r(t){return t.endsWith(".canvas")}function Ji(t){return t.endsWith(".loom")}function gr(t){let e=t.split(".");return e[e.length-1]??""}function ku(t){return pr.Platform.isMobileApp?(0,Du.md5)(t.toString()):(0,Tu.createHash)("md5").update(t).digest("hex")}function Mu(t,e){let r=[],n=0,i=t.length;for(;n<i;)r.push(t.slice(n,n+=e));return r}function Ru(t){return/[a-z][A-Z]/.test(t)?t.replace(/([a-z](?=[A-Z]))/g,"$1 ").split(" ").filter(r=>r):[]}function Lu(t){return t.includes("-")?t.split("-").filter(e=>e):[]}function de(...t){Bu(console.log,...t)}function Nu(...t){Bu(console.warn,...t)}function Bu(t,...e){if(T.verboseLogging){let r=new Date,n=`${r.getMinutes()}:${r.getSeconds()}:${r.getMilliseconds()}`;t("Omnisearch -",n+" -",...e)}}var pr,Tu,Du,At=j(()=>{pr=ge(require("obsidian"));ot();Ze();Tu=ge(require("crypto")),Du=ge(Fu())});async function py(t){let e=app.vault.getFiles().find(s=>s.path===t);if(!e)throw new Error(`Invalid file path: "${t}"`);let r=null,n=ft();if(Yi(t))r=await app.vault.cachedRead(e);else if($r(t)){let s=JSON.parse(await app.vault.cachedRead(e)),a=[];for(let u of s.nodes)u.type==="text"?a.push(u.text):u.type==="file"&&a.push(u.file);for(let u of s.edges.filter(l=>!!l.label))a.push(u.label);r=a.join(`\r
`)}else if(Ji(t))try{let s=JSON.parse(await app.vault.cachedRead(e)),a=[],u=l=>{for(let f in l)typeof l[f]=="object"?u(l[f]):f==="content"&&a.push(l[f])};u(s),r=a.join(`\r
`)}catch(s){console.error("Omnisearch: Error while parsing Dataloom file",t),console.error(s)}else Vr(t)&&T.imagesIndexing&&n?.canFileBeExtracted(t)?r=await n.extractText(e):mr(t)&&T.PDFIndexing&&n?.canFileBeExtracted(t)?r=await n.extractText(e):fa(t)&&(r=e.path);r==null&&(console.warn(`Omnisearch: ${r} content for file`,e.path),r=""),r=jt(r);let i=app.metadataCache.getFileCache(e);if(i&&i.frontmatter?.["excalidraw-plugin"]){let s=i.sections?.filter(a=>a.type==="comment")??[];for(let{start:a,end:u}of s.map(l=>l.position))r=r.substring(0,a.offset-1)+r.substring(u.offset)}let o=Pu(i);return{basename:jt(e.basename),content:r,path:e.path,mtime:e.stat.mtime,tags:o,unmarkedTags:o.map(s=>s.replace("#","")),aliases:Iu(i).join(""),headings1:i?Qi(i,1).join(" "):"",headings2:i?Qi(i,2).join(" "):"",headings3:i?Qi(i,3).join(" "):""}}var Ku,zu,Fe,Gn=j(()=>{Ku=ge(require("obsidian"));ot();$i();At();Ze();zu=class{constructor(){this.nextQueryIsEmpty=!1;this.documents=new Map}async addToLiveCache(e){try{let r=await py(e);if(!r.path){console.error(`Missing .path field in IndexedDocument "${r.basename}", skipping`);return}this.documents.set(e,r)}catch(r){console.warn(`Omnisearch: Error while adding "${e}" to live cache`,r),this.removeFromLiveCache(e)}}removeFromLiveCache(e){this.documents.delete(e)}async getDocument(e){return this.documents.has(e)?this.documents.get(e):(de("Generating IndexedDocument from",e),await this.addToLiveCache(e),this.documents.get(e))}async addToSearchHistory(e){if(!e){this.nextQueryIsEmpty=!0;return}this.nextQueryIsEmpty=!1;let r=await Ee.searchHistory.toArray();r=r.filter(n=>n.query!==e).reverse(),r.unshift({query:e}),r=r.slice(0,10),await Ee.searchHistory.clear(),await Ee.searchHistory.bulkAdd(r)}async getSearchHistory(){let e=(await Ee.searchHistory.toArray()).reverse().map(r=>r.query);return this.nextQueryIsEmpty&&e.unshift(""),e}getDocumentsChecksum(e){return ku(JSON.stringify(e.sort((r,n)=>r.path<n.path?-1:r.path>n.path?1:0)))}async getMinisearchCache(){try{return(await Ee.minisearch.toArray())[0]}catch(e){return new Ku.Notice("Omnisearch - Cache missing or invalid. Some freezes may occur while Omnisearch indexes your vault."),console.error("Omnisearch - Error while loading Minisearch cache"),console.error(e),null}}async writeMinisearchCache(e,r){let n=Array.from(r).map(([i,o])=>({path:i,mtime:o}));await Ee.minisearch.clear(),await Ee.minisearch.add({date:new Date().toISOString(),paths:n,data:e.toJSON()}),console.log("Omnisearch - Search cache written")}},Fe=new zu});var vy,eo,da=j(()=>{vy=typeof global=="object"&&global&&global.Object===Object&&global,eo=vy});var by,xy,ve,st=j(()=>{da();by=typeof self=="object"&&self&&self.Object===Object&&self,xy=eo||by||Function("return this")(),ve=xy});var wy,Te,yr=j(()=>{st();wy=ve.Symbol,Te=wy});function Cy(t){var e=jy.call(t,Qn),r=t[Qn];try{t[Qn]=void 0;var n=!0}catch{}var i=Ay.call(t);return n&&(e?t[Qn]=r:delete t[Qn]),i}var Wu,jy,Ay,Qn,Uu,Gu=j(()=>{yr();Wu=Object.prototype,jy=Wu.hasOwnProperty,Ay=Wu.toString,Qn=Te?Te.toStringTag:void 0;Uu=Cy});function Fy(t){return Ey.call(t)}var Sy,Ey,Qu,qu=j(()=>{Sy=Object.prototype,Ey=Sy.toString;Qu=Fy});function Oy(t){return t==null?t===void 0?Dy:Ty:Yu&&Yu in Object(t)?Uu(t):Qu(t)}var Ty,Dy,Yu,at,Wr=j(()=>{yr();Gu();qu();Ty="[object Null]",Dy="[object Undefined]",Yu=Te?Te.toStringTag:void 0;at=Oy});function Iy(t){return t!=null&&typeof t=="object"}var Ke,Kt=j(()=>{Ke=Iy});function ky(t){return typeof t=="symbol"||Ke(t)&&at(t)==Py}var Py,Ct,qn=j(()=>{Wr();Kt();Py="[object Symbol]";Ct=ky});function My(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var Ur,pa=j(()=>{Ur=My});var Ry,pe,tt=j(()=>{Ry=Array.isArray,pe=Ry});function Zu(t){if(typeof t=="string")return t;if(pe(t))return Ur(t,Zu)+"";if(Ct(t))return Xu?Xu.call(t):"";var e=t+"";return e=="0"&&1/t==-Ly?"-0":e}var Ly,Ju,Xu,ec,tc=j(()=>{yr();pa();tt();qn();Ly=1/0,Ju=Te?Te.prototype:void 0,Xu=Ju?Ju.toString:void 0;ec=Zu});function Ny(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Ue,zt=j(()=>{Ue=Ny});function By(t){return t}var Ht,Yn=j(()=>{Ht=By});function $y(t){if(!Ue(t))return!1;var e=at(t);return e==zy||e==Hy||e==Ky||e==Vy}var Ky,zy,Hy,Vy,to,ha=j(()=>{Wr();zt();Ky="[object AsyncFunction]",zy="[object Function]",Hy="[object GeneratorFunction]",Vy="[object Proxy]";to=$y});var Wy,ro,rc=j(()=>{st();Wy=ve["__core-js_shared__"],ro=Wy});function Uy(t){return!!nc&&nc in t}var nc,ic,oc=j(()=>{rc();nc=function(){var t=/[^.]+$/.exec(ro&&ro.keys&&ro.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();ic=Uy});function qy(t){if(t!=null){try{return Qy.call(t)}catch{}try{return t+""}catch{}}return""}var Gy,Qy,St,ma=j(()=>{Gy=Function.prototype,Qy=Gy.toString;St=qy});function n_(t){if(!Ue(t)||ic(t))return!1;var e=to(t)?r_:Jy;return e.test(St(t))}var Yy,Jy,Xy,Zy,e_,t_,r_,sc,ac=j(()=>{ha();oc();zt();ma();Yy=/[\\^$.*+?()[\]{}|]/g,Jy=/^\[object .+?Constructor\]$/,Xy=Function.prototype,Zy=Object.prototype,e_=Xy.toString,t_=Zy.hasOwnProperty,r_=RegExp("^"+e_.call(t_).replace(Yy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");sc=n_});function i_(t,e){return t==null?void 0:t[e]}var lc,uc=j(()=>{lc=i_});function o_(t,e){var r=lc(t,e);return sc(r)?r:void 0}var Ge,Vt=j(()=>{ac();uc();Ge=o_});var s_,no,cc=j(()=>{Vt();st();s_=Ge(ve,"WeakMap"),no=s_});var fc,a_,dc,pc=j(()=>{zt();fc=Object.create,a_=function(){function t(){}return function(e){if(!Ue(e))return{};if(fc)return fc(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),dc=a_});function l_(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var hc,mc=j(()=>{hc=l_});function u_(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var gc,yc=j(()=>{gc=u_});function p_(t){var e=0,r=0;return function(){var n=d_(),i=f_-(n-r);if(r=n,i>0){if(++e>=c_)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var c_,f_,d_,_c,vc=j(()=>{c_=800,f_=16,d_=Date.now;_c=p_});function h_(t){return function(){return t}}var bc,xc=j(()=>{bc=h_});var m_,Gr,ga=j(()=>{Vt();m_=function(){try{var t=Ge(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Gr=m_});var g_,wc,jc=j(()=>{xc();ga();Yn();g_=Gr?function(t,e){return Gr(t,"toString",{configurable:!0,enumerable:!1,value:bc(e),writable:!0})}:Ht,wc=g_});var y_,Ac,Cc=j(()=>{jc();vc();y_=_c(wc),Ac=y_});function __(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var Sc,Ec=j(()=>{Sc=__});function x_(t,e){var r=typeof t;return e=e??v_,!!e&&(r=="number"||r!="symbol"&&b_.test(t))&&t>-1&&t%1==0&&t<e}var v_,b_,Qr,io=j(()=>{v_=9007199254740991,b_=/^(?:0|[1-9]\d*)$/;Qr=x_});function w_(t,e,r){e=="__proto__"&&Gr?Gr(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var oo,ya=j(()=>{ga();oo=w_});function j_(t,e){return t===e||t!==t&&e!==e}var $t,Jn=j(()=>{$t=j_});function S_(t,e,r){var n=t[e];(!(C_.call(t,e)&&$t(n,r))||r===void 0&&!(e in t))&&oo(t,e,r)}var A_,C_,so,_a=j(()=>{ya();Jn();A_=Object.prototype,C_=A_.hasOwnProperty;so=S_});function E_(t,e,r,n){var i=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var a=e[o],u=n?n(r[a],t[a],a,r,t):void 0;u===void 0&&(u=t[a]),i?oo(r,a,u):so(r,a,u)}return r}var Wt,Xn=j(()=>{_a();ya();Wt=E_});function F_(t,e,r){return e=Fc(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,o=Fc(n.length-e,0),s=Array(o);++i<o;)s[i]=n[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=n[i];return a[e]=r(s),hc(t,this,a)}}var Fc,Tc,Dc=j(()=>{mc();Fc=Math.max;Tc=F_});function T_(t,e){return Ac(Tc(t,e,Ht),t+"")}var Oc,Ic=j(()=>{Yn();Dc();Cc();Oc=T_});function O_(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=D_}var D_,qr,ao=j(()=>{D_=9007199254740991;qr=O_});function I_(t){return t!=null&&qr(t.length)&&!to(t)}var dt,Yr=j(()=>{ha();ao();dt=I_});function P_(t,e,r){if(!Ue(r))return!1;var n=typeof e;return(n=="number"?dt(r)&&Qr(e,r.length):n=="string"&&e in r)?$t(r[e],t):!1}var va,Pc=j(()=>{Jn();Yr();io();zt();va=P_});function M_(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||k_;return t===r}var k_,Jr,lo=j(()=>{k_=Object.prototype;Jr=M_});function R_(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var kc,Mc=j(()=>{kc=R_});function N_(t){return Ke(t)&&at(t)==L_}var L_,ba,Rc=j(()=>{Wr();Kt();L_="[object Arguments]";ba=N_});var Lc,B_,K_,z_,Xr,uo=j(()=>{Rc();Kt();Lc=Object.prototype,B_=Lc.hasOwnProperty,K_=Lc.propertyIsEnumerable,z_=ba(function(){return arguments}())?ba:function(t){return Ke(t)&&B_.call(t,"callee")&&!K_.call(t,"callee")},Xr=z_});function H_(){return!1}var Nc,Bc=j(()=>{Nc=H_});var Kc,zc,V_,Hc,$_,W_,_r,co=j(()=>{st();Bc();Kc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,zc=Kc&&typeof module=="object"&&module&&!module.nodeType&&module,V_=zc&&zc.exports===Kc,Hc=V_?ve.Buffer:void 0,$_=Hc?Hc.isBuffer:void 0,W_=$_||Nc,_r=W_});function gv(t){return Ke(t)&&qr(t.length)&&!!ue[at(t)]}var U_,G_,Q_,q_,Y_,J_,X_,Z_,ev,tv,rv,nv,iv,ov,sv,av,lv,uv,cv,fv,dv,pv,hv,mv,ue,Vc,$c=j(()=>{Wr();ao();Kt();U_="[object Arguments]",G_="[object Array]",Q_="[object Boolean]",q_="[object Date]",Y_="[object Error]",J_="[object Function]",X_="[object Map]",Z_="[object Number]",ev="[object Object]",tv="[object RegExp]",rv="[object Set]",nv="[object String]",iv="[object WeakMap]",ov="[object ArrayBuffer]",sv="[object DataView]",av="[object Float32Array]",lv="[object Float64Array]",uv="[object Int8Array]",cv="[object Int16Array]",fv="[object Int32Array]",dv="[object Uint8Array]",pv="[object Uint8ClampedArray]",hv="[object Uint16Array]",mv="[object Uint32Array]",ue={};ue[av]=ue[lv]=ue[uv]=ue[cv]=ue[fv]=ue[dv]=ue[pv]=ue[hv]=ue[mv]=!0;ue[U_]=ue[G_]=ue[ov]=ue[Q_]=ue[sv]=ue[q_]=ue[Y_]=ue[J_]=ue[X_]=ue[Z_]=ue[ev]=ue[tv]=ue[rv]=ue[nv]=ue[iv]=!1;Vc=gv});function yv(t){return function(e){return t(e)}}var Ut,Zn=j(()=>{Ut=yv});var Wc,ei,_v,xa,vv,Et,fo=j(()=>{da();Wc=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ei=Wc&&typeof module=="object"&&module&&!module.nodeType&&module,_v=ei&&ei.exports===Wc,xa=_v&&eo.process,vv=function(){try{var t=ei&&ei.require&&ei.require("util").types;return t||xa&&xa.binding&&xa.binding("util")}catch{}}(),Et=vv});var Uc,bv,po,wa=j(()=>{$c();Zn();fo();Uc=Et&&Et.isTypedArray,bv=Uc?Ut(Uc):Vc,po=bv});function jv(t,e){var r=pe(t),n=!r&&Xr(t),i=!r&&!n&&_r(t),o=!r&&!n&&!i&&po(t),s=r||n||i||o,a=s?kc(t.length,String):[],u=a.length;for(var l in t)(e||wv.call(t,l))&&!(s&&(l=="length"||i&&(l=="offset"||l=="parent")||o&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Qr(l,u)))&&a.push(l);return a}var xv,wv,ho,ja=j(()=>{Mc();uo();tt();co();io();wa();xv=Object.prototype,wv=xv.hasOwnProperty;ho=jv});function Av(t,e){return function(r){return t(e(r))}}var mo,Aa=j(()=>{mo=Av});var Cv,Gc,Qc=j(()=>{Aa();Cv=mo(Object.keys,Object),Gc=Cv});function Fv(t){if(!Jr(t))return Gc(t);var e=[];for(var r in Object(t))Ev.call(t,r)&&r!="constructor"&&e.push(r);return e}var Sv,Ev,qc,Yc=j(()=>{lo();Qc();Sv=Object.prototype,Ev=Sv.hasOwnProperty;qc=Fv});function Tv(t){return dt(t)?ho(t):qc(t)}var pt,Zr=j(()=>{ja();Yc();Yr();pt=Tv});function Dv(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Jc,Xc=j(()=>{Jc=Dv});function Pv(t){if(!Ue(t))return Jc(t);var e=Jr(t),r=[];for(var n in t)n=="constructor"&&(e||!Iv.call(t,n))||r.push(n);return r}var Ov,Iv,Zc,ef=j(()=>{zt();lo();Xc();Ov=Object.prototype,Iv=Ov.hasOwnProperty;Zc=Pv});function kv(t){return dt(t)?ho(t,!0):Zc(t)}var en,go=j(()=>{ja();ef();Yr();en=kv});function Lv(t,e){if(pe(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Ct(t)?!0:Rv.test(t)||!Mv.test(t)||e!=null&&t in Object(e)}var Mv,Rv,tn,yo=j(()=>{tt();qn();Mv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Rv=/^\w*$/;tn=Lv});var Nv,Ft,ti=j(()=>{Vt();Nv=Ge(Object,"create"),Ft=Nv});function Bv(){this.__data__=Ft?Ft(null):{},this.size=0}var tf,rf=j(()=>{ti();tf=Bv});function Kv(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var nf,of=j(()=>{nf=Kv});function $v(t){var e=this.__data__;if(Ft){var r=e[t];return r===zv?void 0:r}return Vv.call(e,t)?e[t]:void 0}var zv,Hv,Vv,sf,af=j(()=>{ti();zv="__lodash_hash_undefined__",Hv=Object.prototype,Vv=Hv.hasOwnProperty;sf=$v});function Gv(t){var e=this.__data__;return Ft?e[t]!==void 0:Uv.call(e,t)}var Wv,Uv,lf,uf=j(()=>{ti();Wv=Object.prototype,Uv=Wv.hasOwnProperty;lf=Gv});function qv(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Ft&&e===void 0?Qv:e,this}var Qv,cf,ff=j(()=>{ti();Qv="__lodash_hash_undefined__";cf=qv});function rn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}var Ca,df=j(()=>{rf();of();af();uf();ff();rn.prototype.clear=tf;rn.prototype.delete=nf;rn.prototype.get=sf;rn.prototype.has=lf;rn.prototype.set=cf;Ca=rn});function Yv(){this.__data__=[],this.size=0}var pf,hf=j(()=>{pf=Yv});function Jv(t,e){for(var r=t.length;r--;)if($t(t[r][0],e))return r;return-1}var Gt,ri=j(()=>{Jn();Gt=Jv});function eb(t){var e=this.__data__,r=Gt(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Zv.call(e,r,1),--this.size,!0}var Xv,Zv,mf,gf=j(()=>{ri();Xv=Array.prototype,Zv=Xv.splice;mf=eb});function tb(t){var e=this.__data__,r=Gt(e,t);return r<0?void 0:e[r][1]}var yf,_f=j(()=>{ri();yf=tb});function rb(t){return Gt(this.__data__,t)>-1}var vf,bf=j(()=>{ri();vf=rb});function nb(t,e){var r=this.__data__,n=Gt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var xf,wf=j(()=>{ri();xf=nb});function nn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}var Qt,ni=j(()=>{hf();gf();_f();bf();wf();nn.prototype.clear=pf;nn.prototype.delete=mf;nn.prototype.get=yf;nn.prototype.has=vf;nn.prototype.set=xf;Qt=nn});var ib,qt,_o=j(()=>{Vt();st();ib=Ge(ve,"Map"),qt=ib});function ob(){this.size=0,this.__data__={hash:new Ca,map:new(qt||Qt),string:new Ca}}var jf,Af=j(()=>{df();ni();_o();jf=ob});function sb(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Cf,Sf=j(()=>{Cf=sb});function ab(t,e){var r=t.__data__;return Cf(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Yt,ii=j(()=>{Sf();Yt=ab});function lb(t){var e=Yt(this,t).delete(t);return this.size-=e?1:0,e}var Ef,Ff=j(()=>{ii();Ef=lb});function ub(t){return Yt(this,t).get(t)}var Tf,Df=j(()=>{ii();Tf=ub});function cb(t){return Yt(this,t).has(t)}var Of,If=j(()=>{ii();Of=cb});function fb(t,e){var r=Yt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var Pf,kf=j(()=>{ii();Pf=fb});function on(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}var vr,vo=j(()=>{Af();Ff();Df();If();kf();on.prototype.clear=jf;on.prototype.delete=Ef;on.prototype.get=Tf;on.prototype.has=Of;on.prototype.set=Pf;vr=on});function Sa(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(db);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(Sa.Cache||vr),r}var db,Mf,Rf=j(()=>{vo();db="Expected a function";Sa.Cache=vr;Mf=Sa});function hb(t){var e=Mf(t,function(n){return r.size===pb&&r.clear(),n}),r=e.cache;return e}var pb,Lf,Nf=j(()=>{Rf();pb=500;Lf=hb});var mb,gb,yb,Bf,Kf=j(()=>{Nf();mb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gb=/\\(\\)?/g,yb=Lf(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(mb,function(r,n,i,o){e.push(i?o.replace(gb,"$1"):n||r)}),e}),Bf=yb});function _b(t){return t==null?"":ec(t)}var bo,Ea=j(()=>{tc();bo=_b});function vb(t,e){return pe(t)?t:tn(t,e)?[t]:Bf(bo(t))}var xo,Fa=j(()=>{tt();yo();Kf();Ea();xo=vb});function xb(t){if(typeof t=="string"||Ct(t))return t;var e=t+"";return e=="0"&&1/t==-bb?"-0":e}var bb,Jt,oi=j(()=>{qn();bb=1/0;Jt=xb});function wb(t,e){e=xo(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Jt(e[r++])];return r&&r==n?t:void 0}var sn,wo=j(()=>{Fa();oi();sn=wb});function jb(t,e,r){var n=t==null?void 0:sn(t,e);return n===void 0?r:n}var zf,Hf=j(()=>{wo();zf=jb});function Ab(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var an,jo=j(()=>{an=Ab});function Cb(t){return pe(t)||Xr(t)||!!(Vf&&t&&t[Vf])}var Vf,$f,Wf=j(()=>{yr();uo();tt();Vf=Te?Te.isConcatSpreadable:void 0;$f=Cb});function Uf(t,e,r,n,i){var o=-1,s=t.length;for(r||(r=$f),i||(i=[]);++o<s;){var a=t[o];e>0&&r(a)?e>1?Uf(a,e-1,r,n,i):an(i,a):n||(i[i.length]=a)}return i}var Gf,Qf=j(()=>{jo();Wf();Gf=Uf});var Sb,Ao,Ta=j(()=>{Aa();Sb=mo(Object.getPrototypeOf,Object),Ao=Sb});function Eb(){this.__data__=new Qt,this.size=0}var qf,Yf=j(()=>{ni();qf=Eb});function Fb(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var Jf,Xf=j(()=>{Jf=Fb});function Tb(t){return this.__data__.get(t)}var Zf,ed=j(()=>{Zf=Tb});function Db(t){return this.__data__.has(t)}var td,rd=j(()=>{td=Db});function Ib(t,e){var r=this.__data__;if(r instanceof Qt){var n=r.__data__;if(!qt||n.length<Ob-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new vr(n)}return r.set(t,e),this.size=r.size,this}var Ob,nd,id=j(()=>{ni();_o();vo();Ob=200;nd=Ib});function ln(t){var e=this.__data__=new Qt(t);this.size=e.size}var Xt,Co=j(()=>{ni();Yf();Xf();ed();rd();id();ln.prototype.clear=qf;ln.prototype.delete=Jf;ln.prototype.get=Zf;ln.prototype.has=td;ln.prototype.set=nd;Xt=ln});function Pb(t,e){return t&&Wt(e,pt(e),t)}var od,sd=j(()=>{Xn();Zr();od=Pb});function kb(t,e){return t&&Wt(e,en(e),t)}var ad,ld=j(()=>{Xn();go();ad=kb});function Rb(t,e){if(e)return t.slice();var r=t.length,n=dd?dd(r):new t.constructor(r);return t.copy(n),n}var ud,cd,Mb,fd,dd,pd,hd=j(()=>{st();ud=typeof exports=="object"&&exports&&!exports.nodeType&&exports,cd=ud&&typeof module=="object"&&module&&!module.nodeType&&module,Mb=cd&&cd.exports===ud,fd=Mb?ve.Buffer:void 0,dd=fd?fd.allocUnsafe:void 0;pd=Rb});function Lb(t,e){for(var r=-1,n=t==null?0:t.length,i=0,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[i++]=s)}return o}var md,gd=j(()=>{md=Lb});function Nb(){return[]}var So,Da=j(()=>{So=Nb});var Bb,Kb,yd,zb,un,Eo=j(()=>{gd();Da();Bb=Object.prototype,Kb=Bb.propertyIsEnumerable,yd=Object.getOwnPropertySymbols,zb=yd?function(t){return t==null?[]:(t=Object(t),md(yd(t),function(e){return Kb.call(t,e)}))}:So,un=zb});function Hb(t,e){return Wt(t,un(t),e)}var _d,vd=j(()=>{Xn();Eo();_d=Hb});var Vb,$b,Fo,Oa=j(()=>{jo();Ta();Eo();Da();Vb=Object.getOwnPropertySymbols,$b=Vb?function(t){for(var e=[];t;)an(e,un(t)),t=Ao(t);return e}:So,Fo=$b});function Wb(t,e){return Wt(t,Fo(t),e)}var bd,xd=j(()=>{Xn();Oa();bd=Wb});function Ub(t,e,r){var n=e(t);return pe(t)?n:an(n,r(t))}var To,Ia=j(()=>{jo();tt();To=Ub});function Gb(t){return To(t,pt,un)}var si,Pa=j(()=>{Ia();Eo();Zr();si=Gb});function Qb(t){return To(t,en,Fo)}var wd,jd=j(()=>{Ia();Oa();go();wd=Qb});var qb,Do,Ad=j(()=>{Vt();st();qb=Ge(ve,"DataView"),Do=qb});var Yb,Oo,Cd=j(()=>{Vt();st();Yb=Ge(ve,"Promise"),Oo=Yb});var Jb,Io,Sd=j(()=>{Vt();st();Jb=Ge(ve,"Set"),Io=Jb});var Ed,Xb,Fd,Td,Dd,Od,Zb,ex,tx,rx,nx,br,Tt,ai=j(()=>{Ad();_o();Cd();Sd();cc();Wr();ma();Ed="[object Map]",Xb="[object Object]",Fd="[object Promise]",Td="[object Set]",Dd="[object WeakMap]",Od="[object DataView]",Zb=St(Do),ex=St(qt),tx=St(Oo),rx=St(Io),nx=St(no),br=at;(Do&&br(new Do(new ArrayBuffer(1)))!=Od||qt&&br(new qt)!=Ed||Oo&&br(Oo.resolve())!=Fd||Io&&br(new Io)!=Td||no&&br(new no)!=Dd)&&(br=function(t){var e=at(t),r=e==Xb?t.constructor:void 0,n=r?St(r):"";if(n)switch(n){case Zb:return Od;case ex:return Ed;case tx:return Fd;case rx:return Td;case nx:return Dd}return e});Tt=br});function sx(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&ox.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var ix,ox,Id,Pd=j(()=>{ix=Object.prototype,ox=ix.hasOwnProperty;Id=sx});var ax,cn,ka=j(()=>{st();ax=ve.Uint8Array,cn=ax});function lx(t){var e=new t.constructor(t.byteLength);return new cn(e).set(new cn(t)),e}var fn,Po=j(()=>{ka();fn=lx});function ux(t,e){var r=e?fn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var kd,Md=j(()=>{Po();kd=ux});function fx(t){var e=new t.constructor(t.source,cx.exec(t));return e.lastIndex=t.lastIndex,e}var cx,Rd,Ld=j(()=>{cx=/\w*$/;Rd=fx});function dx(t){return Bd?Object(Bd.call(t)):{}}var Nd,Bd,Kd,zd=j(()=>{yr();Nd=Te?Te.prototype:void 0,Bd=Nd?Nd.valueOf:void 0;Kd=dx});function px(t,e){var r=e?fn(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Hd,Vd=j(()=>{Po();Hd=px});function Px(t,e,r){var n=t.constructor;switch(e){case wx:return fn(t);case hx:case mx:return new n(+t);case jx:return kd(t,r);case Ax:case Cx:case Sx:case Ex:case Fx:case Tx:case Dx:case Ox:case Ix:return Hd(t,r);case gx:return new n;case yx:case bx:return new n(t);case _x:return Rd(t);case vx:return new n;case xx:return Kd(t)}}var hx,mx,gx,yx,_x,vx,bx,xx,wx,jx,Ax,Cx,Sx,Ex,Fx,Tx,Dx,Ox,Ix,$d,Wd=j(()=>{Po();Md();Ld();zd();Vd();hx="[object Boolean]",mx="[object Date]",gx="[object Map]",yx="[object Number]",_x="[object RegExp]",vx="[object Set]",bx="[object String]",xx="[object Symbol]",wx="[object ArrayBuffer]",jx="[object DataView]",Ax="[object Float32Array]",Cx="[object Float64Array]",Sx="[object Int8Array]",Ex="[object Int16Array]",Fx="[object Int32Array]",Tx="[object Uint8Array]",Dx="[object Uint8ClampedArray]",Ox="[object Uint16Array]",Ix="[object Uint32Array]";$d=Px});function kx(t){return typeof t.constructor=="function"&&!Jr(t)?dc(Ao(t)):{}}var Ud,Gd=j(()=>{pc();Ta();lo();Ud=kx});function Rx(t){return Ke(t)&&Tt(t)==Mx}var Mx,Qd,qd=j(()=>{ai();Kt();Mx="[object Map]";Qd=Rx});var Yd,Lx,Jd,Xd=j(()=>{qd();Zn();fo();Yd=Et&&Et.isMap,Lx=Yd?Ut(Yd):Qd,Jd=Lx});function Bx(t){return Ke(t)&&Tt(t)==Nx}var Nx,Zd,ep=j(()=>{ai();Kt();Nx="[object Set]";Zd=Bx});var tp,Kx,rp,np=j(()=>{ep();Zn();fo();tp=Et&&Et.isSet,Kx=tp?Ut(tp):Zd,rp=Kx});function ko(t,e,r,n,i,o){var s,a=e&zx,u=e&Hx,l=e&Vx;if(r&&(s=i?r(t,n,i,o):r(t)),s!==void 0)return s;if(!Ue(t))return t;var f=pe(t);if(f){if(s=Id(t),!a)return gc(t,s)}else{var p=Tt(t),c=p==op||p==Qx;if(_r(t))return pd(t,a);if(p==sp||p==ip||c&&!i){if(s=u||c?{}:Ud(t),!a)return u?bd(t,ad(s,t)):_d(t,od(s,t))}else{if(!se[p])return i?t:{};s=$d(t,p,a)}}o||(o=new Xt);var h=o.get(t);if(h)return h;o.set(t,s),rp(t)?t.forEach(function(v){s.add(ko(v,e,r,v,t,o))}):Jd(t)&&t.forEach(function(v,d){s.set(d,ko(v,e,r,d,t,o))});var w=l?u?wd:si:u?en:pt,x=f?void 0:w(t);return Sc(x||t,function(v,d){x&&(d=v,v=t[d]),so(s,d,ko(v,e,r,d,t,o))}),s}var zx,Hx,Vx,ip,$x,Wx,Ux,Gx,op,Qx,qx,Yx,sp,Jx,Xx,Zx,ew,tw,rw,nw,iw,ow,sw,aw,lw,uw,cw,fw,dw,se,ap,lp=j(()=>{Co();Ec();_a();sd();ld();hd();yc();vd();xd();Pa();jd();ai();Pd();Wd();Gd();tt();co();Xd();zt();np();Zr();go();zx=1,Hx=2,Vx=4,ip="[object Arguments]",$x="[object Array]",Wx="[object Boolean]",Ux="[object Date]",Gx="[object Error]",op="[object Function]",Qx="[object GeneratorFunction]",qx="[object Map]",Yx="[object Number]",sp="[object Object]",Jx="[object RegExp]",Xx="[object Set]",Zx="[object String]",ew="[object Symbol]",tw="[object WeakMap]",rw="[object ArrayBuffer]",nw="[object DataView]",iw="[object Float32Array]",ow="[object Float64Array]",sw="[object Int8Array]",aw="[object Int16Array]",lw="[object Int32Array]",uw="[object Uint8Array]",cw="[object Uint8ClampedArray]",fw="[object Uint16Array]",dw="[object Uint32Array]",se={};se[ip]=se[$x]=se[rw]=se[nw]=se[Wx]=se[Ux]=se[iw]=se[ow]=se[sw]=se[aw]=se[lw]=se[qx]=se[Yx]=se[sp]=se[Jx]=se[Xx]=se[Zx]=se[ew]=se[uw]=se[cw]=se[fw]=se[dw]=!0;se[Gx]=se[op]=se[tw]=!1;ap=ko});function mw(t){return ap(t,pw|hw)}var pw,hw,li,up=j(()=>{lp();pw=1,hw=4;li=mw});function yw(t){return this.__data__.set(t,gw),this}var gw,cp,fp=j(()=>{gw="__lodash_hash_undefined__";cp=yw});function _w(t){return this.__data__.has(t)}var dp,pp=j(()=>{dp=_w});function Mo(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new vr;++e<r;)this.add(t[e])}var hp,mp=j(()=>{vo();fp();pp();Mo.prototype.add=Mo.prototype.push=cp;Mo.prototype.has=dp;hp=Mo});function vw(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var gp,yp=j(()=>{gp=vw});function bw(t,e){return t.has(e)}var _p,vp=j(()=>{_p=bw});function jw(t,e,r,n,i,o){var s=r&xw,a=t.length,u=e.length;if(a!=u&&!(s&&u>a))return!1;var l=o.get(t),f=o.get(e);if(l&&f)return l==e&&f==t;var p=-1,c=!0,h=r&ww?new hp:void 0;for(o.set(t,e),o.set(e,t);++p<a;){var w=t[p],x=e[p];if(n)var v=s?n(x,w,p,e,t,o):n(w,x,p,t,e,o);if(v!==void 0){if(v)continue;c=!1;break}if(h){if(!gp(e,function(d,b){if(!_p(h,b)&&(w===d||i(w,d,r,n,o)))return h.push(b)})){c=!1;break}}else if(!(w===x||i(w,x,r,n,o))){c=!1;break}}return o.delete(t),o.delete(e),c}var xw,ww,Ro,Ma=j(()=>{mp();yp();vp();xw=1,ww=2;Ro=jw});function Aw(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}var bp,xp=j(()=>{bp=Aw});function Cw(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var wp,jp=j(()=>{wp=Cw});function Bw(t,e,r,n,i,o,s){switch(r){case Nw:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Lw:return!(t.byteLength!=e.byteLength||!o(new cn(t),new cn(e)));case Fw:case Tw:case Iw:return $t(+t,+e);case Dw:return t.name==e.name&&t.message==e.message;case Pw:case Mw:return t==e+"";case Ow:var a=bp;case kw:var u=n&Sw;if(a||(a=wp),t.size!=e.size&&!u)return!1;var l=s.get(t);if(l)return l==e;n|=Ew,s.set(t,e);var f=Ro(a(t),a(e),n,i,o,s);return s.delete(t),f;case Rw:if(Ra)return Ra.call(t)==Ra.call(e)}return!1}var Sw,Ew,Fw,Tw,Dw,Ow,Iw,Pw,kw,Mw,Rw,Lw,Nw,Ap,Ra,Cp,Sp=j(()=>{yr();ka();Jn();Ma();xp();jp();Sw=1,Ew=2,Fw="[object Boolean]",Tw="[object Date]",Dw="[object Error]",Ow="[object Map]",Iw="[object Number]",Pw="[object RegExp]",kw="[object Set]",Mw="[object String]",Rw="[object Symbol]",Lw="[object ArrayBuffer]",Nw="[object DataView]",Ap=Te?Te.prototype:void 0,Ra=Ap?Ap.valueOf:void 0;Cp=Bw});function Vw(t,e,r,n,i,o){var s=r&Kw,a=si(t),u=a.length,l=si(e),f=l.length;if(u!=f&&!s)return!1;for(var p=u;p--;){var c=a[p];if(!(s?c in e:Hw.call(e,c)))return!1}var h=o.get(t),w=o.get(e);if(h&&w)return h==e&&w==t;var x=!0;o.set(t,e),o.set(e,t);for(var v=s;++p<u;){c=a[p];var d=t[c],b=e[c];if(n)var m=s?n(b,d,c,e,t,o):n(d,b,c,t,e,o);if(!(m===void 0?d===b||i(d,b,r,n,o):m)){x=!1;break}v||(v=c=="constructor")}if(x&&!v){var g=t.constructor,y=e.constructor;g!=y&&"constructor"in t&&"constructor"in e&&!(typeof g=="function"&&g instanceof g&&typeof y=="function"&&y instanceof y)&&(x=!1)}return o.delete(t),o.delete(e),x}var Kw,zw,Hw,Ep,Fp=j(()=>{Pa();Kw=1,zw=Object.prototype,Hw=zw.hasOwnProperty;Ep=Vw});function Uw(t,e,r,n,i,o){var s=pe(t),a=pe(e),u=s?Dp:Tt(t),l=a?Dp:Tt(e);u=u==Tp?Lo:u,l=l==Tp?Lo:l;var f=u==Lo,p=l==Lo,c=u==l;if(c&&_r(t)){if(!_r(e))return!1;s=!0,f=!1}if(c&&!f)return o||(o=new Xt),s||po(t)?Ro(t,e,r,n,i,o):Cp(t,e,u,r,n,i,o);if(!(r&$w)){var h=f&&Op.call(t,"__wrapped__"),w=p&&Op.call(e,"__wrapped__");if(h||w){var x=h?t.value():t,v=w?e.value():e;return o||(o=new Xt),i(x,v,r,n,o)}}return c?(o||(o=new Xt),Ep(t,e,r,n,i,o)):!1}var $w,Tp,Dp,Lo,Ww,Op,Ip,Pp=j(()=>{Co();Ma();Sp();Fp();ai();tt();co();wa();$w=1,Tp="[object Arguments]",Dp="[object Array]",Lo="[object Object]",Ww=Object.prototype,Op=Ww.hasOwnProperty;Ip=Uw});function kp(t,e,r,n,i){return t===e?!0:t==null||e==null||!Ke(t)&&!Ke(e)?t!==t&&e!==e:Ip(t,e,r,n,kp,i)}var No,La=j(()=>{Pp();Kt();No=kp});function qw(t,e,r,n){var i=r.length,o=i,s=!n;if(t==null)return!o;for(t=Object(t);i--;){var a=r[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){a=r[i];var u=a[0],l=t[u],f=a[1];if(s&&a[2]){if(l===void 0&&!(u in t))return!1}else{var p=new Xt;if(n)var c=n(l,f,u,t,e,p);if(!(c===void 0?No(f,l,Gw|Qw,n,p):c))return!1}}return!0}var Gw,Qw,Mp,Rp=j(()=>{Co();La();Gw=1,Qw=2;Mp=qw});function Yw(t){return t===t&&!Ue(t)}var Bo,Na=j(()=>{zt();Bo=Yw});function Jw(t){for(var e=pt(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,Bo(i)]}return e}var Lp,Np=j(()=>{Na();Zr();Lp=Jw});function Xw(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var Ko,Ba=j(()=>{Ko=Xw});function Zw(t){var e=Lp(t);return e.length==1&&e[0][2]?Ko(e[0][0],e[0][1]):function(r){return r===t||Mp(r,t,e)}}var Bp,Kp=j(()=>{Rp();Np();Ba();Bp=Zw});function e0(t,e){return t!=null&&e in Object(t)}var zp,Hp=j(()=>{zp=e0});function t0(t,e,r){e=xo(e,t);for(var n=-1,i=e.length,o=!1;++n<i;){var s=Jt(e[n]);if(!(o=t!=null&&r(t,s)))break;t=t[s]}return o||++n!=i?o:(i=t==null?0:t.length,!!i&&qr(i)&&Qr(s,i)&&(pe(t)||Xr(t)))}var Vp,$p=j(()=>{Fa();uo();tt();io();ao();oi();Vp=t0});function r0(t,e){return t!=null&&Vp(t,e,zp)}var Wp,Up=j(()=>{Hp();$p();Wp=r0});function o0(t,e){return tn(t)&&Bo(e)?Ko(Jt(t),e):function(r){var n=zf(r,t);return n===void 0&&n===e?Wp(r,t):No(e,n,n0|i0)}}var n0,i0,Gp,Qp=j(()=>{La();Hf();Up();yo();Na();Ba();oi();n0=1,i0=2;Gp=o0});function s0(t){return function(e){return e==null?void 0:e[t]}}var qp,Yp=j(()=>{qp=s0});function a0(t){return function(e){return sn(e,t)}}var Jp,Xp=j(()=>{wo();Jp=a0});function l0(t){return tn(t)?qp(Jt(t)):Jp(t)}var Zp,eh=j(()=>{Yp();Xp();yo();oi();Zp=l0});function u0(t){return typeof t=="function"?t:t==null?Ht:typeof t=="object"?pe(t)?Gp(t[0],t[1]):Bp(t):Zp(t)}var th,rh=j(()=>{Kp();Qp();Yn();tt();eh();th=u0});function c0(t){return function(e,r,n){for(var i=-1,o=Object(e),s=n(e),a=s.length;a--;){var u=s[t?a:++i];if(r(o[u],u,o)===!1)break}return e}}var nh,ih=j(()=>{nh=c0});var f0,oh,sh=j(()=>{ih();f0=nh(),oh=f0});function d0(t,e){return t&&oh(t,e,pt)}var ah,lh=j(()=>{sh();Zr();ah=d0});function p0(t,e){return function(r,n){if(r==null)return r;if(!dt(r))return t(r,n);for(var i=r.length,o=e?i:-1,s=Object(r);(e?o--:++o<i)&&n(s[o],o,s)!==!1;);return r}}var uh,ch=j(()=>{Yr();uh=p0});var h0,fh,dh=j(()=>{lh();ch();h0=uh(ah),fh=h0});function g0(t){return t=bo(t),t&&m0.test(t)?t.replace(ph,"\\$&"):t}var ph,m0,ui,hh=j(()=>{Ea();ph=/[\\^$.*+?()[\]{}|]/g,m0=RegExp(ph.source);ui=g0});function y0(t,e){var r=-1,n=dt(t)?Array(t.length):[];return fh(t,function(i,o,s){n[++r]=e(i,o,s)}),n}var mh,gh=j(()=>{dh();Yr();mh=y0});function _0(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}var yh,_h=j(()=>{yh=_0});function v0(t,e){if(t!==e){var r=t!==void 0,n=t===null,i=t===t,o=Ct(t),s=e!==void 0,a=e===null,u=e===e,l=Ct(e);if(!a&&!l&&!o&&t>e||o&&s&&u&&!a&&!l||n&&s&&u||!r&&u||!i)return 1;if(!n&&!o&&!l&&t<e||l&&r&&i&&!n&&!o||a&&r&&i||!s&&i||!u)return-1}return 0}var vh,bh=j(()=>{qn();vh=v0});function b0(t,e,r){for(var n=-1,i=t.criteria,o=e.criteria,s=i.length,a=r.length;++n<s;){var u=vh(i[n],o[n]);if(u){if(n>=a)return u;var l=r[n];return u*(l=="desc"?-1:1)}}return t.index-e.index}var xh,wh=j(()=>{bh();xh=b0});function x0(t,e,r){e.length?e=Ur(e,function(o){return pe(o)?function(s){return sn(s,o.length===1?o[0]:o)}:o}):e=[Ht];var n=-1;e=Ur(e,Ut(th));var i=mh(t,function(o,s,a){var u=Ur(e,function(l){return l(o)});return{criteria:u,index:++n,value:o}});return yh(i,function(o,s){return xh(o,s,r)})}var jh,Ah=j(()=>{pa();wo();rh();gh();_h();Zn();wh();Yn();tt();jh=x0});var w0,Ka,Ch=j(()=>{Qf();Ah();Ic();Pc();w0=Oc(function(t,e){if(t==null)return[];var r=e.length;return r>1&&va(t,e[0],e[1])?e=[]:r>2&&va(e[0],e[1],e[2])&&(e=[e[0]]),jh(t,Gf(e,1),[])}),Ka=w0});var ci=j(()=>{up();hh();Ch();});function Zt(t,e){try{return t.replace(new RegExp(e.map(r=>`\\b${ui(r.match)}\\b`).join("|"),"giu"),r=>e.find(i=>r.match(new RegExp(`\\b${ui(i.match)}\\b`,"giu")))?`<span class="${Cu}">${r}</span>`:r)}catch(r){return console.error("Omnisearch - Error in highlightText()",r),t}}function j0(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function dn(t){if(!t.length)return/^$/g;t.sort((r,n)=>n.length-r.length);let e="("+(Gi()?"":T.splitCamelCase?`^|${la.source}|-|[A-Z]`:`^|${la.source}|-`)+`)(${t.map(r=>ui(r)).join("|")})`;return new RegExp(`${e}`,"gu")}function zo(t,e,r){t=t.toLowerCase();let n=new Date().getTime(),i=null,o=[],s=0;for(;(i=e.exec(t))!==null;){if(++s>=100||new Date().getTime()-n>50){Nu("Stopped getMatches at",s,"results");break}let a=i[2];a&&i.index>=0&&o.push({match:a,offset:i.index+1})}if(r&&r.query.text.length>1){let a=t.indexOf(r.segmentsToStr());a>-1&&o.find(u=>u.offset===a)&&(o=o.filter(u=>u.offset!==a),o.unshift({offset:a,match:r.segmentsToStr()}))}return o}function pn(t,e){try{let r=e??-1,n=Math.max(0,r-Au),i=Math.min(t.length,r+Vn);if(r>-1?t=(n>0?"\u2026":"")+t.slice(n,i).trim()+(i<t.length-1?"\u2026":""):t=t.slice(0,Vn),T.renderLineReturnInExcerpts){let o=new RegExp(/(?:\r\n|\r|\n)/g);t=t.split(o).filter(a=>a).join(`
`);let s=t.lastIndexOf(`
`,r-n);s>0&&(t=t.slice(s))}return t=j0(t),T.renderLineReturnInExcerpts&&(t=t.trim().replaceAll(`
`,"<br>")),{content:t,offset:r}}catch(r){return new Sh.Notice("Omnisearch - Error while creating excerpt, see developer console"),console.error("Omnisearch - Error while creating excerpt"),console.error(r),{content:"",offset:-1}}}var Sh,hn=j(()=>{ot();Ze();At();Sh=ge(require("obsidian"));ci()});var Nh=pi($o=>{$o.parse=function(t,e){if(e?e.offsets=typeof e.offsets=="undefined"?!0:e.offsets:e={offsets:!0},t||(t=""),t.indexOf(":")===-1&&!e.tokenize)return t;if(!e.keywords&&!e.ranges&&!e.tokenize)return t;var r={text:[]};e.offsets&&(r.offsets=[]);for(var n={},i=[],o=/(\S+:'(?:[^'\\]|\\.)*')|(\S+:"(?:[^"\\]|\\.)*")|(-?"(?:[^"\\]|\\.)*")|(-?'(?:[^'\\]|\\.)*')|\S+|\S+:\S+/g,s;(s=o.exec(t))!==null;){var c=s[0],a=c.indexOf(":");if(a!==-1){var u=c.split(":"),l=c.slice(0,a),f=c.slice(a+1);f=f.replace(/^\"|\"$|^\'|\'$/g,""),f=(f+"").replace(/\\(.?)/g,function(_,A){switch(A){case"\\":return"\\";case"0":return"\0";case"":return"";default:return A}}),i.push({keyword:l,value:f,offsetStart:s.index,offsetEnd:s.index+c.length})}else{var p=!1;c[0]==="-"&&(p=!0,c=c.slice(1)),c=c.replace(/^\"|\"$|^\'|\'$/g,""),c=(c+"").replace(/\\(.?)/g,function(_,A){switch(A){case"\\":return"\\";case"0":return"\0";case"":return"";default:return A}}),p?n.text?(n.text instanceof Array||(n.text=[n.text]),n.text.push(c)):n.text=c:i.push({text:c,offsetStart:s.index,offsetEnd:s.index+c.length})}}i.reverse();for(var c;c=i.pop();)if(c.text)r.text.push(c.text),e.offsets&&r.offsets.push(c);else{var l=c.keyword;e.keywords=e.keywords||[];var h=!1,w=!1;if(!/^-/.test(l))h=e.keywords.indexOf(l)!==-1;else if(l[0]==="-"){var x=l.slice(1);h=e.keywords.indexOf(x)!==-1,h&&(l=x,w=!0)}e.ranges=e.ranges||[];var v=e.ranges.indexOf(l)!==-1;if(h){e.offsets&&r.offsets.push({keyword:l,value:c.value,offsetStart:w?c.offsetStart+1:c.offsetStart,offsetEnd:c.offsetEnd});var d=c.value;if(d.length){var b=d.split(",");w?n[l]?n[l]instanceof Array?b.length>1?n[l]=n[l].concat(b):n[l].push(d):(n[l]=[n[l]],n[l].push(d)):b.length>1?n[l]=b:e.alwaysArray?n[l]=[d]:n[l]=d:r[l]?r[l]instanceof Array?b.length>1?r[l]=r[l].concat(b):r[l].push(d):(r[l]=[r[l]],r[l].push(d)):b.length>1?r[l]=b:e.alwaysArray?r[l]=[d]:r[l]=d}}else if(v){e.offsets&&r.offsets.push(c);var d=c.value,m=d.split("-");r[l]={},m.length===2?(r[l].from=m[0],r[l].to=m[1]):!m.length%2||(r[l].from=d)}else{var g=c.keyword+":"+c.value;r.text.push(g),e.offsets&&r.offsets.push({text:g,offsetStart:c.offsetStart,offsetEnd:c.offsetEnd})}}return r.text.length?e.tokenize||(r.text=r.text.join(" ").trim()):delete r.text,r.exclude=n,r};$o.stringify=function(t,e,r){if(e||(e={offsets:!0}),!t)return"";if(typeof t=="string")return t;if(Array.isArray(t))return t.join(" ");if(!Object.keys(t).length)return"";if(Object.keys(t).length===3&&!!t.text&&!!t.offsets&&!!t.exclude&&typeof t.text=="string")return t.text;r||(r="");var n=function(a){return a.indexOf(" ")>-1?JSON.stringify(a):a},i=function(a){return r+a},o=[];if(t.text){var s=[];typeof t.text=="string"?s.push(t.text):s.push.apply(s,t.text),s.length>0&&o.push(s.map(n).map(i).join(" "))}return e.keywords&&e.keywords.forEach(function(a){if(!!t[a]){var u=[];typeof t[a]=="string"?u.push(t[a]):u.push.apply(u,t[a]),u.length>0&&o.push(i(a+":"+u.map(n).join(",")))}}),e.ranges&&e.ranges.forEach(function(a){if(!!t[a]){var u=t[a].from,l=t[a].to;l&&(u=u+"-"+l),u&&o.push(i(a+":"+u))}}),t.exclude&&Object.keys(t.exclude).length>0&&o.push($o.stringify(t.exclude,e,"-")),o.join(" ")}});var Kh=pi((jI,Bh)=>{Bh.exports=Nh()});var zh,Ha,xr,Wo=j(()=>{Ze();At();zh=ge(Kh()),Ha=["ext","path"],xr=class{#e;constructor(e=""){T.ignoreDiacritics&&(e=jt(e));let r=(0,zh.parse)(e.toLowerCase(),{tokenize:!0,keywords:Ha});r.text=r.text??[],r.exclude=r.exclude??{},r.exclude.text=r.exclude.text??[],Array.isArray(r.exclude.text)||(r.exclude.text=[r.exclude.text]),r.exclude.text=r.exclude.text.filter(n=>n.length);for(let n of Ha){let i=r[n];i&&(r[n]=Array.isArray(i)?i:[i]);let o=r.exclude[n];o&&(r.exclude[n]=Array.isArray(o)?o:[o])}this.query=r,this.#e=e.match(/"([^"]+)"/g)?.map(n=>n.replace(/"/g,""))??[]}isEmpty(){for(let e of Ha)if(this.query[e]?.length||this.query.text.length)return!1;return!0}segmentsToStr(){return this.query.text.join(" ")}getTags(){return this.query.text.filter(e=>e.startsWith("#"))}getTagsWithoutHashtag(){return this.getTags().map(e=>e.replace(/^#/,""))}getExactTerms(){return[...new Set([...this.query.text.filter(e=>e.split(" ").length>1),...this.#e].map(e=>e.toLowerCase()))]}}});function O0(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(f){try{l(n.next(f))}catch(p){s(p)}}function u(f){try{l(n.throw(f))}catch(p){s(p)}}function l(f){f.done?o(f.value):i(f.value).then(a,u)}l((n=n.apply(t,e||[])).next())})}function I0(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,l[0]&&(r=0)),r;)try{if(n=1,i&&(o=l[0]&2?i.return:l[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,l[1])).done)return o;switch(i=0,o&&(l=[l[0]&2,o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(l[0]===6&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=o=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function q(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function be(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(a){s={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}var fe,P0,Hh,Vh,Oe,Va,gn,k0,$h,$a,Uo,Wa,Ua,M0,Wh,Uh,Ga,fi,Qa,Gh,R0,qa,Ya,L0,N0,B0,K0,Ja,Qh,z0,Xa,Za,el,H0,qh,Yh,Jh,Go,V0,Xh=j(()=>{fe=function(){return fe=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},fe.apply(this,arguments)};P0="ENTRIES",Hh="KEYS",Vh="VALUES",Oe="",Va=function(){function t(e,r){var n=e._tree,i=Array.from(n.keys());this.set=e,this._type=r,this._path=i.length>0?[{node:n,keys:i}]:[]}return t.prototype.next=function(){var e=this.dive();return this.backtrack(),e},t.prototype.dive=function(){if(this._path.length===0)return{done:!0,value:void 0};var e=gn(this._path),r=e.node,n=e.keys;if(gn(n)===Oe)return{done:!1,value:this.result()};var i=r.get(gn(n));return this._path.push({node:i,keys:Array.from(i.keys())}),this.dive()},t.prototype.backtrack=function(){if(this._path.length!==0){var e=gn(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}},t.prototype.key=function(){return this.set._prefix+this._path.map(function(e){var r=e.keys;return gn(r)}).filter(function(e){return e!==Oe}).join("")},t.prototype.value=function(){return gn(this._path).node.get(Oe)},t.prototype.result=function(){switch(this._type){case Vh:return this.value();case Hh:return this.key();default:return[this.key(),this.value()]}},t.prototype[Symbol.iterator]=function(){return this},t}(),gn=function(t){return t[t.length-1]},k0=function(t,e,r){var n=new Map;if(e===void 0)return n;for(var i=e.length+1,o=i+r,s=new Uint8Array(o*i).fill(r+1),a=0;a<i;++a)s[a]=a;for(var u=1;u<o;++u)s[u*i]=u;return $h(t,e,r,n,s,1,i,""),n},$h=function(t,e,r,n,i,o,s,a){var u,l,f=o*s;try{e:for(var p=q(t.keys()),c=p.next();!c.done;c=p.next()){var h=c.value;if(h===Oe){var w=i[f-1];w<=r&&n.set(a,[t.get(h),w])}else{for(var x=o,v=0;v<h.length;++v,++x){for(var d=h[v],b=s*x,m=b-s,g=i[b],y=Math.max(0,x-r-1),_=Math.min(s-1,x+r),A=y;A<_;++A){var C=d!==e[A],F=i[m+A]+ +C,D=i[m+A+1]+1,P=i[b+A]+1,N=i[b+A+1]=Math.min(F,D,P);N<g&&(g=N)}if(g>r)continue e}$h(t.get(h),e,r,n,i,x,s,a+h)}}}catch(k){u={error:k}}finally{try{c&&!c.done&&(l=p.return)&&l.call(p)}finally{if(u)throw u.error}}},$a=function(){function t(e,r){e===void 0&&(e=new Map),r===void 0&&(r=""),this._size=void 0,this._tree=e,this._prefix=r}return t.prototype.atPrefix=function(e){var r,n;if(!e.startsWith(this._prefix))throw new Error("Mismatched prefix");var i=be(Uo(this._tree,e.slice(this._prefix.length)),2),o=i[0],s=i[1];if(o===void 0){var a=be(Ga(s),2),u=a[0],l=a[1];try{for(var f=q(u.keys()),p=f.next();!p.done;p=f.next()){var c=p.value;if(c!==Oe&&c.startsWith(l)){var h=new Map;return h.set(c.slice(l.length),u.get(c)),new t(h,e)}}}catch(w){r={error:w}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}}return new t(o,e)},t.prototype.clear=function(){this._size=void 0,this._tree.clear()},t.prototype.delete=function(e){return this._size=void 0,M0(this._tree,e)},t.prototype.entries=function(){return new Va(this,P0)},t.prototype.forEach=function(e){var r,n;try{for(var i=q(this),o=i.next();!o.done;o=i.next()){var s=be(o.value,2),a=s[0],u=s[1];e(a,u,this)}}catch(l){r={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.fuzzyGet=function(e,r){return k0(this._tree,e,r)},t.prototype.get=function(e){var r=Wa(this._tree,e);return r!==void 0?r.get(Oe):void 0},t.prototype.has=function(e){var r=Wa(this._tree,e);return r!==void 0&&r.has(Oe)},t.prototype.keys=function(){return new Va(this,Hh)},t.prototype.set=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=Ua(this._tree,e);return n.set(Oe,r),this},Object.defineProperty(t.prototype,"size",{get:function(){if(this._size)return this._size;this._size=0;for(var e=this.entries();!e.next().done;)this._size+=1;return this._size},enumerable:!1,configurable:!0}),t.prototype.update=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=Ua(this._tree,e);return n.set(Oe,r(n.get(Oe))),this},t.prototype.fetch=function(e,r){if(typeof e!="string")throw new Error("key must be a string");this._size=void 0;var n=Ua(this._tree,e),i=n.get(Oe);return i===void 0&&n.set(Oe,i=r()),i},t.prototype.values=function(){return new Va(this,Vh)},t.prototype[Symbol.iterator]=function(){return this.entries()},t.from=function(e){var r,n,i=new t;try{for(var o=q(e),s=o.next();!s.done;s=o.next()){var a=be(s.value,2),u=a[0],l=a[1];i.set(u,l)}}catch(f){r={error:f}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},t.fromObject=function(e){return t.from(Object.entries(e))},t}(),Uo=function(t,e,r){var n,i;if(r===void 0&&(r=[]),e.length===0||t==null)return[t,r];try{for(var o=q(t.keys()),s=o.next();!s.done;s=o.next()){var a=s.value;if(a!==Oe&&e.startsWith(a))return r.push([t,a]),Uo(t.get(a),e.slice(a.length),r)}}catch(u){n={error:u}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return r.push([t,e]),Uo(void 0,"",r)},Wa=function(t,e){var r,n;if(e.length===0||t==null)return t;try{for(var i=q(t.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;if(s!==Oe&&e.startsWith(s))return Wa(t.get(s),e.slice(s.length))}}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},Ua=function(t,e){var r,n,i=e.length;e:for(var o=0;t&&o<i;){try{for(var s=(r=void 0,q(t.keys())),a=s.next();!a.done;a=s.next()){var u=a.value;if(u!==Oe&&e[o]===u[0]){for(var l=Math.min(i-o,u.length),f=1;f<l&&e[o+f]===u[f];)++f;var p=t.get(u);if(f===u.length)t=p;else{var c=new Map;c.set(u.slice(f),p),t.set(e.slice(o,o+f),c),t.delete(u),t=c}o+=f;continue e}}}catch(w){r={error:w}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}var h=new Map;return t.set(e.slice(o),h),h}return t},M0=function(t,e){var r=be(Uo(t,e),2),n=r[0],i=r[1];if(n!==void 0){if(n.delete(Oe),n.size===0)Wh(i);else if(n.size===1){var o=be(n.entries().next().value,2),s=o[0],a=o[1];Uh(i,s,a)}}},Wh=function(t){if(t.length!==0){var e=be(Ga(t),2),r=e[0],n=e[1];if(r.delete(n),r.size===0)Wh(t.slice(0,-1));else if(r.size===1){var i=be(r.entries().next().value,2),o=i[0],s=i[1];o!==Oe&&Uh(t.slice(0,-1),o,s)}}},Uh=function(t,e,r){if(t.length!==0){var n=be(Ga(t),2),i=n[0],o=n[1];i.set(o+e,r),i.delete(o)}},Ga=function(t){return t[t.length-1]},Qa="or",Gh="and",R0="and_not",qa=function(){function t(e){if((e==null?void 0:e.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');var r=e.autoVacuum==null||e.autoVacuum===!0?el:e.autoVacuum;this._options=fe(fe(fe({},Ja),e),{autoVacuum:r,searchOptions:fe(fe({},Qh),e.searchOptions||{}),autoSuggestOptions:fe(fe({},z0),e.autoSuggestOptions||{})}),this._index=new $a,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=Za,this.addFields(this._options.fields)}return t.prototype.add=function(e){var r,n,i,o,s,a,u=this._options,l=u.extractField,f=u.tokenize,p=u.processTerm,c=u.fields,h=u.idField,w=l(e,h);if(w==null)throw new Error('MiniSearch: document does not have ID field "'.concat(h,'"'));if(this._idToShortId.has(w))throw new Error("MiniSearch: duplicate ID ".concat(w));var x=this.addDocumentId(w);this.saveStoredFields(x,e);try{for(var v=q(c),d=v.next();!d.done;d=v.next()){var b=d.value,m=l(e,b);if(m!=null){var g=f(m.toString(),b),y=this._fieldIds[b],_=new Set(g).size;this.addFieldLength(x,y,this._documentCount-1,_);try{for(var A=(i=void 0,q(g)),C=A.next();!C.done;C=A.next()){var F=C.value,D=p(F,b);if(Array.isArray(D))try{for(var P=(s=void 0,q(D)),N=P.next();!N.done;N=P.next()){var k=N.value;this.addTerm(y,x,k)}}catch(H){s={error:H}}finally{try{N&&!N.done&&(a=P.return)&&a.call(P)}finally{if(s)throw s.error}}else D&&this.addTerm(y,x,D)}}catch(H){i={error:H}}finally{try{C&&!C.done&&(o=A.return)&&o.call(A)}finally{if(i)throw i.error}}}}}catch(H){r={error:H}}finally{try{d&&!d.done&&(n=v.return)&&n.call(v)}finally{if(r)throw r.error}}},t.prototype.addAll=function(e){var r,n;try{for(var i=q(e),o=i.next();!o.done;o=i.next()){var s=o.value;this.add(s)}}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.addAllAsync=function(e,r){var n=this;r===void 0&&(r={});var i=r.chunkSize,o=i===void 0?10:i,s={chunk:[],promise:Promise.resolve()},a=e.reduce(function(f,p,c){var h=f.chunk,w=f.promise;return h.push(p),(c+1)%o==0?{chunk:[],promise:w.then(function(){return new Promise(function(x){return setTimeout(x,0)})}).then(function(){return n.addAll(h)})}:{chunk:h,promise:w}},s),u=a.chunk,l=a.promise;return l.then(function(){return n.addAll(u)})},t.prototype.remove=function(e){var r,n,i,o,s,a,u=this._options,l=u.tokenize,f=u.processTerm,p=u.extractField,c=u.fields,h=u.idField,w=p(e,h);if(w==null)throw new Error('MiniSearch: document does not have ID field "'.concat(h,'"'));var x=this._idToShortId.get(w);if(x==null)throw new Error("MiniSearch: cannot remove document with ID ".concat(w,": it is not in the index"));try{for(var v=q(c),d=v.next();!d.done;d=v.next()){var b=d.value,m=p(e,b);if(m!=null){var g=l(m.toString(),b),y=this._fieldIds[b],_=new Set(g).size;this.removeFieldLength(x,y,this._documentCount,_);try{for(var A=(i=void 0,q(g)),C=A.next();!C.done;C=A.next()){var F=C.value,D=f(F,b);if(Array.isArray(D))try{for(var P=(s=void 0,q(D)),N=P.next();!N.done;N=P.next()){var k=N.value;this.removeTerm(y,x,k)}}catch(H){s={error:H}}finally{try{N&&!N.done&&(a=P.return)&&a.call(P)}finally{if(s)throw s.error}}else D&&this.removeTerm(y,x,D)}}catch(H){i={error:H}}finally{try{C&&!C.done&&(o=A.return)&&o.call(A)}finally{if(i)throw i.error}}}}}catch(H){r={error:H}}finally{try{d&&!d.done&&(n=v.return)&&n.call(v)}finally{if(r)throw r.error}}this._storedFields.delete(x),this._documentIds.delete(x),this._idToShortId.delete(w),this._fieldLength.delete(x),this._documentCount-=1},t.prototype.removeAll=function(e){var r,n;if(e)try{for(var i=q(e),o=i.next();!o.done;o=i.next()){var s=o.value;this.remove(s)}}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new $a,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}},t.prototype.discard=function(e){var r=this,n=this._idToShortId.get(e);if(n==null)throw new Error("MiniSearch: cannot discard document with ID ".concat(e,": it is not in the index"));this._idToShortId.delete(e),this._documentIds.delete(n),this._storedFields.delete(n),(this._fieldLength.get(n)||[]).forEach(function(i,o){r.removeFieldLength(n,o,r._documentCount,i)}),this._fieldLength.delete(n),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()},t.prototype.maybeAutoVacuum=function(){if(this._options.autoVacuum!==!1){var e=this._options.autoVacuum,r=e.minDirtFactor,n=e.minDirtCount,i=e.batchSize,o=e.batchWait;this.conditionalVacuum({batchSize:i,batchWait:o},{minDirtCount:n,minDirtFactor:r})}},t.prototype.discardAll=function(e){var r,n,i=this._options.autoVacuum;try{this._options.autoVacuum=!1;try{for(var o=q(e),s=o.next();!s.done;s=o.next()){var a=s.value;this.discard(a)}}catch(u){r={error:u}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}finally{this._options.autoVacuum=i}this.maybeAutoVacuum()},t.prototype.replace=function(e){var r=this._options,n=r.idField,i=r.extractField,o=i(e,n);this.discard(o),this.add(e)},t.prototype.vacuum=function(e){return e===void 0&&(e={}),this.conditionalVacuum(e)},t.prototype.conditionalVacuum=function(e,r){var n=this;return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&r,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(function(){var i=n._enqueuedVacuumConditions;return n._enqueuedVacuumConditions=Za,n.performVacuuming(e,i)}),this._enqueuedVacuum)):this.vacuumConditionsMet(r)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)},t.prototype.performVacuuming=function(e,r){return O0(this,void 0,void 0,function(){var n,i,o,s,a,u,l,f,p,c,h,w,x,v,d,b,m,g,y,_,A,C,F,D,P;return I0(this,function(N){switch(N.label){case 0:if(n=this._dirtCount,!this.vacuumConditionsMet(r))return[3,10];i=e.batchSize||Xa.batchSize,o=e.batchWait||Xa.batchWait,s=1,N.label=1;case 1:N.trys.push([1,7,8,9]),a=q(this._index),u=a.next(),N.label=2;case 2:if(u.done)return[3,6];l=be(u.value,2),f=l[0],p=l[1];try{for(c=(C=void 0,q(p)),h=c.next();!h.done;h=c.next()){w=be(h.value,2),x=w[0],v=w[1];try{for(d=(D=void 0,q(v)),b=d.next();!b.done;b=d.next())m=be(b.value,1),g=m[0],!this._documentIds.has(g)&&(v.size<=1?p.delete(x):v.delete(g))}catch(k){D={error:k}}finally{try{b&&!b.done&&(P=d.return)&&P.call(d)}finally{if(D)throw D.error}}}}catch(k){C={error:k}}finally{try{h&&!h.done&&(F=c.return)&&F.call(c)}finally{if(C)throw C.error}}return this._index.get(f).size===0&&this._index.delete(f),s%i!=0?[3,4]:[4,new Promise(function(k){return setTimeout(k,o)})];case 3:N.sent(),N.label=4;case 4:s+=1,N.label=5;case 5:return u=a.next(),[3,2];case 6:return[3,9];case 7:return y=N.sent(),_={error:y},[3,9];case 8:try{u&&!u.done&&(A=a.return)&&A.call(a)}finally{if(_)throw _.error}return[7];case 9:this._dirtCount-=n,N.label=10;case 10:return[4,null];case 11:return N.sent(),this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null,[2]}})})},t.prototype.vacuumConditionsMet=function(e){if(e==null)return!0;var r=e.minDirtCount,n=e.minDirtFactor;return r=r||el.minDirtCount,n=n||el.minDirtFactor,this.dirtCount>=r&&this.dirtFactor>=n},Object.defineProperty(t.prototype,"isVacuuming",{get:function(){return this._currentVacuum!=null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dirtCount",{get:function(){return this._dirtCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dirtFactor",{get:function(){return this._dirtCount/(1+this._documentCount+this._dirtCount)},enumerable:!1,configurable:!0}),t.prototype.has=function(e){return this._idToShortId.has(e)},t.prototype.search=function(e,r){var n,i;r===void 0&&(r={});var o=this.executeQuery(e,r),s=[];try{for(var a=q(o),u=a.next();!u.done;u=a.next()){var l=be(u.value,2),f=l[0],p=l[1],c=p.score,h=p.terms,w=p.match,x=h.length,v={id:this._documentIds.get(f),score:c*x,terms:Object.keys(w),match:w};Object.assign(v,this._storedFields.get(f)),(r.filter==null||r.filter(v))&&s.push(v)}}catch(d){n={error:d}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return s.sort(Yh),s},t.prototype.autoSuggest=function(e,r){var n,i,o,s;r===void 0&&(r={}),r=fe(fe({},this._options.autoSuggestOptions),r);var a=new Map;try{for(var u=q(this.search(e,r)),l=u.next();!l.done;l=u.next()){var f=l.value,p=f.score,c=f.terms,h=c.join(" "),w=a.get(h);w!=null?(w.score+=p,w.count+=1):a.set(h,{score:p,terms:c,count:1})}}catch(y){n={error:y}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}var x=[];try{for(var v=q(a),d=v.next();!d.done;d=v.next()){var b=be(d.value,2),w=b[0],m=b[1],p=m.score,c=m.terms,g=m.count;x.push({suggestion:w,terms:c,score:p/g})}}catch(y){o={error:y}}finally{try{d&&!d.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}return x.sort(Yh),x},Object.defineProperty(t.prototype,"documentCount",{get:function(){return this._documentCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"termCount",{get:function(){return this._index.size},enumerable:!1,configurable:!0}),t.loadJSON=function(e,r){if(r==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(e),r)},t.getDefault=function(e){if(Ja.hasOwnProperty(e))return Ya(Ja,e);throw new Error('MiniSearch: unknown option "'.concat(e,'"'))},t.loadJS=function(e,r){var n,i,o,s,a,u,l=e.index,f=e.documentCount,p=e.nextId,c=e.documentIds,h=e.fieldIds,w=e.fieldLength,x=e.averageFieldLength,v=e.storedFields,d=e.dirtCount,b=e.serializationVersion;if(b!==1&&b!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");var m=new t(r);m._documentCount=f,m._nextId=p,m._documentIds=Go(c),m._idToShortId=new Map,m._fieldIds=h,m._fieldLength=Go(w),m._avgFieldLength=x,m._storedFields=Go(v),m._dirtCount=d||0,m._index=new $a;try{for(var g=q(m._documentIds),y=g.next();!y.done;y=g.next()){var _=be(y.value,2),A=_[0],C=_[1];m._idToShortId.set(C,A)}}catch(E){n={error:E}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}try{for(var F=q(l),D=F.next();!D.done;D=F.next()){var P=be(D.value,2),N=P[0],k=P[1],H=new Map;try{for(var X=(a=void 0,q(Object.keys(k))),J=X.next();!J.done;J=X.next()){var Y=J.value,S=k[Y];b===1&&(S=S.ds),H.set(parseInt(Y,10),Go(S))}}catch(E){a={error:E}}finally{try{J&&!J.done&&(u=X.return)&&u.call(X)}finally{if(a)throw a.error}}m._index.set(N,H)}}catch(E){o={error:E}}finally{try{D&&!D.done&&(s=F.return)&&s.call(F)}finally{if(o)throw o.error}}return m},t.prototype.executeQuery=function(e,r){var n=this;if(r===void 0&&(r={}),typeof e!="string"){var i=fe(fe(fe({},r),e),{queries:void 0}),o=e.queries.map(function(v){return n.executeQuery(v,i)});return this.combineResults(o,e.combineWith)}var s=this._options,a=s.tokenize,u=s.processTerm,l=s.searchOptions,f=fe(fe({tokenize:a,processTerm:u},l),r),p=f.tokenize,c=f.processTerm,h=p(e).flatMap(function(v){return c(v)}).filter(function(v){return!!v}),w=h.map(K0(f)),x=w.map(function(v){return n.executeQuerySpec(v,f)});return this.combineResults(x,f.combineWith)},t.prototype.executeQuerySpec=function(e,r){var n,i,o,s,a=fe(fe({},this._options.searchOptions),r),u=(a.fields||this._options.fields).reduce(function(Y,S){var E;return fe(fe({},Y),(E={},E[S]=Ya(Y,S)||1,E))},a.boost||{}),l=a.boostDocument,f=a.weights,p=a.maxFuzzy,c=a.bm25,h=fe(fe({},Qh.weights),f),w=h.fuzzy,x=h.prefix,v=this._index.get(e.term),d=this.termResults(e.term,e.term,1,v,u,l,c),b,m;if(e.prefix&&(b=this._index.atPrefix(e.term)),e.fuzzy){var g=e.fuzzy===!0?.2:e.fuzzy,y=g<1?Math.min(p,Math.round(e.term.length*g)):g;y&&(m=this._index.fuzzyGet(e.term,y))}if(b)try{for(var _=q(b),A=_.next();!A.done;A=_.next()){var C=be(A.value,2),F=C[0],D=C[1],P=F.length-e.term.length;if(!!P){m==null||m.delete(F);var N=x*F.length/(F.length+.3*P);this.termResults(e.term,F,N,D,u,l,c,d)}}}catch(Y){n={error:Y}}finally{try{A&&!A.done&&(i=_.return)&&i.call(_)}finally{if(n)throw n.error}}if(m)try{for(var k=q(m.keys()),H=k.next();!H.done;H=k.next()){var F=H.value,X=be(m.get(F),2),J=X[0],P=X[1];if(!!P){var N=w*F.length/(F.length+P);this.termResults(e.term,F,N,J,u,l,c,d)}}}catch(Y){o={error:Y}}finally{try{H&&!H.done&&(s=k.return)&&s.call(k)}finally{if(o)throw o.error}}return d},t.prototype.combineResults=function(e,r){if(r===void 0&&(r=Qa),e.length===0)return new Map;var n=r.toLowerCase();return e.reduce(L0[n])||new Map},t.prototype.toJSON=function(){var e,r,n,i,o=[];try{for(var s=q(this._index),a=s.next();!a.done;a=s.next()){var u=be(a.value,2),l=u[0],f=u[1],p={};try{for(var c=(n=void 0,q(f)),h=c.next();!h.done;h=c.next()){var w=be(h.value,2),x=w[0],v=w[1];p[x]=Object.fromEntries(v)}}catch(d){n={error:d}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}o.push([l,p])}}catch(d){e={error:d}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:o,serializationVersion:2}},t.prototype.termResults=function(e,r,n,i,o,s,a,u){var l,f,p,c,h;if(u===void 0&&(u=new Map),i==null)return u;try{for(var w=q(Object.keys(o)),x=w.next();!x.done;x=w.next()){var v=x.value,d=o[v],b=this._fieldIds[v],m=i.get(b);if(m!=null){var g=m.size,y=this._avgFieldLength[b];try{for(var _=(p=void 0,q(m.keys())),A=_.next();!A.done;A=_.next()){var C=A.value;if(!this._documentIds.has(C)){this.removeTerm(b,C,r),g-=1;continue}var F=s?s(this._documentIds.get(C),r):1;if(!!F){var D=m.get(C),P=this._fieldLength.get(C)[b],N=B0(D,g,this._documentCount,P,y,a),k=n*d*F*N,H=u.get(C);if(H){H.score+=k,H0(H.terms,e);var X=Ya(H.match,r);X?X.push(v):H.match[r]=[v]}else u.set(C,{score:k,terms:[e],match:(h={},h[r]=[v],h)})}}}catch(J){p={error:J}}finally{try{A&&!A.done&&(c=_.return)&&c.call(_)}finally{if(p)throw p.error}}}}}catch(J){l={error:J}}finally{try{x&&!x.done&&(f=w.return)&&f.call(w)}finally{if(l)throw l.error}}return u},t.prototype.addTerm=function(e,r,n){var i=this._index.fetch(n,Jh),o=i.get(e);if(o==null)o=new Map,o.set(r,1),i.set(e,o);else{var s=o.get(r);o.set(r,(s||0)+1)}},t.prototype.removeTerm=function(e,r,n){if(!this._index.has(n)){this.warnDocumentChanged(r,e,n);return}var i=this._index.fetch(n,Jh),o=i.get(e);o==null||o.get(r)==null?this.warnDocumentChanged(r,e,n):o.get(r)<=1?o.size<=1?i.delete(e):o.delete(r):o.set(r,o.get(r)-1),this._index.get(n).size===0&&this._index.delete(n)},t.prototype.warnDocumentChanged=function(e,r,n){var i,o;try{for(var s=q(Object.keys(this._fieldIds)),a=s.next();!a.done;a=s.next()){var u=a.value;if(this._fieldIds[u]===r){this._options.logger("warn","MiniSearch: document with ID ".concat(this._documentIds.get(e),' has changed before removal: term "').concat(n,'" was not present in field "').concat(u,'". Removing a document after it has changed can corrupt the index!'),"version_conflict");return}}}catch(l){i={error:l}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}},t.prototype.addDocumentId=function(e){var r=this._nextId;return this._idToShortId.set(e,r),this._documentIds.set(r,e),this._documentCount+=1,this._nextId+=1,r},t.prototype.addFields=function(e){for(var r=0;r<e.length;r++)this._fieldIds[e[r]]=r},t.prototype.addFieldLength=function(e,r,n,i){var o=this._fieldLength.get(e);o==null&&this._fieldLength.set(e,o=[]),o[r]=i;var s=this._avgFieldLength[r]||0,a=s*n+i;this._avgFieldLength[r]=a/(n+1)},t.prototype.removeFieldLength=function(e,r,n,i){if(n===1){this._avgFieldLength[r]=0;return}var o=this._avgFieldLength[r]*n-i;this._avgFieldLength[r]=o/(n-1)},t.prototype.saveStoredFields=function(e,r){var n,i,o=this._options,s=o.storeFields,a=o.extractField;if(!(s==null||s.length===0)){var u=this._storedFields.get(e);u==null&&this._storedFields.set(e,u={});try{for(var l=q(s),f=l.next();!f.done;f=l.next()){var p=f.value,c=a(r,p);c!==void 0&&(u[p]=c)}}catch(h){n={error:h}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}},t}(),Ya=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},L0=(fi={},fi[Qa]=function(t,e){var r,n;try{for(var i=q(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value,a=t.get(s);if(a==null)t.set(s,e.get(s));else{var u=e.get(s),l=u.score,f=u.terms,p=u.match;a.score=a.score+l,a.match=Object.assign(a.match,p),qh(a.terms,f)}}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t},fi[Gh]=function(t,e){var r,n,i=new Map;try{for(var o=q(e.keys()),s=o.next();!s.done;s=o.next()){var a=s.value,u=t.get(a);if(u!=null){var l=e.get(a),f=l.score,p=l.terms,c=l.match;qh(u.terms,p),i.set(a,{score:u.score+f,terms:u.terms,match:Object.assign(u.match,c)})}}}catch(h){r={error:h}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},fi[R0]=function(t,e){var r,n;try{for(var i=q(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;t.delete(s)}}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t},fi),N0={k:1.2,b:.7,d:.5},B0=function(t,e,r,n,i,o){var s=o.k,a=o.b,u=o.d,l=Math.log(1+(r-e+.5)/(e+.5));return l*(u+t*(s+1)/(t+s*(1-a+a*n/i)))},K0=function(t){return function(e,r,n){var i=typeof t.fuzzy=="function"?t.fuzzy(e,r,n):t.fuzzy||!1,o=typeof t.prefix=="function"?t.prefix(e,r,n):t.prefix===!0;return{term:e,fuzzy:i,prefix:o}}},Ja={idField:"id",extractField:function(t,e){return t[e]},tokenize:function(t,e){return t.split(V0)},processTerm:function(t,e){return t.toLowerCase()},fields:void 0,searchOptions:void 0,storeFields:[],logger:function(t,e,r){return console!=null&&console.warn!=null&&console[t](e)},autoVacuum:!0},Qh={combineWith:Qa,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:N0},z0={combineWith:Gh,prefix:function(t,e,r){return e===r.length-1}},Xa={batchSize:1e3,batchWait:10},Za={minDirtFactor:.1,minDirtCount:20},el=fe(fe({},Xa),Za),H0=function(t,e){t.includes(e)||t.push(e)},qh=function(t,e){var r,n;try{for(var i=q(e),o=i.next();!o.done;o=i.next()){var s=o.value;t.includes(s)||t.push(s)}}catch(a){r={error:a}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},Yh=function(t,e){var r=t.score,n=e.score;return n-r},Jh=function(){return new Map},Go=function(t){var e,r,n=new Map;try{for(var i=q(Object.keys(t)),o=i.next();!o.done;o=i.next()){var s=o.value;n.set(parseInt(s,10),t[s])}}catch(a){e={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},V0=/[\n\r -#%-*,-/:;?@[-\]_{}\u00A0\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]+/u});var Zh,$0,Qo,tl,je,yn=j(()=>{Xh();ot();Ze();At();Zh=ge(require("obsidian"));Gn();ci();hn();$0=t=>{let e=t.split($n);e=[...e,...e.flatMap(Lu)],e=[...e,...e.flatMap(Ru)];let r=Gi();return r&&(e=e.flatMap(n=>ju.test(n)?r.cut(n):[n])),e},Qo=class{constructor(){this.indexedDocuments=new Map;this.minisearch=new qa(Qo.options)}async loadCache(){let e=await Fe.getMinisearchCache();return e?(this.minisearch=qa.loadJS(e.data,Qo.options),this.indexedDocuments=new Map(e.paths.map(r=>[r.path,r.mtime])),!0):(console.log("Omnisearch - No cache found"),!1)}getDiff(e){let r=new Map(e.map(o=>[o.path,o.mtime])),n=e.filter(o=>!this.indexedDocuments.has(o.path)||this.indexedDocuments.get(o.path)!==o.mtime),i=[...this.indexedDocuments].filter(([o,s])=>!r.has(o)||r.get(o)!==s).map(o=>({path:o[0],mtime:o[1]}));return{toAdd:n,toRemove:i}}async addFromPaths(e){de("Adding files",e);let r=(await Promise.all(e.map(async i=>await Fe.getDocument(i)))).filter(i=>!!i?.path);de("Sorting documents to first index markdown"),r=Ka(r,i=>i.path.endsWith(".md")?0:1),this.removeFromPaths(r.filter(i=>this.indexedDocuments.has(i.path)).map(i=>i.path));let n=Mu(r,500);for(let i of n){de("Indexing into search engine",i),i.forEach(s=>this.indexedDocuments.set(s.path,s.mtime));let o=i.filter(s=>this.minisearch.has(s.path));this.removeFromPaths(o.map(s=>s.path)),await this.minisearch.addAllAsync(i)}}removeFromPaths(e){e.forEach(n=>this.indexedDocuments.delete(n));let r=e.filter(n=>this.minisearch.has(n));this.minisearch.discardAll(r)}async search(e,r){if(e.isEmpty())return[];de("=== New search ==="),de("Starting search for",e);let n;switch(T.fuzziness){case"0":n=0;break;case"1":n=.1;break;default:n=.2;break}let i=this.minisearch.search(e.segmentsToStr(),{prefix:l=>l.length>=r.prefixLength,fuzzy:l=>l.length<=3?0:l.length<=5?n/2:n,combineWith:"AND",boost:{basename:T.weightBasename,directory:T.weightDirectory,aliases:T.weightBasename,headings1:T.weightH1,headings2:T.weightH2,headings3:T.weightH3,unmarkedTags:T.weightUnmarkedTags}});if(de("Found",i.length,"results"),e.query.ext?.length&&(i=i.filter(l=>{let f="."+l.id.split(".").pop();return e.query.ext?.some(p=>f.startsWith(p.startsWith(".")?p:"."+p))})),e.query.path&&(i=i.filter(l=>e.query.path?.some(f=>l.id.toLowerCase().includes(f.toLowerCase())))),e.query.exclude.path&&(i=i.filter(l=>!e.query.exclude.path?.some(f=>l.id.toLowerCase().includes(f.toLowerCase())))),!i.length)return[];if(r.singleFilePath)return i.filter(l=>l.id===r.singleFilePath);T.hideExcluded?i=i.filter(l=>!(app.metadataCache.isUserIgnored&&app.metadataCache.isUserIgnored(l.id))):i.forEach(l=>{app.metadataCache.isUserIgnored&&app.metadataCache.isUserIgnored(l.id)&&(l.score/=10)});let o=e.getTags();for(let l of o)for(let f of i)(f.tags??[]).includes(l)&&(f.score*=100);de("Sorting and limiting results"),i=i.sort((l,f)=>f.score-l.score).slice(0,50),i.length&&de("First result:",i[0]);let s=await Promise.all(i.map(async l=>await Fe.getDocument(l.id))),a=e.getExactTerms();a.length&&(de("Filtering with quoted terms: ",a),i=i.filter(l=>{let f=s.find(h=>h.path===l.id),p=f?.path.toLowerCase()??"",c=ca(f?.content??"").toLowerCase();return a.every(h=>c.includes(h)||p.includes(h))}));let u=e.query.exclude.text;return u.length&&(de("Filtering with exclusions"),i=i.filter(l=>{let f=ca(s.find(p=>p.path===l.id)?.content??"").toLowerCase();return u.every(p=>!f.includes(p))})),de("Deduping"),i=i.filter((l,f,p)=>p.findIndex(c=>c.id===l.id)===f),i}async getSuggestions(e,r){let n;T.simpleSearch?n=await this.search(e,{prefixLength:3,singleFilePath:r?.singleFilePath}):n=await this.search(e,{prefixLength:1,singleFilePath:r?.singleFilePath});let i=await Promise.all(n.map(async s=>await Fe.getDocument(s.id)));return n.map(s=>{de("Locating matches for",s.id);let a=i.find(p=>p.path===s.id);a||(console.warn(`Omnisearch - Note "${s.id}" not in the live cache`),a={content:"",basename:s.id,path:s.id});let u=[...Object.keys(s.match),...e.getExactTerms(),...e.getTags()].filter(p=>p.length>1||/\p{Emoji}/u.test(p));de("Matching tokens:",u),de("Getting matches locations...");let l=zo(a.content,dn(u),e);return de(`Matches for ${a.basename}`,l),he({score:s.score,foundWords:u,matches:l},a)})}async writeToCache(){await Fe.writeMinisearchCache(this.minisearch,this.indexedDocuments)}},tl=Qo;tl.options={tokenize:$0,extractField:(e,r)=>{if(r==="directory"){let n=e.path.split("/");return n.pop(),n.join("/")}return e[r]},processTerm:e=>(T.ignoreDiacritics?jt(e):e).toLowerCase(),idField:"path",fields:["basename","directory","aliases","content","headings1","headings2","headings3"],storeFields:["tags"],logger(e,r,n){n==="version_conflict"&&new Zh.Notice("Omnisearch - Your index cache may be incorrect or corrupted. If this message keeps appearing, go to Settings to clear the cache.",5e3)}};je=new tl});function em(t){rl.add(t)}async function qo(){let t=[...rl].map(e=>e.path);t.length&&(je.removeFromPaths(t),await je.addFromPaths(t),rl.clear())}var rl,Yo=j(()=>{yn();rl=new Set});var tm=pi(Jo=>{function nl(t){return nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nl(t)}(function(t,e){if(typeof define=="function"&&define.amd)define(["exports"],e);else if(typeof Jo!="undefined")e(Jo);else{var r={exports:{}};e(r.exports),t.CancelablePromise=r.exports}})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:Jo,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancelablePromise=void 0,t.cancelable=N,t.default=void 0,t.isCancelablePromise=k;function e(S,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function");S.prototype=Object.create(E&&E.prototype,{constructor:{value:S,writable:!0,configurable:!0}}),Object.defineProperty(S,"prototype",{writable:!1}),E&&r(S,E)}function r(S,E){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(K,Z){return K.__proto__=Z,K},r(S,E)}function n(S){var E=s();return function(){var K=a(S),Z;if(E){var M=a(this).constructor;Z=Reflect.construct(K,arguments,M)}else Z=K.apply(this,arguments);return i(this,Z)}}function i(S,E){if(E&&(nl(E)==="object"||typeof E=="function"))return E;if(E!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o(S)}function o(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}function s(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function a(S){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(I){return I.__proto__||Object.getPrototypeOf(I)},a(S)}function u(S,E){var I=typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(!I){if(Array.isArray(S)||(I=l(S))||E&&S&&typeof S.length=="number"){I&&(S=I);var K=0,Z=function(){};return{s:Z,n:function(){return K>=S.length?{done:!0}:{done:!1,value:S[K++]}},e:function(ye){throw ye},f:Z}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,ne=!1,ze;return{s:function(){I=I.call(S)},n:function(){var ye=I.next();return M=ye.done,ye},e:function(ye){ne=!0,ze=ye},f:function(){try{!M&&I.return!=null&&I.return()}finally{if(ne)throw ze}}}}function l(S,E){if(!!S){if(typeof S=="string")return f(S,E);var I=Object.prototype.toString.call(S).slice(8,-1);if(I==="Object"&&S.constructor&&(I=S.constructor.name),I==="Map"||I==="Set")return Array.from(S);if(I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I))return f(S,E)}}function f(S,E){(E==null||E>S.length)&&(E=S.length);for(var I=0,K=new Array(E);I<E;I++)K[I]=S[I];return K}function p(S,E){if(!(S instanceof E))throw new TypeError("Cannot call a class as a function")}function c(S,E){for(var I=0;I<E.length;I++){var K=E[I];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(S,K.key,K)}}function h(S,E,I){return E&&c(S.prototype,E),I&&c(S,I),Object.defineProperty(S,"prototype",{writable:!1}),S}function w(S,E,I){return E in S?Object.defineProperty(S,E,{value:I,enumerable:!0,configurable:!0,writable:!0}):S[E]=I,S}function x(S,E,I){v(S,E),E.set(S,I)}function v(S,E){if(E.has(S))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d(S,E){var I=g(S,E,"get");return b(S,I)}function b(S,E){return E.get?E.get.call(S):E.value}function m(S,E,I){var K=g(S,E,"set");return y(S,K,I),I}function g(S,E,I){if(!E.has(S))throw new TypeError("attempted to "+I+" private field on non-instance");return E.get(S)}function y(S,E,I){if(E.set)E.set.call(S,I);else{if(!E.writable)throw new TypeError("attempted to set read only private field");E.value=I}}var _=typeof Symbol!="undefined"?Symbol.toStringTag:"@@toStringTag",A=new WeakMap,C=new WeakMap,F=function(){function S(E){var I=E.executor,K=I===void 0?function(){}:I,Z=E.internals,M=Z===void 0?Y():Z,ne=E.promise,ze=ne===void 0?new Promise(function(Ae,ye){return K(Ae,ye,function(He){M.onCancelList.push(He)})}):ne;p(this,S),x(this,A,{writable:!0,value:void 0}),x(this,C,{writable:!0,value:void 0}),w(this,_,"CancelablePromise"),this.cancel=this.cancel.bind(this),m(this,A,M),m(this,C,ze||new Promise(function(Ae,ye){return K(Ae,ye,function(He){M.onCancelList.push(He)})}))}return h(S,[{key:"then",value:function(I,K){return X(d(this,C).then(H(I,d(this,A)),H(K,d(this,A))),d(this,A))}},{key:"catch",value:function(I){return X(d(this,C).catch(H(I,d(this,A))),d(this,A))}},{key:"finally",value:function(I,K){var Z=this;return K&&d(this,A).onCancelList.push(I),X(d(this,C).finally(H(function(){if(I)return K&&(d(Z,A).onCancelList=d(Z,A).onCancelList.filter(function(M){return M!==I})),I()},d(this,A))),d(this,A))}},{key:"cancel",value:function(){d(this,A).isCanceled=!0;var I=d(this,A).onCancelList;d(this,A).onCancelList=[];var K=u(I),Z;try{for(K.s();!(Z=K.n()).done;){var M=Z.value;if(typeof M=="function")try{M()}catch(ne){console.error(ne)}}}catch(ne){K.e(ne)}finally{K.f()}}},{key:"isCanceled",value:function(){return d(this,A).isCanceled===!0}}]),S}(),D=function(S){e(I,S);var E=n(I);function I(K){return p(this,I),E.call(this,{executor:K})}return h(I)}(F);t.CancelablePromise=D,w(D,"all",function(E){return J(E,Promise.all(E))}),w(D,"allSettled",function(E){return J(E,Promise.allSettled(E))}),w(D,"any",function(E){return J(E,Promise.any(E))}),w(D,"race",function(E){return J(E,Promise.race(E))}),w(D,"resolve",function(E){return N(Promise.resolve(E))}),w(D,"reject",function(E){return N(Promise.reject(E))}),w(D,"isCancelable",k);var P=D;t.default=P;function N(S){return X(S,Y())}function k(S){return S instanceof D||S instanceof F}function H(S,E){if(S)return function(I){if(!E.isCanceled){var K=S(I);return k(K)&&E.onCancelList.push(K.cancel),K}return I}}function X(S,E){return new F({internals:E,promise:S})}function J(S,E){var I=Y();return I.onCancelList.push(function(){var K=u(S),Z;try{for(K.s();!(Z=K.n()).done;){var M=Z.value;k(M)&&M.cancel()}}catch(ne){K.e(ne)}finally{K.f()}}),new F({internals:I,promise:E})}function Y(){return{isCanceled:!1,onCancelList:[]}}})});function u1(t){return t.map(e=>{let{score:r,path:n,basename:i,foundWords:o,matches:s,content:a}=e,u=pn(a,s[0]?.offset??-1);return{score:r,vault:app.vault.getName(),path:n,basename:i,foundWords:o,matches:s.map(f=>({match:f.match,offset:f.offset})),excerpt:u.content}})}async function c1(t){let e=new xr(t),r=await je.getSuggestions(e);return u1(r)}function f1(t){Zo.push(t),ym&&t()}function d1(t){Zo=Zo.filter(e=>e!==t)}function _m(){ym=!0,Zo.forEach(t=>t())}var ym,Zo,di,ol=j(()=>{Wo();yn();hn();Yo();ym=!1,Zo=[];di={search:c1,registerOnIndexed:f1,unregisterOnIndexed:d1,refreshIndex:qo}});var wm={};dl(wm,{default:()=>p1,getServer:()=>xm});function xm(){let t=vm.createServer(async function(e,r){r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Allow-Methods","GET, HEAD, POST, OPTIONS, PUT, PATCH, DELETE"),r.setHeader("Access-Control-Allow-Headers","Access-Control-Allow-Headers, Origin, Authorization,Accept,x-client-id, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers, hypothesis-client-version"),r.setHeader("Access-Control-Allow-Credentials","true");try{if(e.url){let n=bm.parse(e.url,!0);if(n.pathname==="/search"){let i=n.query.q,o=await di.search(i);r.statusCode=200,r.setHeader("Content-Type","application/json"),r.end(JSON.stringify(o))}else r.end()}}catch(n){r.statusCode=500,r.end(n)}});return{listen(e){console.log(`Omnisearch - Starting HTTP server on port ${e}`),t.listen({port:parseInt(e),host:"localhost"},()=>{console.log(`Omnisearch - Started HTTP server on port ${e}`),new es.Notice(`Omnisearch - Started HTTP server on port ${e}`)}),t.on("error",r=>{console.error(r),new es.Notice(`Omnisearch - Cannot start HTTP server on ${e}. See console for more details.`)})},close(){t.close(),console.log("Omnisearch - Terminated HTTP server"),new es.Notice("Omnisearch - Terminated HTTP server")}}}var vm,bm,es,p1,jm=j(()=>{vm=ge(require("http")),bm=ge(require("url"));ol();es=ge(require("obsidian"));Ze();p1=xm});dl(exports,{default:()=>sl});var tr=ge(require("obsidian"));var Xo=ge(require("obsidian"));Xe();var er=ge(require("obsidian"));Xe();Xe();var Hu=ge(require("obsidian"));ot();Gn();function hy(t){let e,r,n,i,o,s,a,u,l=t[8].default,f=Ar(l,t,t[7],null);return{c(){e=R("div"),r=R("div"),n=R("input"),o=G(),f&&f.c(),B(n,"class","prompt-input"),B(n,"placeholder",t[0]),B(n,"spellcheck","false"),B(n,"type","text"),B(r,"class","omnisearch-input-field"),B(e,"class","omnisearch-input-container")},m(p,c){U(p,e,c),O(e,r),O(r,n),t[9](n),is(n,t[1]),O(e,o),f&&f.m(e,null),s=!0,a||(u=[$e(n,"input",t[10]),yl(i=t[3].call(null,n)),$e(n,"compositionend",t[11]),$e(n,"compositionstart",t[12]),$e(n,"input",t[4])],a=!0)},p(p,[c]){(!s||c&1)&&B(n,"placeholder",p[0]),c&2&&n.value!==p[1]&&is(n,p[1]),f&&f.p&&(!s||c&128)&&Sr(f,l,p,p[7],s?Cr(l,p[7],c,null):Er(p[7]),null)},i(p){s||(te(f,p),s=!0)},o(p){ie(f,p),s=!1},d(p){p&&W(e),t[9](null),f&&f.d(p),a=!1,rt(u)}}}function my(t,e,r){let{$$slots:n={},$$scope:i}=e,{initialValue:o=""}=e,{placeholder:s=""}=e,a=!1,u="",l,f=as();function p(m){r(1,u=m)}function c(m){m&&!a&&!u&&(a=!0,r(1,u=m),h())}function h(m){Dt().then(()=>(l.focus(),Dt())).then(()=>{l.select()})}let w=(0,Hu.debounce)(()=>{Fe.addToSearchHistory(""),f("input",u)},300);function x(m){ht[m?"unshift":"push"](()=>{l=m,r(2,l)})}function v(){u=this.value,r(1,u)}let d=m=>sa(!1),b=m=>sa(!0);return t.$$set=m=>{"initialValue"in m&&r(5,o=m.initialValue),"placeholder"in m&&r(0,s=m.placeholder),"$$scope"in m&&r(7,i=m.$$scope)},t.$$.update=()=>{if(t.$$.dirty&32){e:c(o)}},[s,u,l,h,w,o,p,i,n,x,v,d,b]}var Vu=class extends De{constructor(e){super();Pe(this,e,my,hy,Ce,{initialValue:5,placeholder:0,setInputValue:6})}get setInputValue(){return this.$$.ctx[6]}},Xi=Vu;Xe();function gy(t){let e,r,n,i,o=t[1].default,s=Ar(o,t,t[0],null);return{c(){e=R("div"),s&&s.c(),B(e,"class","prompt-results")},m(a,u){U(a,e,u),s&&s.m(e,null),r=!0,n||(i=$e(e,"mousedown",yy),n=!0)},p(a,[u]){s&&s.p&&(!r||u&1)&&Sr(s,o,a,a[0],r?Cr(o,a[0],u,null):Er(a[0]),null)},i(a){r||(te(s,a),r=!0)},o(a){ie(s,a),r=!1},d(a){a&&W(e),s&&s.d(a),n=!1,i()}}}var yy=t=>t.preventDefault();function _y(t,e,r){let{$$slots:n={},$$scope:i}=e;return t.$$set=o=>{"$$scope"in o&&r(0,i=o.$$scope)},[i,n]}var $u=class extends De{constructor(e){super();Pe(this,e,_y,gy,Ce,{})}},Zi=$u;ot();var za=ge(require("obsidian"));hn();async function Ho(t,e=!1){let r=dn(t.foundWords);r.exec(t.content);let n=r.lastIndex,i=!1;app.workspace.iterateAllLeaves(a=>{a.view instanceof za.MarkdownView&&!e&&a.getViewState().state?.file===t.path&&a.getViewState()?.pinned&&(app.workspace.setActiveLeaf(a,{focus:!0}),i=!0)}),i||await app.workspace.openLinkText(t.path,"",e);let o=app.workspace.getActiveViewOfType(za.MarkdownView);if(!o)return;let s=o.editor.offsetToPos(n);s.ch=0,o.editor.setCursor(s),o.editor.scrollIntoView({from:{line:s.line-10,ch:0},to:{line:s.line+10,ch:0}})}async function Eh(t,e=!1){try{let r;switch(app.vault.getConfig("newFileLocation")){case"current":r=(app.workspace.getActiveFile()?.parent?.path??"")+"/";break;case"folder":r=app.vault.getConfig("newFileFolderPath")+"/";break;default:r="";break}await app.workspace.openLinkText(`${r}${t}.md`,"",e)}catch(r){throw r.message="OmniSearch - Could not create note: "+r.message,console.error(r),r}}At();Xe();Ze();At();Xe();Xe();function A0(t){let e;return{c(){e=R("span"),e.innerHTML='<svg viewBox="0 0 100 100" class="add-note-glyph" width="16" height="16"><path fill="currentColor" stroke="currentColor" d="M23.3,6.7c-3.7,0-6.7,3-6.7,6.7v73.3c0,3.7,3,6.7,6.7,6.7h28.4c-3.2-4.8-5.1-10.5-5.1-16.7c0-16.6,13.4-30,30-30 c2.3,0,4.5,0.3,6.7,0.8V31.7c0-0.9-0.3-1.7-1-2.4L60.7,7.6c-0.6-0.6-1.5-1-2.4-1L23.3,6.7z M56.7,13L77,33.3H60 c-1.8,0-3.3-1.5-3.3-3.3L56.7,13z M76.7,53.3c-12.9,0-23.3,10.4-23.3,23.3S63.8,100,76.7,100S100,89.6,100,76.7 S89.6,53.3,76.7,53.3z M76.7,63.3c1.8,0,3.3,1.5,3.3,3.3v6.7h6.7c1.8,0,3.3,1.5,3.3,3.3c0,1.8-1.5,3.3-3.3,3.3H80v6.7 c0,1.8-1.5,3.3-3.3,3.3c-1.8,0-3.3-1.5-3.3-3.3V80h-6.7c-1.8,0-3.3-1.5-3.3-3.3s1.5-3.3,3.3-3.3h6.7v-6.7 C73.3,64.8,74.8,63.3,76.7,63.3L76.7,63.3z"></path></svg>',B(e,"class","suggestion-flair"),B(e,"aria-label","Not created yet, select to create")},m(r,n){U(r,e,n)},p:me,i:me,o:me,d(r){r&&W(e)}}}function C0(t){"use strict";return[]}var Fh=class extends De{constructor(e){super();Pe(this,e,C0,A0,Ce,{})}},Th=Fh;function Dh(t){let e,r;return e=new Th({}),{c(){We(e.$$.fragment)},m(n,i){Le(e,n,i),r=!0},i(n){r||(te(e.$$.fragment,n),r=!0)},o(n){ie(e.$$.fragment,n),r=!1},d(n){Ie(e,n)}}}function S0(t){let e,r,n,i,o,s=t[2]&&Dh(t),a=t[4].default,u=Ar(a,t,t[3],null);return{c(){e=R("div"),s&&s.c(),r=G(),u&&u.c(),B(e,"data-result-id",t[0]),B(e,"class","suggestion-item omnisearch-result"),os(e,"is-selected",t[1])},m(l,f){U(l,e,f),s&&s.m(e,null),O(e,r),u&&u.m(e,null),n=!0,i||(o=[$e(e,"mousemove",t[5]),$e(e,"click",t[6]),$e(e,"keypress",t[7]),$e(e,"auxclick",t[8])],i=!0)},p(l,[f]){l[2]?s?f&4&&te(s,1):(s=Dh(l),s.c(),te(s,1),s.m(e,r)):s&&(nr(),ie(s,1,1,()=>{s=null}),ir()),u&&u.p&&(!n||f&8)&&Sr(u,a,l,l[3],n?Cr(a,l[3],f,null):Er(l[3]),null),(!n||f&1)&&B(e,"data-result-id",l[0]),(!n||f&2)&&os(e,"is-selected",l[1])},i(l){n||(te(s),te(u,l),n=!0)},o(l){ie(s),ie(u,l),n=!1},d(l){l&&W(e),s&&s.d(),u&&u.d(l),i=!1,rt(o)}}}function E0(t,e,r){let{$$slots:n={},$$scope:i}=e,{id:o}=e,{selected:s=!1}=e,{glyph:a=!1}=e;function u(c){qe.call(this,t,c)}function l(c){qe.call(this,t,c)}function f(c){qe.call(this,t,c)}function p(c){qe.call(this,t,c)}return t.$$set=c=>{"id"in c&&r(0,o=c.id),"selected"in c&&r(1,s=c.selected),"glyph"in c&&r(2,a=c.glyph),"$$scope"in c&&r(3,i=c.$$scope)},[o,s,a,i,n,u,l,f,p]}var Oh=class extends De{constructor(e){super();Pe(this,e,E0,S0,Ce,{id:0,selected:1,glyph:2})}},Vo=Oh;var mn=ge(require("obsidian"));ci();hn();function Ih(t){let e,r=t[1].matches.length+"",n,i,o=(t[1].matches.length>1?"matches":"match")+"",s;return{c(){e=R("span"),n=Se(r),i=Se("\xA0"),s=Se(o),B(e,"class","omnisearch-result__counter")},m(a,u){U(a,e,u),O(e,n),O(e,i),O(e,s)},p(a,u){u&2&&r!==(r=a[1].matches.length+"")&&nt(n,r),u&2&&o!==(o=(a[1].matches.length>1?"matches":"match")+"")&&nt(s,o)},d(a){a&&W(e)}}}function Ph(t){let e,r,n,i,o;return{c(){e=R("div"),r=R("span"),n=G(),i=R("span"),o=Se(t[7]),B(e,"class","omnisearch-result__folder-path")},m(s,a){U(s,e,a),O(e,r),t[14](r),O(e,n),O(e,i),O(i,o)},p(s,a){a&128&&nt(o,s[7])},d(s){s&&W(e),t[14](null)}}}function kh(t){let e,r=Zt(t[5].content,t[9])+"";return{c(){e=R("div"),B(e,"class","omnisearch-result__body")},m(n,i){U(n,e,i),e.innerHTML=r},p(n,i){i&544&&r!==(r=Zt(n[5].content,n[9])+"")&&(e.innerHTML=r)},d(n){n&&W(e)}}}function Mh(t){let e,r,n;return{c(){e=R("div"),r=R("img"),Qe(r,"width","100px"),ns(r.src,n=t[6])||B(r,"src",n),B(r,"alt",""),B(e,"class","omnisearch-result__image-container")},m(i,o){U(i,e,o),O(e,r)},p(i,o){o&64&&!ns(r.src,n=i[6])&&B(r,"src",n)},d(i){i&&W(e)}}}function F0(t){let e,r,n,i,o,s,a=Zt(t[2],t[10])+"",u,l,f,p=gr(t[1].path)+"",c,h,w,x,v,d,b=t[1].matches.length>0&&Ih(t),m=t[7]&&Ph(t),g=t[11]&&kh(t),y=t[6]&&Mh(t);return{c(){e=R("div"),r=R("div"),n=R("span"),i=R("span"),o=G(),s=R("span"),u=G(),l=R("span"),f=Se("."),c=Se(p),h=G(),b&&b.c(),w=G(),m&&m.c(),x=G(),v=R("div"),g&&g.c(),d=G(),y&&y.c(),B(l,"class","omnisearch-result__extension"),B(n,"class","omnisearch-result__title"),B(r,"class","omnisearch-result__title-container"),Qe(v,"display","flex"),Qe(v,"flex-direction","row")},m(_,A){U(_,e,A),O(e,r),O(r,n),O(n,i),t[13](i),O(n,o),O(n,s),s.innerHTML=a,O(n,u),O(n,l),O(l,f),O(l,c),O(n,h),b&&b.m(n,null),O(e,w),m&&m.m(e,null),O(e,x),O(e,v),g&&g.m(v,null),O(v,d),y&&y.m(v,null)},p(_,A){A&1028&&a!==(a=Zt(_[2],_[10])+"")&&(s.innerHTML=a),A&2&&p!==(p=gr(_[1].path)+"")&&nt(c,p),_[1].matches.length>0?b?b.p(_,A):(b=Ih(_),b.c(),b.m(n,null)):b&&(b.d(1),b=null),_[7]?m?m.p(_,A):(m=Ph(_),m.c(),m.m(e,x)):m&&(m.d(1),m=null),_[11]?g?g.p(_,A):(g=kh(_),g.c(),g.m(v,d)):g&&(g.d(1),g=null),_[6]?y?y.p(_,A):(y=Mh(_),y.c(),y.m(v,null)):y&&(y.d(1),y=null)},d(_){_&&W(e),t[13](null),b&&b.d(),m&&m.d(),g&&g.d(),y&&y.d()}}}function T0(t){let e,r;return e=new Vo({props:{glyph:t[8],id:t[1].path,selected:t[0],$$slots:{default:[F0]},$$scope:{ctx:t}}}),e.$on("click",t[15]),e.$on("auxclick",t[16]),e.$on("mousemove",t[17]),{c(){We(e.$$.fragment)},m(n,i){Le(e,n,i),r=!0},p(n,[i]){let o={};i&256&&(o.glyph=n[8]),i&2&&(o.id=n[1].path),i&1&&(o.selected=n[0]),i&265982&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(te(e.$$.fragment,n),r=!0)},o(n){ie(e.$$.fragment,n),r=!1},d(n){Ie(e,n)}}}function D0(t,e,r){let n,i,o,s,a,u;mi(t,dr,y=>r(11,u=y));let{selected:l=!1}=e,{note:f}=e,p=null,c="",h="",w,x;function v(y){ht[y?"unshift":"push"](()=>{x=y,r(4,x)})}function d(y){ht[y?"unshift":"push"](()=>{w=y,r(3,w)})}function b(y){qe.call(this,t,y)}function m(y){qe.call(this,t,y)}function g(y){qe.call(this,t,y)}t.$$set=y=>{"selected"in y&&r(0,l=y.selected),"note"in y&&r(1,f=y.note)},t.$$.update=()=>{if(t.$$.dirty&2){e:if(r(6,p=null),Vr(f.path)){let y=app.vault.getFiles().find(_=>_.path===f.path);y&&r(6,p=app.vault.getResourcePath(y))}}if(t.$$.dirty&2){e:r(12,n=dn(f.foundWords))}if(t.$$.dirty&30){e:r(2,c=f.basename),r(7,h=Ou(f.path)),T.ignoreDiacritics&&r(2,c=jt(c)),w&&(0,mn.setIcon)(w,"folder-open"),x&&(Vr(f.path)?(0,mn.setIcon)(x,"image"):mr(f.path)?(0,mn.setIcon)(x,"file-text"):$r(f.path)?(0,mn.setIcon)(x,"layout-dashboard"):(0,mn.setIcon)(x,"file"))}if(t.$$.dirty&4100){e:r(10,i=zo(c,n))}if(t.$$.dirty&2){e:r(5,s=pn(f.content,f.matches[0]?.offset??-1))}if(t.$$.dirty&34){e:r(9,o=li(f.matches).map(y=>(y.offset=y.offset-s.offset,y)))}};e:r(8,a=!1);return[l,f,c,w,x,s,p,h,a,o,i,u,n,v,d,b,m,g]}var Rh=class extends De{constructor(e){super();Pe(this,e,D0,T0,Ce,{selected:0,note:1})}},Lh=Rh;Wo();Ze();Yo();Gn();yn();var rm=ge(tm());function nm(t,e,r){let n=t.slice();return n[36]=e[r],n[38]=r,n}function W0(t){let e,r,n;return{c(){e=R("button"),e.textContent="Create note"},m(i,o){U(i,e,o),r||(n=$e(e,"click",t[12]),r=!0)},p:me,d(i){i&&W(e),r=!1,n()}}}function U0(t){let e,r=T.showCreateButton&&W0(t);return{c(){r&&r.c(),e=Fr()},m(n,i){r&&r.m(n,i),U(n,e,i)},p(n,i){T.showCreateButton&&r.p(n,i)},d(n){r&&r.d(n),n&&W(e)}}}function im(t){let e,r,n;return{c(){e=R("div"),r=Se("\u23F3 Work in progress: "),n=Se(t[3]),Qe(e,"text-align","center"),Qe(e,"color","var(--text-accent)"),Qe(e,"margin-top","10px")},m(i,o){U(i,e,o),O(e,r),O(e,n)},p(i,o){o[0]&8&&nt(n,i[3])},d(i){i&&W(e)}}}function om(t){let e,r;function n(...i){return t[18](t[38],...i)}return e=new Lh({props:{selected:t[38]===t[0],note:t[36]}}),e.$on("mousemove",n),e.$on("click",t[10]),e.$on("auxclick",t[19]),{c(){We(e.$$.fragment)},m(i,o){Le(e,i,o),r=!0},p(i,o){t=i;let s={};o[0]&1&&(s.selected=t[38]===t[0]),o[0]&4&&(s.note=t[36]),e.$set(s)},i(i){r||(te(e.$$.fragment,i),r=!0)},o(i){ie(e.$$.fragment,i),r=!1},d(i){Ie(e,i)}}}function G0(t){let e;return{c(){e=Se("Searching...")},m(r,n){U(r,e,n)},p:me,d(r){r&&W(e)}}}function Q0(t){let e,r=T.simpleSearch&&t[1].split($n).some(am),n,i=r&&sm(t);return{c(){e=Se(`We found 0 result for your search here.
      `),i&&i.c(),n=Fr()},m(o,s){U(o,e,s),i&&i.m(o,s),U(o,n,s)},p(o,s){s[0]&2&&(r=T.simpleSearch&&o[1].split($n).some(am)),r?i||(i=sm(o),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(o){o&&W(e),i&&i.d(o),o&&W(n)}}}function sm(t){let e,r,n;return{c(){e=R("br"),r=G(),n=R("span"),n.textContent=`You have enabled "Simpler Search" in the settings, try to type more
          characters.`,Qe(n,"color","var(--text-accent)"),Qe(n,"font-size","small")},m(i,o){U(i,e,o),U(i,r,o),U(i,n,o)},d(i){i&&W(e),i&&W(r),i&&W(n)}}}function q0(t){let e,r,n,i=t[2],o=[];for(let f=0;f<i.length;f+=1)o[f]=om(nm(t,i,f));let s=f=>ie(o[f],1,1,()=>{o[f]=null});function a(f,p){if(!f[2].length&&f[1]&&!f[4])return Q0;if(f[4])return G0}let u=a(t,[-1,-1]),l=u&&u(t);return{c(){for(let f=0;f<o.length;f+=1)o[f].c();e=G(),r=R("div"),l&&l.c(),Qe(r,"text-align","center")},m(f,p){for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(f,p);U(f,e,p),U(f,r,p),l&&l.m(r,null),n=!0},p(f,p){if(p[0]&3077){i=f[2];let c;for(c=0;c<i.length;c+=1){let h=nm(f,i,c);o[c]?(o[c].p(h,p),te(o[c],1)):(o[c]=om(h),o[c].c(),te(o[c],1),o[c].m(e.parentNode,e))}for(nr(),c=i.length;c<o.length;c+=1)s(c);ir()}u===(u=a(f,p))&&l?l.p(f,p):(l&&l.d(1),l=u&&u(f),l&&(l.c(),l.m(r,null)))},i(f){if(!n){for(let p=0;p<i.length;p+=1)te(o[p]);n=!0}},o(f){o=o.filter(Boolean);for(let p=0;p<o.length;p+=1)ie(o[p]);n=!1},d(f){yi(o,f),f&&W(e),f&&W(r),l&&l.d()}}}function Y0(t){let e,r,n,i,o,s,a,u,l,f,p,c,h,w,x,v,d,b,m,g,y,_,A,C,F,D,P,N,k,H,X,J,Y,S,E,I,K,Z,M,ne,ze,Ae,ye,He,Am={initialValue:t[1],placeholder:"Omnisearch - Vault",$$slots:{default:[U0]},$$scope:{ctx:t}};e=new Xi({props:Am}),t[16](e),e.$on("input",t[17]);let Ve=t[3]&&im(t);return i=new Zi({props:{$$slots:{default:[q0]},$$scope:{ctx:t}}}),{c(){We(e.$$.fragment),r=G(),Ve&&Ve.c(),n=G(),We(i.$$.fragment),o=G(),s=R("div"),a=R("div"),a.innerHTML='<span class="prompt-instruction-command">\u2191\u2193</span><span>to navigate</span>',u=G(),l=R("div"),l.innerHTML=`<span class="prompt-instruction-command">alt \u2191\u2193</span> 
    <span>to cycle history</span>`,f=G(),p=R("div"),c=R("span"),h=Se(t[7]),w=G(),x=R("span"),x.textContent="to open",v=G(),d=R("div"),d.innerHTML=`<span class="prompt-instruction-command">tab</span> 
    <span>to switch to In-File Search</span>`,b=G(),m=R("div"),g=R("span"),y=Se(t[6]),_=G(),A=R("span"),A.textContent="to open in a new pane",C=G(),F=R("div"),F.innerHTML=`<span class="prompt-instruction-command">alt o</span> 
    <span>to open in the background</span>`,D=G(),P=R("div"),N=R("span"),k=Se(t[9]),H=G(),X=R("span"),X.textContent="to create",J=G(),Y=R("div"),S=R("span"),E=Se(t[8]),I=G(),K=R("span"),K.textContent="to create in a new pane",Z=G(),M=R("div"),M.innerHTML=`<span class="prompt-instruction-command">alt \u21B5</span> 
    <span>to insert a link</span>`,ne=G(),ze=R("div"),ze.innerHTML=`<span class="prompt-instruction-command">ctrl h</span> 
    <span>to toggle excerpts</span>`,Ae=G(),ye=R("div"),ye.innerHTML='<span class="prompt-instruction-command">esc</span><span>to close</span>',B(a,"class","prompt-instruction"),B(l,"class","prompt-instruction"),B(c,"class","prompt-instruction-command"),B(p,"class","prompt-instruction"),B(d,"class","prompt-instruction"),B(g,"class","prompt-instruction-command"),B(m,"class","prompt-instruction"),B(F,"class","prompt-instruction"),B(N,"class","prompt-instruction-command"),B(P,"class","prompt-instruction"),B(S,"class","prompt-instruction-command"),B(Y,"class","prompt-instruction"),B(M,"class","prompt-instruction"),B(ze,"class","prompt-instruction"),B(ye,"class","prompt-instruction"),B(s,"class","prompt-instructions")},m(ee,xe){Le(e,ee,xe),U(ee,r,xe),Ve&&Ve.m(ee,xe),U(ee,n,xe),Le(i,ee,xe),U(ee,o,xe),U(ee,s,xe),O(s,a),O(s,u),O(s,l),O(s,f),O(s,p),O(p,c),O(c,h),O(p,w),O(p,x),O(s,v),O(s,d),O(s,b),O(s,m),O(m,g),O(g,y),O(m,_),O(m,A),O(s,C),O(s,F),O(s,D),O(s,P),O(P,N),O(N,k),O(P,H),O(P,X),O(s,J),O(s,Y),O(Y,S),O(S,E),O(Y,I),O(Y,K),O(s,Z),O(s,M),O(s,ne),O(s,ze),O(s,Ae),O(s,ye),He=!0},p(ee,xe){let ts={};xe[0]&2&&(ts.initialValue=ee[1]),xe[1]&256&&(ts.$$scope={dirty:xe,ctx:ee}),e.$set(ts),ee[3]?Ve?Ve.p(ee,xe):(Ve=im(ee),Ve.c(),Ve.m(n.parentNode,n)):Ve&&(Ve.d(1),Ve=null);let al={};xe[0]&23|xe[1]&256&&(al.$$scope={dirty:xe,ctx:ee}),i.$set(al),(!He||xe[0]&128)&&nt(h,ee[7]),(!He||xe[0]&64)&&nt(y,ee[6]),(!He||xe[0]&512)&&nt(k,ee[9]),(!He||xe[0]&256)&&nt(E,ee[8])},i(ee){He||(te(e.$$.fragment,ee),te(i.$$.fragment,ee),He=!0)},o(ee){ie(e.$$.fragment,ee),ie(i.$$.fragment,ee),He=!1},d(ee){t[16](null),Ie(e,ee),ee&&W(r),Ve&&Ve.d(ee),ee&&W(n),Ie(i,ee),ee&&W(o),ee&&W(s)}}}var am=t=>t.length<3;function J0(t,e,r){let n,i;mi(t,Bt,M=>r(15,i=M));let{modal:o}=e,{previousQuery:s}=e,a=0,u=0,l,f=[],p,c="",h=!0,w,x,v,d,b;wn(async()=>{Q.enable("vault"),Q.on("vault",re.Enter,C),Q.on("vault",re.OpenInBackground,F),Q.on("vault",re.CreateNote,H),Q.on("vault",re.OpenInNewPane,D),Q.on("vault",re.InsertLink,X),Q.on("vault",re.Tab,J),Q.on("vault",re.ArrowUp,()=>Y(-1)),Q.on("vault",re.ArrowDown,()=>Y(1)),Q.on("vault",re.PrevSearchHistory,m),Q.on("vault",re.NextSearchHistory,g),await qo(),T.showPreviousQueryResults&&r(13,s=(await Fe.getSearchHistory())[0])}),jn(()=>{Q.disable("vault")});async function m(){let M=(await Fe.getSearchHistory()).filter(ne=>ne);++u>=M.length&&(u=0),r(1,l=M[u]),w?.setInputValue(l)}async function g(){let M=(await Fe.getSearchHistory()).filter(ne=>ne);--u<0&&(u=M.length?M.length-1:0),r(1,l=M[u]),w?.setInputValue(l)}let y=null;async function _(){y&&(y.cancel(),y=null),p=new xr(l),y=(0,rm.cancelable)(new Promise(M=>{M(je.getSuggestions(p))})),r(2,f=await y),r(0,a=0),await S()}function A(M){!n||(M?.ctrlKey?D():C(),o.close())}function C(){!n||(N(n),o.close())}function F(){!n||N(n,!0)}function D(){!n||(N(n,!0),o.close())}function P(){l&&Fe.addToSearchHistory(l)}function N(M,ne=!1){P(),Ho(M,ne)}async function k(M){await H()}async function H(M){if(l){try{await Eh(l,M?.newLeaf)}catch(ne){new er.Notice(ne.message);return}o.close()}}function X(){if(!n)return;let M=app.vault.getMarkdownFiles().find(He=>He.path===n.path),ne=app.workspace.getActiveFile(),ze=app.workspace.getActiveViewOfType(er.MarkdownView);if(!ze?.editor){new er.Notice("Omnisearch - Error - No active editor",3e3);return}let Ae;M&&ne?Ae=app.fileManager.generateMarkdownLink(M,ne.path):Ae=`[[${n.basename}.${gr(n.path)}]]`;let ye=ze.editor.getCursor();ze.editor.replaceRange(Ae,ye,ye),ye.ch+=Ae.length,ze.editor.setCursor(ye),o.close()}function J(){if(!(n&&(mr(n?.path)||!n?.matches.length)))if(P(),o.close(),n){let M=app.vault.getAbstractFileByPath(n.path);M&&M instanceof er.TFile&&new _n(app,M,l).open()}else{let M=app.workspace.getActiveViewOfType(er.MarkdownView);M?.file&&new _n(app,M.file,l).open()}}function Y(M){r(0,a=qi(a+M,f.length)),S()}async function S(){await Dt(),n&&activeWindow.document.querySelector(`[data-result-id="${n.path}"]`)?.scrollIntoView({behavior:"auto",block:"nearest"})}function E(M){ht[M?"unshift":"push"](()=>{w=M,r(5,w)})}let I=M=>r(1,l=M.detail),K=(M,ne)=>r(0,a=M),Z=M=>{M.button==1&&D()};t.$$set=M=>{"modal"in M&&r(14,o=M.modal),"previousQuery"in M&&r(13,s=M.previousQuery)},t.$$.update=()=>{if(t.$$.dirty[0]&8194){e:r(1,l=l??s)}if(t.$$.dirty[0]&2){e:l?(r(4,h=!0),_().then(()=>{r(4,h=!1)})):(r(4,h=!1),r(2,f=[]))}if(t.$$.dirty[0]&5){e:n=f[a]}if(t.$$.dirty[0]&32768){e:switch(i){case et.LoadingCache:r(3,c="Loading cache...");break;case et.ReadingFiles:r(3,c="Reading files...");break;case et.IndexingFiles:r(3,c="Indexing files...");break;case et.WritingCache:_(),r(3,c="Updating cache...");break;default:_(),r(3,c="");break}}};e:T.openInNewPane?(r(6,x="\u21B5"),r(7,v=hr()+" \u21B5"),r(8,d="shift \u21B5"),r(9,b=hr()+" shift \u21B5")):(r(6,x=hr()+" \u21B5"),r(7,v="\u21B5"),r(8,d=hr()+" shift \u21B5"),r(9,b="shift \u21B5"));return[a,l,f,c,h,w,x,v,d,b,A,D,k,s,o,i,E,I,K,Z]}var lm=class extends De{constructor(e){super();Pe(this,e,J0,Y0,Ce,{modal:14,previousQuery:13},null,[-1,-1])}},um=lm;Xe();ot();At();var dm=ge(require("obsidian"));Xe();hn();ci();function X0(t){let e,r=Zt(t[2].content,t[3])+"";return{c(){e=R("div"),B(e,"class","omnisearch-result__body")},m(n,i){U(n,e,i),e.innerHTML=r},p(n,i){i&12&&r!==(r=Zt(n[2].content,n[3])+"")&&(e.innerHTML=r)},d(n){n&&W(e)}}}function Z0(t){let e,r;return e=new Vo({props:{id:t[0].toString(),selected:t[1],$$slots:{default:[X0]},$$scope:{ctx:t}}}),e.$on("mousemove",t[6]),e.$on("click",t[7]),e.$on("auxclick",t[8]),{c(){We(e.$$.fragment)},m(n,i){Le(e,n,i),r=!0},p(n,[i]){let o={};i&1&&(o.id=n[0].toString()),i&2&&(o.selected=n[1]),i&524&&(o.$$scope={dirty:i,ctx:n}),e.$set(o)},i(n){r||(te(e.$$.fragment,n),r=!0)},o(n){ie(e.$$.fragment,n),r=!1},d(n){Ie(e,n)}}}function e1(t,e,r){let n,i,{offset:o}=e,{note:s}=e,{index:a=0}=e,{selected:u=!1}=e;function l(c){qe.call(this,t,c)}function f(c){qe.call(this,t,c)}function p(c){qe.call(this,t,c)}return t.$$set=c=>{"offset"in c&&r(4,o=c.offset),"note"in c&&r(5,s=c.note),"index"in c&&r(0,a=c.index),"selected"in c&&r(1,u=c.selected)},t.$$.update=()=>{if(t.$$.dirty&48){e:r(2,n=pn(s?.content??"",o))}if(t.$$.dirty&36){e:r(3,i=li(s.matches).map(c=>(c.offset=c.offset-n.offset,c)))}},[a,u,n,i,o,s,l,f,p]}var cm=class extends De{constructor(e){super();Pe(this,e,e1,Z0,Ce,{offset:4,note:5,index:0,selected:1})}},fm=cm;Wo();yn();function pm(t,e,r){let n=t.slice();return n[19]=e[r],n[21]=r,n}function t1(t){let e;return{c(){e=R("div"),e.textContent="We found 0 result for your search here.",Qe(e,"text-align","center")},m(r,n){U(r,e,n)},p:me,i:me,o:me,d(r){r&&W(e)}}}function r1(t){let e,r,n=t[4],i=[];for(let s=0;s<n.length;s+=1)i[s]=hm(pm(t,n,s));let o=s=>ie(i[s],1,1,()=>{i[s]=null});return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=Fr()},m(s,a){for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(s,a);U(s,e,a),r=!0},p(s,a){if(a&120){n=s[4];let u;for(u=0;u<n.length;u+=1){let l=pm(s,n,u);i[u]?(i[u].p(l,a),te(i[u],1)):(i[u]=hm(l),i[u].c(),te(i[u],1),i[u].m(e.parentNode,e))}for(nr(),u=n.length;u<i.length;u+=1)o(u);ir()}},i(s){if(!r){for(let a=0;a<n.length;a+=1)te(i[a]);r=!0}},o(s){i=i.filter(Boolean);for(let a=0;a<i.length;a+=1)ie(i[a]);r=!1},d(s){yi(i,s),s&&W(e)}}}function hm(t){let e,r;function n(...i){return t[11](t[21],...i)}return e=new fm({props:{offset:t[19],note:t[3],index:t[21],selected:t[21]===t[5]}}),e.$on("mousemove",n),e.$on("click",t[12]),e.$on("auxclick",t[13]),{c(){We(e.$$.fragment)},m(i,o){Le(e,i,o),r=!0},p(i,o){t=i;let s={};o&16&&(s.offset=t[19]),o&8&&(s.note=t[3]),o&32&&(s.selected=t[21]===t[5]),e.$set(s)},i(i){r||(te(e.$$.fragment,i),r=!0)},o(i){ie(e.$$.fragment,i),r=!1},d(i){Ie(e,i)}}}function n1(t){let e,r,n,i,o=[r1,t1],s=[];function a(u,l){return u[4].length&&u[3]?0:1}return e=a(t,-1),r=s[e]=o[e](t),{c(){r.c(),n=Fr()},m(u,l){s[e].m(u,l),U(u,n,l),i=!0},p(u,l){let f=e;e=a(u,l),e===f?s[e].p(u,l):(nr(),ie(s[f],1,1,()=>{s[f]=null}),ir(),r=s[e],r?r.p(u,l):(r=s[e]=o[e](u),r.c()),te(r,1),r.m(n.parentNode,n))},i(u){i||(te(r),i=!0)},o(u){ie(r),i=!1},d(u){s[e].d(u),u&&W(n)}}}function i1(t){let e;return{c(){e=R("span"),e.textContent="to close"},m(r,n){U(r,e,n)},d(r){r&&W(e)}}}function o1(t){let e;return{c(){e=R("span"),e.textContent="to go back to Vault Search"},m(r,n){U(r,e,n)},d(r){r&&W(e)}}}function s1(t){let e,r,n,i,o,s,a,u,l,f,p,c,h,w,x,v,d,b,m,g;e=new Xi({props:{placeholder:"Omnisearch - File",initialValue:t[1]}}),e.$on("input",t[10]),n=new Zi({props:{$$slots:{default:[n1]},$$scope:{ctx:t}}});function y(C,F){return C[0]?o1:i1}let _=y(t,-1),A=_(t);return{c(){We(e.$$.fragment),r=G(),We(n.$$.fragment),i=G(),o=R("div"),s=R("div"),s.innerHTML='<span class="prompt-instruction-command">\u2191\u2193</span><span>to navigate</span>',a=G(),u=R("div"),u.innerHTML='<span class="prompt-instruction-command">\u21B5</span><span>to open</span>',l=G(),f=R("div"),f.innerHTML=`<span class="prompt-instruction-command">tab</span> 
    <span>to switch to Vault Search</span>`,p=G(),c=R("div"),h=R("span"),h.textContent="esc",w=G(),A.c(),x=G(),v=R("div"),d=R("span"),d.textContent=`${hr()} \u21B5`,b=G(),m=R("span"),m.textContent="to open in a new pane",B(s,"class","prompt-instruction"),B(u,"class","prompt-instruction"),B(f,"class","prompt-instruction"),B(h,"class","prompt-instruction-command"),B(c,"class","prompt-instruction"),B(d,"class","prompt-instruction-command"),B(v,"class","prompt-instruction"),B(o,"class","prompt-instructions")},m(C,F){Le(e,C,F),U(C,r,F),Le(n,C,F),U(C,i,F),U(C,o,F),O(o,s),O(o,a),O(o,u),O(o,l),O(o,f),O(o,p),O(o,c),O(c,h),O(c,w),A.m(c,null),O(o,x),O(o,v),O(v,d),O(v,b),O(v,m),g=!0},p(C,[F]){let D={};F&2&&(D.initialValue=C[1]),e.$set(D);let P={};F&4194360&&(P.$$scope={dirty:F,ctx:C}),n.$set(P),_!==(_=y(C,F))&&(A.d(1),A=_(C),A&&(A.c(),A.m(c,null)))},i(C){g||(te(e.$$.fragment,C),te(n.$$.fragment,C),g=!0)},o(C){ie(e.$$.fragment,C),ie(n.$$.fragment,C),g=!1},d(C){Ie(e,C),C&&W(r),Ie(n,C),C&&W(i),C&&W(o),A.d()}}}function a1(t,e,r){let n=t.find(i=>i.offset>e);return n?t.filter(i=>i.offset>e&&i.offset<=n.offset+r):[]}function l1(t,e,r){let{modal:n}=e,{parent:i=null}=e,{singleFilePath:o=""}=e,{previousQuery:s}=e,a,u=[],l=0,f,p;wn(()=>{Q.enable("infile"),Q.on("infile",re.Enter,v),Q.on("infile",re.OpenInNewPane,x),Q.on("infile",re.ArrowUp,()=>h(-1)),Q.on("infile",re.ArrowDown,()=>h(1)),Q.on("infile",re.Tab,d)}),jn(()=>{Q.disable("infile")});function c(_){let A=[],C=-1,F=0;for(;;){let D=a1(_,C,Vn);if(!D.length||(C=D.last().offset,A.push(D),++F>100))break}return A}function h(_){r(5,l=qi(l+_,u.length)),w()}async function w(){await Dt(),document.querySelector(`[data-result-id="${l}"]`)?.scrollIntoView({behavior:"auto",block:"nearest"})}async function x(){return v(!0)}async function v(_=!1){if(f){n.close(),i&&i.close(),await Ho(f,_);let A=app.workspace.getActiveViewOfType(dm.MarkdownView);if(!A)return;let C=u[l]??0,F=A.editor.offsetToPos(C);F.ch=0,A.editor.setCursor(F),A.editor.scrollIntoView({from:{line:F.line-10,ch:0},to:{line:F.line+10,ch:0}})}}function d(){new wr(app,a??s).open(),n.close()}let b=_=>r(2,a=_.detail),m=(_,A)=>r(5,l=_),g=_=>v(_.ctrlKey),y=_=>{_.button==1&&v(!0)};return t.$$set=_=>{"modal"in _&&r(7,n=_.modal),"parent"in _&&r(0,i=_.parent),"singleFilePath"in _&&r(8,o=_.singleFilePath),"previousQuery"in _&&r(1,s=_.previousQuery)},t.$$.update=()=>{if(t.$$.dirty&2){e:r(2,a=s??"")}if(t.$$.dirty&772){e:(async()=>{a&&(r(9,p=new xr(a)),r(3,f=(await je.getSuggestions(p,{singleFilePath:o}))[0]??null)),r(5,l=0),await w()})()}if(t.$$.dirty&8){e:if(f){let _=c(f.matches);r(4,u=_.map(A=>Math.round((A.first().offset+A.last().offset)/2)))}}},[i,s,a,f,u,l,v,n,o,p,b,m,g,y]}var mm=class extends De{constructor(e){super();Pe(this,e,l1,s1,Ce,{modal:7,parent:0,singleFilePath:8,previousQuery:1})}},gm=mm;ot();Ze();var il=class extends Xo.Modal{constructor(e){super(e);this.modalEl.replaceChildren(),this.modalEl.addClass("omnisearch-modal","prompt"),this.modalEl.removeClass("modal"),this.modalEl.tabIndex=-1,this.scope.register([],"ArrowDown",s=>{s.preventDefault(),Q.emit(re.ArrowDown)}),this.scope.register([],"ArrowUp",s=>{s.preventDefault(),Q.emit(re.ArrowUp)});for(let s of[{k:"J",dir:"down"},{k:"K",dir:"up"}])for(let a of["Ctrl","Mod"])this.scope.register([a],s.k,u=>{T.vimLikeNavigationShortcut&&Q.emit("arrow-"+s.dir)});for(let s of[{k:"N",dir:"down"},{k:"P",dir:"up"}])for(let a of["Ctrl","Mod"])this.scope.register([a],s.k,u=>{T.vimLikeNavigationShortcut&&Q.emit("arrow-"+s.dir)});let r,n,i,o;T.openInNewPane?(r=["Mod"],n=[],i=["Mod","Shift"],o=["Shift"]):(r=[],n=["Mod"],i=["Shift"],o=["Mod","Shift"]),this.scope.register(n,"Enter",s=>{s.preventDefault(),Q.emit(re.OpenInNewPane)}),this.scope.register(["Alt"],"Enter",s=>{s.preventDefault(),Q.emit(re.InsertLink)}),this.scope.register(i,"Enter",s=>{s.preventDefault(),Q.emit(re.CreateNote)}),this.scope.register(o,"Enter",s=>{s.preventDefault(),Q.emit(re.CreateNote,{newLeaf:!0})}),this.scope.register(r,"Enter",s=>{aa()||(s.preventDefault(),Q.emit(re.Enter))}),this.scope.register(["Alt"],"O",s=>{aa()||(s.preventDefault(),Q.emit(re.OpenInBackground))}),this.scope.register([],"Tab",s=>{s.preventDefault(),Q.emit(re.Tab)}),this.scope.register(["Alt"],"ArrowDown",s=>{s.preventDefault(),Q.emit(re.NextSearchHistory)}),this.scope.register(["Alt"],"ArrowUp",s=>{s.preventDefault(),Q.emit(re.PrevSearchHistory)}),this.scope.register(["Ctrl"],"H",s=>{Q.emit(Ui.ToggleExcerpts)})}},wr=class extends il{constructor(e,r){super(e);let n=e.workspace.getActiveViewOfType(Xo.MarkdownView)?.editor.getSelection(),i=new um({target:this.modalEl,props:{modal:this,previousQuery:n??r}});this.onClose=()=>{i.$destroy()}}},_n=class extends il{constructor(e,r,n="",i){super(e);let o=new gm({target:this.modalEl,props:{modal:this,singleFilePath:r.path,parent:i,previousQuery:n}});i&&i.containerEl.toggleVisibility(!1),this.onClose=()=>{i&&i.containerEl.toggleVisibility(!0),o.$destroy()}}};Ze();ot();ol();At();$i();Yo();yn();Gn();var sl=class extends tr.Plugin{constructor(){super(...arguments);this.apiHttpServer=null}async onload(){if(await bu(this),this.addSettingTab(new ia(this)),tr.Platform.isMobile||Promise.resolve().then(()=>(jm(),wm)).then(e=>this.apiHttpServer=e.getServer()),oa()){console.log("Omnisearch - Plugin disabled");return}await h1(),await Hr.clearOldDatabases(),m1(this),T.ribbonIcon&&this.addRibbonButton(),Q.disable("vault"),Q.disable("infile"),Q.on("global",Ui.ToggleExcerpts,()=>{dr.set(!T.showExcerpt)}),this.addCommand({id:"show-modal",name:"Vault search",callback:()=>{new wr(app).open()}}),this.addCommand({id:"show-modal-infile",name:"In-file search",editorCallback:(e,r)=>{r.file&&new _n(app,r.file).open()}}),app.workspace.onLayoutReady(async()=>{this.registerEvent(this.app.vault.on("create",e=>{Un(e.path)&&(de("Indexing new file",e.path),je.addFromPaths([e.path]))})),this.registerEvent(this.app.vault.on("delete",e=>{de("Removing file",e.path),Fe.removeFromLiveCache(e.path),je.removeFromPaths([e.path])})),this.registerEvent(this.app.vault.on("modify",async e=>{Un(e.path)&&(de("Updating file",e.path),await Fe.addToLiveCache(e.path),em(e))})),this.registerEvent(this.app.vault.on("rename",async(e,r)=>{Un(e.path)&&(de("Renaming file",e.path),Fe.removeFromLiveCache(r),await Fe.addToLiveCache(e.path),je.removeFromPaths([r]),await je.addFromPaths([e.path]))})),this.executeFirstLaunchTasks(),await this.populateIndex(),this.apiHttpServer&&T.httpApiEnabled&&this.apiHttpServer.listen(T.httpApiPort)})}executeFirstLaunchTasks(){let e="1.10.1";T.welcomeMessage!==e,T.welcomeMessage=e,this.saveData(T)}async onunload(){delete globalThis.omnisearch,await Ee.clearCache(),this.apiHttpServer.close()}addRibbonButton(){this.ribbonButton=this.addRibbonIcon("search","Omnisearch",e=>{new wr(app).open()})}removeRibbonButton(){this.ribbonButton&&this.ribbonButton.parentNode?.removeChild(this.ribbonButton)}async populateIndex(){console.time("Omnisearch - Indexing total time"),Bt.set(et.ReadingFiles);let e=app.vault.getFiles().filter(n=>Un(n.path));console.log(`Omnisearch - ${e.length} files total`),console.log(`Omnisearch - Cache is ${Nt()?"enabled":"disabled"}`),Nt()&&(console.time("Omnisearch - Loading index from cache"),Bt.set(et.LoadingCache),await je.loadCache()&&console.timeEnd("Omnisearch - Loading index from cache"));let r=je.getDiff(e.map(n=>({path:n.path,mtime:n.stat.mtime})));Nt()&&(r.toAdd.length&&console.log("Omnisearch - Total number of files to add/update: "+r.toAdd.length),r.toRemove.length&&console.log("Omnisearch - Total number of files to remove: "+r.toRemove.length)),r.toAdd.length>=1e3&&Nt()&&new tr.Notice(`Omnisearch - ${r.toAdd.length} files need to be indexed. Obsidian may experience stutters and freezes during the process`,1e4),Bt.set(et.IndexingFiles),je.removeFromPaths(r.toRemove.map(n=>n.path)),await je.addFromPaths(r.toAdd.map(n=>n.path)),(r.toRemove.length||r.toAdd.length)&&Nt()&&(Bt.set(et.WritingCache),T.useCache=!1,await le(this),await je.writeToCache(),T.useCache=!0,await le(this)),console.timeEnd("Omnisearch - Indexing total time"),r.toAdd.length>=1e3&&!tr.Platform.isIosApp&&new tr.Notice("Omnisearch - Your files have been indexed."),Bt.set(et.Done),_m()}};async function h1(){let t=[`${app.vault.configDir}/plugins/omnisearch/searchIndex.json`,`${app.vault.configDir}/plugins/omnisearch/notesCache.json`,`${app.vault.configDir}/plugins/omnisearch/notesCache.data`,`${app.vault.configDir}/plugins/omnisearch/searchIndex.data`,`${app.vault.configDir}/plugins/omnisearch/historyCache.json`,`${app.vault.configDir}/plugins/omnisearch/pdfCache.data`];for(let e of t)if(await app.vault.adapter.exists(e))try{await app.vault.adapter.remove(e)}catch{}}function m1(t){t.registerObsidianProtocolHandler("omnisearch",e=>{new wr(app,e.query).open()}),globalThis.omnisearch=di,app.plugins.plugins.omnisearch.api=di}
